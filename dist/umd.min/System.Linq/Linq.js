/*
 * @author electricessence / https://github.com/electricessence/
 * Original: http://linqjs.codeplex.com/
 * Licensing: MIT https://github.com/electricessence/TypeScript.NET/blob/master/LICENSE.md
 */
var __extends=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)};!function(t,e){if("object"==typeof module&&"object"==typeof module.exports){var n=e(require,exports);void 0!==n&&(module.exports=n)}else"function"==typeof define&&define.amd&&define(t,e)}(["require","exports","../System/Compare","../System/Collections/Array/Compare","../System/Collections/Array/Utility","../System/Collections/Enumeration/Enumerator","../System/Types","../System/Integer","../System/Functions","../System/Collections/Enumeration/ArrayEnumerator","../System/Collections/Enumeration/EnumeratorBase","../System/Collections/Dictionaries/Dictionary","../System/Collections/Queue","../System/Disposable/Utility","../System/Disposable/DisposableBase","../System/Disposable/ObjectDisposedException"],function(t,e){function n(t,e){if(void 0===e&&(e="Enumerable"),t)throw new h["default"](e)}var r=t("../System/Compare"),o=t("../System/Collections/Array/Compare"),i=t("../System/Collections/Array/Utility"),u=t("../System/Collections/Enumeration/Enumerator"),a=t("../System/Types"),c=t("../System/Integer"),f=t("../System/Functions"),s=t("../System/Collections/Enumeration/ArrayEnumerator"),l=t("../System/Collections/Enumeration/EnumeratorBase"),p=t("../System/Collections/Dictionaries/Dictionary"),d=t("../System/Collections/Queue"),y=t("../System/Disposable/Utility"),v=t("../System/Disposable/DisposableBase"),h=t("../System/Disposable/ObjectDisposedException"),m=u.from,w=u.forEach,g=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype.Greater=function(t,e){return t>e?t:e},e.prototype.Lesser=function(t,e){return e>t?t:e},e}(f["default"]),E=new g;Object.freeze(E);var N="length",x="getEnumerator",D="Unsupported enumerable.",I=function(t){function e(e,n){t.call(this,n),this._enumeratorFactory=e}return __extends(e,t),e.fromArray=function(t){return new R(t)},e.from=function(t){var n=a["default"].of(t);if(n.isObject){if(t instanceof e)return t;if(t instanceof Array)return new R(t);if(n.member(x).isFunction)return new e(function(){return t.getEnumerator()});if(n.member(N).isValidNumber)return new R(t)}throw new Error(D)},e.toArray=function(t){var n=a["default"].of(t);if(n.isObject){if(t instanceof Array)return t.slice();if(n.member(N).isValidNumber&&(t=new R(t)),t instanceof e)return t.toArray();if(n.member(x).isFunction){var r=[];return w(t.getEnumerator(),function(t,e){r[e]=t}),r}}throw new Error(D)},e.prototype.getEnumerator=function(){return this.throwIfDisposed(),this._enumeratorFactory()},e.prototype._onDispose=function(){t.prototype._onDispose.call(this),this._enumeratorFactory=null},e.choice=function(t){return new e(function(){return new l["default"](null,function(e){return e.yieldReturn(t[c["default"].random(t.length)])})})},e.cycle=function(t){return new e(function(){var e=0;return new l["default"](function(){e=0},function(n){return e>=t.length&&(e=0),n.yieldReturn(t[e++])})})},e.empty=function(){return new e(function(){return new l["default"](null,E.False)})},e.repeat=function(t,n){return void 0===n&&(n=1/0),isNaN(n)||0>=n?e.empty():new e(isFinite(n)&&c["default"].assert(n,"count")?function(){var e=n,r=0;return new l["default"](function(){r=0},function(n){return r++<e&&n.yieldReturn(t)})}:function(){return new l["default"](null,function(e){return e.yieldReturn(t)})})},e.repeatWithFinalize=function(t,n){return new e(function(){var e;return new l["default"](function(){e=t()},function(t){return t.yieldReturn(e)},function(){n(e)})})},e.make=function(t){return e.repeat(t,1)},e.range=function(t,n,r){if(void 0===t&&(t=0),void 0===n&&(n=1/0),void 0===r&&(r=1),!isFinite(t))throw new Error("Must have a valid 'start' value.");if(isNaN(n)||0>=n)return e.empty();if(!isFinite(r))throw new Error("Must have a valid 'step' value.");return new e(isFinite(n)&&c["default"].assert(n,"count")?function(){var e,o=n,i=0;return new l["default"](function(){i=0,e=t},function(t){var u=i++<o&&t.yieldReturn(e);return u&&n>i&&(e+=r),u})}:function(){var e;return new l["default"](function(){e=t},function(t){var n=e;return e+=r,t.yieldReturn(n)})})},e.rangeDown=function(t,n,r){return void 0===t&&(t=0),void 0===n&&(n=1/0),void 0===r&&(r=1),r=-1*Math.abs(r),e.range(t,n,r)},e.toInfinity=function(t,n){return void 0===t&&(t=0),void 0===n&&(n=1),e.range(t,1/0,n)},e.toNegativeInfinity=function(t,n){return void 0===t&&(t=0),void 0===n&&(n=1),e.rangeDown(t,1/0,n)},e.rangeTo=function(t,n,r){if(void 0===t&&(t=0),void 0===n&&(n=1/0),void 0===r&&(r=1),!isFinite(t))throw new Error("Must have a valid 'start' value.");if(isNaN(n))throw new Error("Must have a valid 'to' value.");if(!isFinite(r))throw new Error("Must have a valid 'step' value.");return r=Math.abs(r),isFinite(n)?new e(function(){var e;return n>t?new l["default"](function(){e=t},function(t){var o=n>=e&&t.yieldReturn(e);return o&&(e+=r),o}):new l["default"](function(){e=t},function(t){var o=e>=n&&t.yieldReturn(e);return o&&(e-=r),o})}):e.range(t,1/0,n>t?+r:-r)},e.matches=function(t,n,r){void 0===r&&(r="");var o=typeof t;if(o!=a["default"].STRING)throw new Error("Cannot exec RegExp matches of type '"+o+"'.");return n instanceof RegExp&&(r+=n.ignoreCase?"i":"",r+=n.multiline?"m":"",n=n.source),-1===r.indexOf("g")&&(r+="g"),new e(function(){var e;return new l["default"](function(){e=new RegExp(n,r)},function(n){var r=e.exec(t);return null!==r?n.yieldReturn(r):!1})})},e.generate=function(t,n){return void 0===n&&(n=1/0),isNaN(n)||0>=n?e.empty():new e(isFinite(n)&&c["default"].assert(n,"count")?function(){var e=n,r=0;return new l["default"](function(){r=0},function(n){var o=r++;return e>o&&n.yieldReturn(t(o))})}:function(){var e=0;return new l["default"](function(){e=0},function(n){return n.yieldReturn(t(e++))})})},e.unfold=function(t,n,r){return void 0===r&&(r=!1),new e(function(){var e,o,i=0;return new l["default"](function(){i=0,e=t,o=!r},function(t){var r=i++;return o?o=!1:e=n(e,r),t.yieldReturn(e)})})},e.defer=function(t){return new e(function(){var e;return new l["default"](function(){e=t().getEnumerator()},function(t){return e.moveNext()&&t.yieldReturn(e.current)},function(){y.dispose(e)})})},e.forEach=function(t,e){t&&y.using(u.from(t),function(t){u.forEach(t,e)})},e.max=function(t){return t.takeUntil(function(t){return t==+(1/0)},!0).aggregate(E.Greater)},e.min=function(t){return t.takeUntil(function(t){return t==-(1/0)},!0).aggregate(E.Lesser)},e.prototype.forEach=function(t){var e=this;e.throwIfDisposed();var n=0;y.using(e.getEnumerator(),function(r){for(;e.throwIfDisposed()&&r.moveNext()&&t(r.current,n++)!==!1;);})},e.prototype.toArray=function(t){var e=[];return t?this.where(t).toArray():(this.forEach(function(t,n){e[n]=t}),e)},e.prototype.asEnumerable=function(){var t=this;return new e(function(){return t.getEnumerator()})},e.prototype.toLookup=function(t,e,n){void 0===e&&(e=E.Identity),void 0===n&&(n=E.Identity);var r=new p["default"](n);return this.forEach(function(n){var o=t(n),i=e(n),u=r.getValue(o);void 0!==u?u.push(i):r.addByKeyValue(o,[i])}),new b(r)},e.prototype.toMap=function(t,e){var n={};return this.forEach(function(r){n[t(r)]=e(r)}),n},e.prototype.toDictionary=function(t,e,n){void 0===n&&(n=E.Identity);var r=new p["default"](n);return this.forEach(function(n){return r.addByKeyValue(t(n),e(n))}),r},e.prototype.toJoinedString=function(t,e){return void 0===t&&(t=""),void 0===e&&(e=E.Identity),this.select(e).toArray().join(t)},e.prototype.doAction=function(t){var r=this,o=!r.throwIfDisposed();return new e(function(){var e,i=0;return new l["default"](function(){n(o),i=0,e=r.getEnumerator()},function(r){for(n(o);e.moveNext();){var u=t(e.current,i++);if(u===!1||0===u)return r.yieldBreak();if(2!==u)return r.yieldReturn(e.current)}return!1},function(){y.dispose(e)})},function(){o=!0})},e.prototype.force=function(t){void 0===t&&(t=0),this.throwIfDisposed(),this.doAction(function(e){return t})},e.prototype.skip=function(t){var n=this;if(n.throwIfDisposed(),!t||isNaN(t)||0>t)return n;if(!isFinite(t))return e.empty();c["default"].assert(t,"count");var r=t;return this.doAction(function(t,e){return r>e?2:1})},e.prototype.skipWhile=function(t){this.throwIfDisposed();var e=!0;return this.doAction(function(n,r){return e&&(e=t(n,r)),e?2:1})},e.prototype.take=function(t){if(!t||isNaN(t)||0>t)return e.empty();var n=this;if(n.throwIfDisposed(),!isFinite(t))return n;c["default"].assert(t,"count");var r=t;return n.doAction(function(t,e){return r>e})},e.prototype.takeWhile=function(t){return this.throwIfDisposed(),this.doAction(function(e,n){return t(e,n)?1:0})},e.prototype.takeUntil=function(t,e){if(this.throwIfDisposed(),!e)return this.doAction(function(e,n){return t(e,n)?0:1});var n=!1;return this.doAction(function(e,r){return n?0:(n=t(e,r),1)})},e.prototype.takeExceptLast=function(t){void 0===t&&(t=1);var n=this;if(!t||isNaN(t)||0>=t)return n;if(!isFinite(t))return e.empty();c["default"].assert(t,"count");var r=t;return new e(function(){var t,e;return new l["default"](function(){t=n.getEnumerator(),e=new d["default"]},function(n){for(;t.moveNext();)if(e.enqueue(t.current),e.count>r)return n.yieldReturn(e.dequeue());return!1},function(){y.dispose(t,e)})})},e.prototype.takeFromLast=function(t){if(!t||isNaN(t)||0>=t)return e.empty();var n=this;return isFinite(t)?(c["default"].assert(t,"count"),n.reverse().take(t)):n.reverse()},e.prototype.traverseBreadthFirst=function(t,n){var r=this;return new e(function(){var o,i,u,a=0;return new l["default"](function(){a=0,i=[],u=0,o=r.getEnumerator()},function(r){for(;;){if(o.moveNext())return i[u++]=o.current,r.yieldReturn(n(o.current,a));if(!u)return r.yieldBreak();var c=e.fromArray(i).selectMany(t);if(!c.any())return r.yieldBreak();a++,i=[],u=0,o.dispose(),o=c.getEnumerator()}},function(){y.dispose(o),i.length=0})})},e.prototype.traverseDepthFirst=function(t,n){var r=this;return new e(function(){var e,o,i=[];return new l["default"](function(){e=r.getEnumerator(),o=0},function(r){for(;;){if(e.moveNext()){var u=n(e.current,o);return i[o++]=e,e=t(e.current).getEnumerator(),r.yieldReturn(u)}if(0==o)return!1;e.dispose(),e=i[--o],i.length=o}},function(){try{y.dispose(e)}finally{y.disposeThese(i)}})})},e.prototype.flatten=function(){var t=this;return new e(function(){var n,r=null;return new l["default"](function(){n=t.getEnumerator()},function(t){for(;;){if(null!=r){if(r.moveNext())return t.yieldReturn(r.current);r=null}if(n.moveNext()){var o=n.current;if(o instanceof Array){r.dispose(),r=e.fromArray(o).selectMany(E.Identity).flatten().getEnumerator();continue}return t.yieldReturn(n.current)}return!1}},function(){y.dispose(n,r)})})},e.prototype.pairwise=function(t){var n=this;return new e(function(){var e;return new l["default"](function(){e=n.getEnumerator(),e.moveNext()},function(n){var r=e.current;return e.moveNext()&&n.yieldReturn(t(r,e.current))},function(){y.dispose(e)})})},e.prototype.scan=function(t,n){var r=void 0!==n,o=this;return new e(function(){var e,i,u;return new l["default"](function(){e=o.getEnumerator(),u=!0},function(o){return u?(u=!1,r?o.yieldReturn(i=n):e.moveNext()&&o.yieldReturn(i=e.current)):e.moveNext()?o.yieldReturn(i=t(i,e.current)):!1},function(){y.dispose(e)})})},e.prototype.select=function(t){var r=this,o=!r.throwIfDisposed();return t.length<2?new k(r,null,t):new e(function(){var e,i=0;return new l["default"](function(){n(o),i=0,e=r.getEnumerator()},function(r){return n(o),e.moveNext()?r.yieldReturn(t(e.current,i++)):!1},function(){y.dispose(e)})},function(){o=!0})},e.prototype.selectMany=function(t,n){var r=this;return n||(n=function(t,e){return e}),new e(function(){var e,o,i=0;return new l["default"](function(){e=r.getEnumerator(),o=void 0,i=0},function(r){if(void 0===o&&!e.moveNext())return!1;do{if(!o){var a=t(e.current,i++);if(!a)continue;o=u.from(a)}if(o.moveNext())return r.yieldReturn(n(e.current,o.current));o.dispose(),o=null}while(e.moveNext());return!1},function(){y.dispose(e,o),e=null,o=null})})},e.prototype.choose=function(t){var r=this,o=!r.throwIfDisposed();return new e(function(){var e,i=0;return new l["default"](function(){n(o),i=0,e=r.getEnumerator()},function(r){for(n(o);e.moveNext();){var u=t(e.current,i++);if(null!==u&&void 0!==u)return r.yieldReturn(u)}return!1},function(){y.dispose(e)})},function(){o=!0})},e.prototype.where=function(t){var r=this,o=!r.throwIfDisposed();return t.length<2?new S(r,t):new e(function(){var e,i=0;return new l["default"](function(){n(o),i=0,e=r.getEnumerator()},function(r){for(n(o);e.moveNext();)if(t(e.current,i++))return r.yieldReturn(e.current);return!1},function(){y.dispose(e)})},function(){o=!0})},e.prototype.ofType=function(t){var e;switch(t){case Number:e=a["default"].NUMBER;break;case String:e=a["default"].STRING;break;case Boolean:e=a["default"].BOOLEAN;break;case Function:e=a["default"].FUNCTION;break;default:return this.where(function(e){return e instanceof t})}return this.where(function(t){return typeof t===e})},e.prototype.except=function(t,r){var o=this,i=!o.throwIfDisposed();return new e(function(){var u,a;return new l["default"](function(){n(i),u=o.getEnumerator(),a=new p["default"](r),t&&e.forEach(t,function(t){return a.addByKeyValue(t,!0)})},function(t){for(n(i);u.moveNext();){var e=u.current;if(!a.containsKey(e))return a.addByKeyValue(e,!0),t.yieldReturn(e)}return!1},function(){y.dispose(u),a.clear()})},function(){i=!0})},e.prototype.distinct=function(t){return this.except(null,t)},e.prototype.distinctUntilChanged=function(t){var r=this,o=!r.throwIfDisposed();return new e(function(){var e,i,u=!0;return new l["default"](function(){n(o),e=r.getEnumerator()},function(r){for(n(o);e.moveNext();){var a=t(e.current);if(u)u=!1;else if(i===a)continue;return i=a,r.yieldReturn(e.current)}return!1},function(){y.dispose(e)})},function(){o=!0})},e.prototype.reverse=function(){var t=this,r=!t.throwIfDisposed();return new e(function(){var e,o=0;return new l["default"](function(){n(r),e=t.toArray(),o=e.length},function(t){return o>0&&t.yieldReturn(e[--o])},function(){e.length=0})},function(){r=!0})},e.prototype.shuffle=function(){var t=this,r=!t.throwIfDisposed();return new e(function(){var e,o,i;return new l["default"](function(){n(r),e=t.toArray(),o=i=e.length},function(t){if(!i)return t.yieldBreak();var n=c["default"].random(i),r=e[n];return e[n]=e[--i],e[i]=null,i%32==0&&(e.length=i),t.yieldReturn(r)},function(){e.length=0})},function(){r=!0})},e.prototype.count=function(t){var e=this;e.throwIfDisposed();var n=0;return t?e.forEach(function(e,r){t(e,r)&&++n}):e.forEach(function(){++n}),n},e.prototype.all=function(t){var e=!0;return this.forEach(function(n){return t(n)?void 0:(e=!1,!1)}),e},e.prototype.every=function(t){return this.all(t)},e.prototype.any=function(t){var e=!1;return t?this.forEach(function(n){return e=t(n),!e}):this.forEach(function(){return e=!0,!1}),e},e.prototype.some=function(t){return this.any(t)},e.prototype.isEmpty=function(){return!this.any()},e.prototype.contains=function(t,e){return e?this.any(function(n){return e(n)===e(t)}):this.any(function(e){return e===t})},e.prototype.indexOf=function(t,e){var n=-1;return e?this.forEach(function(o,i){return r.areEqual(e(o),e(t),!0)?(n=i,!1):void 0}):this.forEach(function(e,o){return r.areEqual(e,t,!0)?(n=o,!1):void 0}),n},e.prototype.lastIndexOf=function(t,e){var n=-1;return e?this.forEach(function(o,i){r.areEqual(e(o),e(t),!0)&&(n=i)}):this.forEach(function(e,o){r.areEqual(e,t,!0)&&(n=o)}),n},e.prototype.defaultIfEmpty=function(t){void 0===t&&(t=null);var r=this,o=!r.throwIfDisposed();return new e(function(){var e,i;return new l["default"](function(){i=!0,n(o),e=r.getEnumerator()},function(r){return n(o),e.moveNext()?(i=!1,r.yieldReturn(e.current)):i?(i=!1,r.yieldReturn(t)):!1},function(){y.dispose(e)})})},e.prototype.zip=function(t,n){var r=this;return new e(function(){var e,o,i=0;return new l["default"](function(){i=0,e=r.getEnumerator(),o=m(t)},function(t){return e.moveNext()&&o.moveNext()&&t.yieldReturn(n(e.current,o.current,i++))},function(){y.dispose(e,o)})})},e.prototype.zipMultiple=function(t,n){var r=this;return t.length?new e(function(){var e,o,i,u=0;return new l["default"](function(){e=new d["default"](t),u=0,o=r.getEnumerator(),i=null},function(t){if(o.moveNext())for(;;){for(;!i;){if(!e.count)return t.yieldBreak();var r=e.dequeue();r&&(i=m(r))}if(i.moveNext())return t.yieldReturn(n(o.current,i.current,u++));i.dispose(),i=null}return t.yieldBreak()},function(){y.dispose(o,e)})}):e.empty()},e.prototype.join=function(t,n,r,o,i){void 0===i&&(i=E.Identity);var u=this;return new e(function(){var a,c,f=null,s=0;return new l["default"](function(){a=u.getEnumerator(),c=e.from(t).toLookup(r,E.Identity,i)},function(t){for(;;){if(null!=f){var e=f[s++];if(void 0!==e)return t.yieldReturn(o(a.current,e));e=null,s=0}if(!a.moveNext())return t.yieldBreak();var r=n(a.current);f=c.get(r)}},function(){y.dispose(a)})})},e.prototype.groupJoin=function(t,n,r,o,i){void 0===i&&(i=E.Identity);var u=this;return new e(function(){var a,c=null;return new l["default"](function(){a=u.getEnumerator(),c=e.from(t).toLookup(r,E.Identity,i)},function(t){return a.moveNext()&&t.yieldReturn(o(a.current,c.get(n(a.current))))},function(){y.dispose(a)})})},e.prototype.concatWith=function(t){var n=this;return new e(function(){var e,r;return new l["default"](function(){e=n.getEnumerator()},function(n){if(null!=e){if(e.moveNext())return n.yieldReturn(e.current);r=m(t),e.dispose(),e=null}return r.moveNext()?n.yieldReturn(r.current):!1},function(){y.dispose(e,r)})})},e.prototype.merge=function(t){var n=this;return t.length?1==t.length?n.concatWith(t[0]):new e(function(){var e,r;return new l["default"](function(){e=n.getEnumerator(),r=new d["default"](t)},function(t){for(;;){for(;!e&&r.count;)e=m(r.dequeue());if(e&&e.moveNext())return t.yieldReturn(e.current);{if(!e)return t.yieldBreak();e.dispose(),e=null}}},function(){y.dispose(e,r)})}):n},e.prototype.concat=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];var n=this;return 0==t.length?n:1==t.length?n.concatWith(t[0]):n.merge(t)},e.prototype.insertAt=function(t,n){if(isNaN(t)||0>t||!isFinite(t))throw new Error("'index' is invalid or out of bounds.");c["default"].assert(t,"index");var r=t,o=this;return o.throwIfDisposed(),new e(function(){var t,e,i=0,u=!1;return new l["default"](function(){i=0,t=o.getEnumerator(),e=m(n),u=!1},function(n){return i==r&&(u=!0,e.moveNext())?n.yieldReturn(e.current):t.moveNext()?(i++,n.yieldReturn(t.current)):!u&&e.moveNext()&&n.yieldReturn(e.current)},function(){y.dispose(t,e)})})},e.prototype.alternateMultiple=function(t){var n=this;return new e(function(){var r,o,i,u;return new l["default"](function(){u=new s["default"](e.toArray(t)),i=n.getEnumerator();var a=i.moveNext();o=a?1:0,a&&(r=i.current)},function(t){switch(o){case 0:return t.yieldBreak();case 2:if(u.moveNext())return t.yieldReturn(u.current);u.reset(),o=1}var e=r,n=i.moveNext();return o=n?2:0,n&&(r=i.current),t.yieldReturn(e)},function(){y.dispose(i,u)})})},e.prototype.alternateSingle=function(t){return this.alternateMultiple(e.make(t))},e.prototype.alternate=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];return this.alternateMultiple(t)},e.prototype.intersect=function(t,n){var r=this;return new e(function(){var o,i,u;return new l["default"](function(){o=r.getEnumerator(),i=new p["default"](n),u=new p["default"](n),e.from(t).forEach(function(t){i.addByKeyValue(t,!0)})},function(t){for(;o.moveNext();){var e=o.current;if(!u.containsKey(e)&&i.containsKey(e))return u.addByKeyValue(e,!0),t.yieldReturn(e)}return t.yieldBreak()},function(){y.dispose(o)})})},e.prototype.sequenceEqual=function(t,n){return void 0===n&&(n=r.areEqual),y.using(this.getEnumerator(),function(r){return y.using(e.from(t).getEnumerator(),function(t){for(;r.moveNext();)if(!t.moveNext()||!n(r.current,t.current))return!1;return!t.moveNext()})})},e.prototype.union=function(t,n){void 0===n&&(n=E.Identity);var r=this;return new e(function(){var o,i,u;return new l["default"](function(){o=r.getEnumerator(),u=new p["default"](n)},function(n){var r;if(void 0===i){for(;o.moveNext();)if(r=o.current,!u.containsKey(r))return u.addByKeyValue(r,null),n.yieldReturn(r);i=e.from(t).getEnumerator()}for(;i.moveNext();)if(r=i.current,!u.containsKey(r))return u.addByKeyValue(r,null),n.yieldReturn(r);return!1},function(){y.dispose(o,i)})})},e.prototype.orderBy=function(t){return void 0===t&&(t=E.Identity),new A(this,t,!1)},e.prototype.orderByDescending=function(t){return void 0===t&&(t=E.Identity),new A(this,t,!0)},e.prototype.groupBy=function(t,n,r){var o=this;return n||(n=E.Identity),new e(function(){return o.toLookup(t,n,r).getEnumerator()})},e.prototype.partitionBy=function(t,n,r,o){void 0===r&&(r=function(t,e){return new _(t,e)}),void 0===o&&(o=E.Identity);var i=this;return n||(n=E.Identity),new e(function(){var e,u,a,c,f;return new l["default"](function(){e=i.getEnumerator(),e.moveNext()?(u=t(e.current),a=o(u),c=[n(e.current)],f=1):c=null},function(i){if(!c)return i.yieldBreak();for(var s,l;(s=e.moveNext())&&(l=e.current,a===o(t(l)));)c[f++]=n(l);var p=r(u,c);return s?(l=e.current,u=t(l),a=o(u),c=[n(l)],f=1):c=null,i.yieldReturn(p)},function(){y.dispose(e),c=null})})},e.prototype.buffer=function(t){if(1>t||!isFinite(t))throw new Error("Invalid buffer size.");c["default"].assert(t,"size");var n,r=this;return new e(function(){var e;return new l["default"](function(){e=r.getEnumerator()},function(r){var o=i.initialize(t);for(n=0;t>n&&e.moveNext;)o[n++]=e.current;return o.length=n,n&&r.yieldReturn(o)},function(){y.dispose(e)})})},e.prototype.aggregate=function(t,e){return this.scan(t,e).lastOrDefault()},e.prototype.average=function(t){void 0===t&&(t=a["default"].numberOrNaN);var e=0,n=0,r=0;return this.forEach(function(o){var i=t(o);return isNaN(i)?(e=NaN,!1):(isFinite(i)?e+=i:n+=i>0?1:-1,void++r)}),n?n*(1/0):isNaN(e)||!r?NaN:e/r},e.prototype.max=function(){return this.aggregate(E.Greater)},e.prototype.min=function(){return this.aggregate(E.Lesser)},e.prototype.maxBy=function(t){return void 0===t&&(t=E.Identity),this.aggregate(function(e,n){return t(e)>t(n)?e:n})},e.prototype.minBy=function(t){return void 0===t&&(t=E.Identity),this.aggregate(function(e,n){return t(e)<t(n)?e:n})},e.prototype.sum=function(t){void 0===t&&(t=a["default"].numberOrNaN);var e=0,n=0;return this.forEach(function(r){var o=t(r);return isNaN(o)?(e=NaN,!1):void(isFinite(o)?e+=o:n+=o>0?1:-1)}),isNaN(e)?NaN:n?n*(1/0):e},e.prototype.product=function(t){void 0===t&&(t=a["default"].numberOrNaN);var e=1,n=!1;return this.forEach(function(r){n=!0;var o=t(r);return isNaN(o)?(e=NaN,!1):0==o?(e=0,!1):void(e*=o)}),n&&isNaN(e)?NaN:e},e.prototype.elementAt=function(t){if(isNaN(t)||0>t||!isFinite(t))throw new Error("'index' is invalid or out of bounds.");c["default"].assert(t,"index");var e=t,n=this;n.throwIfDisposed();var r=void 0,o=!1;if(n.forEach(function(t,n){return n==e?(r=t,o=!0,!1):void 0}),!o)throw new Error("index is less than 0 or greater than or equal to the number of elements in source.");return r},e.prototype.elementAtOrDefault=function(t,e){if(void 0===e&&(e=null),isNaN(t)||0>t||!isFinite(t))throw new Error("'index' is invalid or out of bounds.");c["default"].assert(t,"index");var n=t,r=this;r.throwIfDisposed();var o=void 0,i=!1;return r.forEach(function(t,e){return e==n?(o=t,i=!0,!1):void 0}),i?o:e},e.prototype.first=function(){var t=this;t.throwIfDisposed();var e=void 0,n=!1;if(t.forEach(function(t){return e=t,n=!0,!1}),!n)throw new Error("first:No element satisfies the condition.");return e},e.prototype.firstOrDefault=function(t){void 0===t&&(t=null);var e=this;e.throwIfDisposed();var n=void 0,r=!1;return e.forEach(function(t){return n=t,r=!0,!1}),r?n:t},e.prototype.last=function(){var t=this;t.throwIfDisposed();var e=void 0,n=!1;if(t.forEach(function(t){n=!0,e=t}),!n)throw new Error("last:No element satisfies the condition.");return e},e.prototype.lastOrDefault=function(t){void 0===t&&(t=null);var e=this;e.throwIfDisposed();var n=void 0,r=!1;return e.forEach(function(t){r=!0,n=t}),r?n:t},e.prototype.single=function(){var t=this;t.throwIfDisposed();var e=void 0,n=!1;if(t.forEach(function(t){if(n)throw new Error("single:sequence contains more than one element.");n=!0,e=t}),!n)throw new Error("single:No element satisfies the condition.");return e},e.prototype.singleOrDefault=function(t){void 0===t&&(t=null);var e=this;e.throwIfDisposed();var n=void 0,r=!1;return e.forEach(function(t){if(r)throw new Error("single:sequence contains more than one element.");r=!0,n=t}),r?n:t},e.prototype.share=function(){var t=this;t.throwIfDisposed();var n;return new e(function(){return new l["default"](function(){n||(n=t.getEnumerator())},function(t){return n.moveNext()&&t.yieldReturn(n.current)})},function(){y.dispose(n)})},e.prototype.memoize=function(){var t,r,o=this,i=!o.throwIfDisposed();return new e(function(){var e=0;return new l["default"](function(){n(i),r||(r=o.getEnumerator()),t||(t=[]),e=0},function(o){n(i);var u=e++;return u>=t.length?r.moveNext()?o.yieldReturn(t[u]=r.current):!1:o.yieldReturn(t[u])})},function(){i=!0,t&&(t.length=0),t=null,y.dispose(r),r=null})},e.prototype.catchError=function(t){var r=this,o=!r.throwIfDisposed();return new e(function(){var e;return new l["default"](function(){try{n(o),e=r.getEnumerator()}catch(t){}},function(r){try{if(n(o),e.moveNext())return r.yieldReturn(e.current)}catch(i){t(i)}return!1},function(){y.dispose(e)})})},e.prototype.finallyAction=function(t){var r=this,o=!r.throwIfDisposed();return new e(function(){var e;return new l["default"](function(){n(o),e=r.getEnumerator()},function(t){return n(o),e.moveNext()?t.yieldReturn(e.current):!1},function(){try{y.dispose(e)}finally{t()}})})},e}(v["default"]);e.Enumerable=I;var R=function(t){function e(e){t.call(this,function(){return n.throwIfDisposed(),new s["default"](function(){return n.throwIfDisposed("The underlying ArrayEnumerable was disposed.","ArrayEnumerator"),n._source})});var n=this;n._disposableObjectName="ArrayEnumerable",n._source=e}return __extends(e,t),e.prototype._onDispose=function(){t.prototype._onDispose.call(this),this._source=null},Object.defineProperty(e.prototype,"source",{get:function(){return this._source},enumerable:!0,configurable:!0}),e.prototype.toArray=function(){var t=this.source;if(!t)return[];if(t instanceof Array)return t.slice();for(var e=t.length,n=i.initialize(e),r=0;e>r;++r)n[r]=t[r];return n},e.prototype.asEnumerable=function(){return new e(this._source)},e.prototype.forEach=function(t){var e=this;e.throwIfDisposed();var n=e._source;if(n)for(var r=0;r<n.length&&t(n[r],r)!==!1;++r);},e.prototype.any=function(e){var n=this;n.throwIfDisposed();var r=n._source,o=r?r.length:0;return o&&(!e||t.prototype.any.call(this,e))},e.prototype.count=function(e){var n=this;n.throwIfDisposed();var r=n._source,o=r?r.length:0;return o&&(e?t.prototype.count.call(this,e):o)},e.prototype.elementAt=function(e){var n=this;n.throwIfDisposed();var r=n._source;return e<r.length&&e>=0?r[e]:t.prototype.elementAt.call(this,e)},e.prototype.elementAtOrDefault=function(t,e){void 0===e&&(e=null);var n=this;n.throwIfDisposed();var r=n._source;return t<r.length&&t>=0?r[t]:e},e.prototype.first=function(){var e=this;e.throwIfDisposed();var n=e._source;return n&&n.length?n[0]:t.prototype.first.call(this)},e.prototype.firstOrDefault=function(t){void 0===t&&(t=null);var e=this;e.throwIfDisposed();var n=e._source;return n&&n.length?n[0]:t},e.prototype.last=function(){var e=this;e.throwIfDisposed();var n=e._source,r=n.length;return r?n[r-1]:t.prototype.last.call(this)},e.prototype.lastOrDefault=function(t){void 0===t&&(t=null);var e=this;e.throwIfDisposed();var n=e._source,r=n.length;return r?n[r-1]:t},e.prototype.skip=function(t){var e=this;return!t||0>t?e.asEnumerable():new I(function(){return new s["default"](function(){return e._source},t)})},e.prototype.takeExceptLast=function(t){void 0===t&&(t=1);var e=this,n=e._source?e._source.length:0;return e.take(n-t)},e.prototype.takeFromLast=function(t){if(!t||0>t)return I.empty();var e=this,n=e._source?e._source.length:0;return e.skip(n-t)},e.prototype.reverse=function(){var t=this;return new I(function(){return new s["default"](function(){return t._source},t._source?t._source.length-1:0,-1)})},e.prototype.memoize=function(){return new e(this._source)},e.prototype.sequenceEqual=function(n,i){return void 0===i&&(i=r.areEqual),n instanceof Array?o.areEqual(this.source,n,!0,i):n instanceof e?n.sequenceEqual(this.source,i):t.prototype.sequenceEqual.call(this,n,i)},e.prototype.toJoinedString=function(e,n){void 0===e&&(e=""),void 0===n&&(n=E.Identity);var r=this._source;return!n&&r instanceof Array?r.join(e):t.prototype.toJoinedString.call(this,e,n)},e}(I),_=function(t){function e(e,n){t.call(this,n),this._groupKey=e}return __extends(e,t),Object.defineProperty(e.prototype,"key",{get:function(){return this._groupKey},enumerable:!0,configurable:!0}),e}(R),b=function(){function t(t){this._dictionary=t}return Object.defineProperty(t.prototype,"count",{get:function(){return this._dictionary.count},enumerable:!0,configurable:!0}),t.prototype.get=function(t){return this._dictionary.getValue(t)},t.prototype.contains=function(t){return this._dictionary.containsKey(t)},t.prototype.getEnumerator=function(){var t,e=this;return new l["default"](function(){t=e._dictionary.getEnumerator()},function(e){if(!t.moveNext())return!1;var n=t.current;return e.yieldReturn(new _(n.key,n.value))},function(){y.dispose(t)})},t}(),S=function(t){function e(e,n){t.call(this,null),this.prevSource=e,this.prevPredicate=n}return __extends(e,t),e.prototype.where=function(n){if(n.length>1)return t.prototype.where.call(this,n);var r=this.prevPredicate,o=function(t){return r(t)&&n(t)};return new e(this.prevSource,o)},e.prototype.select=function(e){return e.length>1?t.prototype.select.call(this,e):new k(this.prevSource,this.prevPredicate,e)},e.prototype.getEnumerator=function(){var t,e=this.prevPredicate,n=this.prevSource;return new l["default"](function(){t=n.getEnumerator()},function(n){for(;t.moveNext();)if(e(t.current))return n.yieldReturn(t.current);return!1},function(){y.dispose(t)})},e.prototype._onDispose=function(){t.prototype._onDispose.call(this),this.prevPredicate=null,this.prevSource=null},e}(I),k=function(t){function e(e,n,r){t.call(this,null),this.prevSource=e,this.prevPredicate=n,this.prevSelector=r}return __extends(e,t),e.prototype.where=function(e){return e.length>1?t.prototype.where.call(this,e):new S(this,e)},e.prototype.select=function(n){if(n.length>1)return t.prototype.select.call(this,n);var r=this,o=r.prevSelector,i=function(t){return n(o(t))};return new e(r.prevSource,r.prevPredicate,i)},e.prototype.getEnumerator=function(){var t,e=this,n=e.prevPredicate,r=e.prevSource,o=e.prevSelector;return new l["default"](function(){t=r.getEnumerator()},function(e){for(;t.moveNext();){var r=t.current;if(null==n||n(r))return e.yieldReturn(o(r))}return!1},function(){y.dispose(t)})},e.prototype._onDispose=function(){var e=this;t.prototype._onDispose.call(this),e.prevPredicate=null,e.prevSource=null,e.prevSelector=null},e}(I),A=function(t){function e(e,n,o,i,u){void 0===u&&(u=r.compare),t.call(this,null),this.source=e,this.keySelector=n,this.descending=o,this.parent=i,this.comparer=u}return __extends(e,t),e.prototype.createOrderedEnumerable=function(t,n){return new e(this.source,t,n,this)},e.prototype.thenBy=function(t){return this.createOrderedEnumerable(t,!1)},e.prototype.thenByDescending=function(t){return this.createOrderedEnumerable(t,!0)},e.prototype.getEnumerator=function(){var t,e,n=this,r=0;return new l["default"](function(){r=0,t=[],e=[],I.forEach(n.source,function(n,r){t[r]=n,e[r]=r});var o=B.create(n,null,n.comparer);o.generateKeys(t),e.sort(function(t,e){return o.compare(t,e)})},function(n){return r<e.length?n.yieldReturn(t[e[r++]]):!1},function(){t&&(t.length=0),t=null,e&&(e.length=0),e=null})},e.prototype._onDispose=function(){
t.prototype._onDispose.call(this),this.source=null,this.keySelector=null,this.descending=null,this.parent=null},e}(I),B=function(){function t(t,e,n,o){void 0===o&&(o=r.compare),this.keySelector=t,this.descending=e,this.child=n,this.comparison=o,this.keys=null}return t.create=function(e,n,o){void 0===n&&(n=null),void 0===o&&(o=r.compare);var i=new t(e.keySelector,e.descending,n,o);return e.parent?t.create(e.parent,i):i},t.prototype.generateKeys=function(t){for(var e=this,n=t.length,r=e.keySelector,o=new Array(n),i=0;n>i;++i)o[i]=r(t[i]);e.keys=o,e.child&&e.child.generateKeys(t)},t.prototype.compare=function(t,e){var n=this,o=n.keys,i=n.comparison(o[t],o[e]);if(0==i){var u=n.child;return u?u.compare(t,e):r.compare(t,e)}return n.descending?-i:i},t}();Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=I});
//# sourceMappingURL=Linq.js.map
