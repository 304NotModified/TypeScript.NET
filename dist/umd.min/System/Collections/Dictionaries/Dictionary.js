/*
 * @author electricessence / https://github.com/electricessence/
 * Original: http://linqjs.codeplex.com/
 * Licensing: MIT https://github.com/electricessence/TypeScript.NET/blob/master/LICENSE.md
 */
var __extends=this&&this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)};!function(e,t){if("object"==typeof module&&"object"==typeof module.exports){var r=t(require,exports);void 0!==r&&(module.exports=r)}else"function"==typeof define&&define.amd&&define(e,t)}(["require","exports","../../Compare","../../Types","../../Functions","./DictionaryAbstractBase","../Enumeration/EnumeratorBase"],function(e,t){function r(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function n(e){return null===e?"null":void 0===e?"undefined":typeof e.toString===i["default"].FUNCTION?e.toString():Object.prototype.toString.call(e)}var o=e("../../Compare"),i=e("../../Types"),u=e("../../Functions"),a=e("./DictionaryAbstractBase"),s=e("../Enumeration/EnumeratorBase"),l=function(){function e(e,t,r,n){this.key=e,this.value=t,this.prev=r,this.next=n}return e}(),c=function(){function e(e,t){this.first=e,this.last=t}return e.prototype.addLast=function(e){var t=this;null!=t.last?(t.last.next=e,e.prev=t.last,t.last=e):t.first=t.last=e},e.prototype.replace=function(e,t){var r=this;null!=e.prev?(e.prev.next=t,t.prev=e.prev):r.first=t,null!=e.next?(e.next.prev=t,t.next=e.next):r.last=t},e.prototype.remove=function(e){var t=this;null!=e.prev?e.prev.next=e.next:t.first=e.next,null!=e.next?e.next.prev=e.prev:t.last=e.prev},e.prototype.clear=function(){for(var e=this;e.last;)e.remove(e.last)},e.prototype.forEach=function(e){for(var t=this,r=t.first;r;)e(r),r=r.next},e}(),p=function(e){function t(t){void 0===t&&(t=u["default"].Identity),e.call(this),this.compareSelector=t,this._count=0,this._entries=new c,this._buckets={}}return __extends(t,e),t.prototype.setKV=function(e,t,i){var u,a=this,s=a._buckets,c=a._entries,p=a.compareSelector,f=p(e),v=n(f);if(r(s,v)){for(var y=o.areEqual,d=s[v],h=0;h<d.length;h++){var _=d[h];if(p(_.key)===f){if(!i)throw new Error("Key already exists.");var b=!y(_.value,t);return b&&(void 0===t?(c.remove(_),d.splice(h,1),d.length||delete s[v],--a._count):(u=new l(e,t),c.replace(_,u),d[h]=u),a._onValueUpdate(e,t,_.value)),b}}d.push(u=u||new l(e,t))}else{if(void 0===t){if(i)return!1;throw new Error("Cannot add 'undefined' value.")}s[v]=[u=new l(e,t)]}return++a._count,c.addLast(u),a._onValueUpdate(e,t,void 0),!0},t.prototype.addByKeyValue=function(e,t){this.setKV(e,t,!1)},t.prototype.getValue=function(e){var t=this._buckets,o=this.compareSelector,i=o(e),u=n(i);if(!r(t,u))return void 0;for(var a=t[u],s=0;s<a.length;s++){var l=a[s];if(o(l.key)===i)return l.value}return void 0},t.prototype.setValue=function(e,t){return this.setKV(e,t,!0)},t.prototype.containsKey=function(e){var t=this,o=t._buckets,i=t.compareSelector,u=i(e),a=n(u);if(!r(o,a))return!1;for(var s=o[a],l=0,c=s.length;c>l;l++)if(i(s[l].key)===u)return!0;return!1},t.prototype.clear=function(){var t=this,r=t._buckets,n=e.prototype.clear.call(this);t._count=0;for(var o in r)r.hasOwnProperty(o)&&delete r[o];return t._entries.clear(),n},Object.defineProperty(t.prototype,"count",{get:function(){return this._count},enumerable:!0,configurable:!0}),t.prototype.getEnumerator=function(){var e,t=this;return new s["default"](function(){e=t._entries.first},function(t){if(null!=e){var r={key:e.key,value:e.value};return e=e.next,t.yieldReturn(r)}return t.yieldBreak()})},Object.defineProperty(t.prototype,"keys",{get:function(){var e=this,t=[];return e._entries.forEach(function(e){return t.push(e.key)}),t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"values",{get:function(){var e=this,t=[];return e._entries.forEach(function(e){return t.push(e.value)}),t},enumerable:!0,configurable:!0}),t}(a["default"]);Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=p});
//# sourceMappingURL=Dictionary.js.map
