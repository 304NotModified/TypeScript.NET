/*!
 * @author electricessence / https://github.com/electricessence/
 * Licensing: MIT https://github.com/electricessence/TypeScript.NET/blob/master/LICENSE.md
 */
!function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports);void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define(["require","exports","../../Types","../../Disposable/DisposableBase","../../Disposable/ObjectPool","./IteratorResult","../../../extends"],e)}(function(e,t){"use strict";function r(e){return i||(i=new u.ObjectPool(40,function(){return new c},function(e){return e.yieldBreak()})),e?void i.add(e):i.take()}var i,n,s=e("../../Types"),o=e("../../Disposable/DisposableBase"),u=e("../../Disposable/ObjectPool"),a=e("./IteratorResult"),d=e("../../../extends"),p=d["default"],l=void 0,c=function(){function e(){this._current=l,this._index=NaN}return Object.defineProperty(e.prototype,"current",{get:function(){return this._current},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"index",{get:function(){return this._index},enumerable:!0,configurable:!0}),e.prototype.yieldReturn=function(e){return this._current=e,isNaN(this._index)?this._index=0:this._index++,!0},e.prototype.yieldBreak=function(){return this._current=l,this._index=NaN,!1},e.prototype.dispose=function(){this.yieldBreak()},e}();!function(e){e[e.Before=0]="Before",e[e.Running=1]="Running",e[e.Completed=2]="Completed",e[e.Faulted=3]="Faulted",e[e.Interrupted=4]="Interrupted",e[e.Disposed=5]="Disposed"}(n||(n={}));var f=function(e){function t(t,r,i,n){e.call(this),this._initializer=t,this._tryGetNext=r,this.reset(),s.Type.isBoolean(n)?this._isEndless=n:s.Type.isBoolean(i)&&(this._isEndless=i),s.Type.isFunction(i)&&(this._disposer=i)}return p(t,e),Object.defineProperty(t.prototype,"current",{get:function(){var e=this._yielder;return e&&e.current},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"index",{get:function(){var e=this._yielder;return e&&e.index},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isEndless",{get:function(){return this._isEndless},enumerable:!0,configurable:!0}),t.prototype.reset=function(){var e=this;e.throwIfDisposed();var t=e._yielder;e._yielder=null,e._state=n.Before,t&&r(t)},t.prototype._assertBadState=function(){var e=this;switch(e._state){case n.Faulted:e.throwIfDisposed("This enumerator caused a fault and was disposed.");break;case n.Disposed:e.throwIfDisposed("This enumerator was manually disposed.")}},t.prototype.moveNext=function(){var e=this;e._assertBadState();try{switch(e._state){case n.Before:e._yielder=e._yielder||r(),e._state=n.Running;var t=e._initializer;t&&t();case n.Running:return!!e._tryGetNext(e._yielder)||(this.dispose(),e._state=n.Completed,!1);default:return!1}}catch(i){throw this.dispose(),e._state=n.Faulted,i}},t.prototype.nextValue=function(){return this.moveNext()?this.current:l},t.prototype.next=function(){return this.moveNext()?new a.IteratorResult(this.current,this.index):a.IteratorResult.Done},t.prototype.end=function(){this._ensureDisposeState(n.Interrupted)},t.prototype["return"]=function(e){var t=this;t._assertBadState();try{return e===l||t._state===n.Completed||t._state===n.Interrupted?a.IteratorResult.Done:new a.IteratorResult(e,l,(!0))}finally{t.end()}},t.prototype._ensureDisposeState=function(e){var t=this;t.wasDisposed||(t.dispose(),t._state=e)},t.prototype._onDispose=function(){var e=this;e._isEndless=!1;var t=e._disposer;e._initializer=null,e._disposer=null;var i=e._yielder;e._yielder=null,this._state=n.Disposed,i&&r(i),t&&t()},t}(o.DisposableBase);t.EnumeratorBase=f,Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=f});
//# sourceMappingURL=EnumeratorBase.js.map