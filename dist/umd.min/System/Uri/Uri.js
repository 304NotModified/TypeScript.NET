/*
 * @author electricessence / https://github.com/electricessence/
 * Licensing: MIT https://github.com/electricessence/TypeScript.NET/blob/master/LICENSE.md
 * Based on: https://en.wikipedia.org/wiki/Uniform_Resource_Identifier
 */
!function(t,e){if("object"==typeof module&&"object"==typeof module.exports){var r=e(require,exports);void 0!==r&&(module.exports=r)}else"function"==typeof define&&define.amd&&define(t,e)}(["require","exports","../Types","../Uri/QueryParams","../Text/Utility","../Uri/Scheme","../Exceptions/ArgumentException","../Exceptions/ArgumentOutOfRangeException"],function(t,e){function r(t,e){void 0===e&&(e={});for(var r,n=0;r=c.Fields[n++];){var i=t[r];i&&(e[r]=i)}return e}function n(t){var e=t;if(l["default"].isString(e)){if(!e)return void 0;if(e=d["default"][h.trim(e).toLowerCase().replace(/[^a-z0-9+.-]+$/g,O)],isNaN(e))throw new m["default"]("scheme",t,"Invalid scheme.")}if(l["default"].isNumber(e,!1)){if(e=d["default"][e],!e)throw new m["default"]("scheme",t,"Invalid scheme.");return e}return void 0}function i(t){if(!t.host){if(t.userInfo)throw new g["default"]("host","Cannot include user info when there is no host.");if(l["default"].isNumber(t.port,!1))throw new g["default"]("host","Cannot include a port when there is no host.")}var e=t.host||O;return e&&(t.userInfo&&(e=t.userInfo+w+e),isNaN(t.port)||(e+=":"+t.port),e=b+e),e}function u(t){return t&&(-1==t.indexOf(v)?v:O)+t}function o(t){return t&&(-1==t.indexOf(x)?x:O)+t}function s(t){var e=t.path,r=t.query;return O+(e&&(-1==e.indexOf(y)?y:O)+e||O)+(u(r)||O)}function f(t){var e=n(t.scheme),r=i(t),u=s(t),f=o(t.fragment);return O+(e&&e+":"||O)+(r||O)+(u||O)+(f||O)}function a(t,e){if(!t)return new g["default"]("url","Nothing to parse.");var n,i={};if(n=t.indexOf(x),-1!=n&&(i.fragment=t.substring(n),t=t.substring(0,n)),n=t.indexOf(v),-1!=n&&(i.query=t.substring(n),t=t.substring(0,n)),n=t.indexOf(b),-1!=n){var u=h.trim(t.substring(0,n)),o=/:$/;if(!o.test(u))return new g["default"]("url","Scheme was improperly formatted");u=h.trim(u.replace(o,O)),i.scheme=u||void 0,t=t.substring(n+2)}if(n=t.indexOf(y),-1!=n&&(i.path=t.substring(n)||void 0,t=t.substring(0,n)),n=t.indexOf(w),-1!=n&&(i.userInfo=t.substring(0,n)||void 0,t=t.substring(n+1)),n=t.indexOf(":"),-1!=n){var s=parseInt(h.trim(t.substring(n+1)));if(isNaN(s))return new g["default"]("url","Port was invalid.");i.port=s,t=t.substring(0,n)}return t=h.trim(t),t&&(i.host=t),e(r(i)),null}var c,l=t("../Types"),p=t("../Uri/QueryParams"),h=t("../Text/Utility"),d=t("../Uri/Scheme"),g=t("../Exceptions/ArgumentException"),m=t("../Exceptions/ArgumentOutOfRangeException"),c=function(){function t(t,e,r,i,s,f,a){var c=this;c.scheme=n(t)||null,c.userInfo=e||null,c.host=r||null,c.port=i||null,c.authority=c.getAuthority()||null,c.path=s||null,l["default"].isString(f)||(f=p.encode(f)),c.query=u(f)||null,Object.freeze(c.queryParams=c.query?p.parseToMap(c.query):{}),c.pathAndQuery=c.getPathAndQuery()||null,c.fragment=o(a)||null,c.absoluteUri=c.getAbsoluteUri(),Object.freeze(c)}return t.prototype.equals=function(e){return this===e||this.absoluteUri==t.toString(e)},t.from=function(e){var r=!e||l["default"].isString(e)?t.parse(e):e;return new t(r.scheme,r.userInfo,r.host,r.port,r.path,r.query,r.fragment)},t.parse=function(t,e){void 0===e&&(e=!0);var r=null,n=a(t,function(t){r=t});if(e&&n)throw n;return r},t.tryParse=function(t,e){return!a(t,e)},t.copyOf=function(t){return r(t)},t.prototype.copyTo=function(t){return r(this,t)},t.prototype.getAbsoluteUri=function(){return f(this)},t.prototype.getAuthority=function(){return i(this)},t.prototype.getPathAndQuery=function(){return s(this)},Object.defineProperty(t.prototype,"pathSegments",{get:function(){return this.path.match(/^[\/]|[^\/]*[\/]|[^\/]+$/g)},enumerable:!0,configurable:!0}),t.prototype.toMap=function(){return this.copyTo({})},t.prototype.toString=function(){return this.absoluteUri},t.toString=function(e){return e instanceof t?e.absoluteUri:f(e)},t.getAuthority=function(t){return i(t)},t}();!function(t){!function(t){t[t.scheme=0]="scheme",t[t.userInfo=1]="userInfo",t[t.host=2]="host",t[t.port=3]="port",t[t.path=4]="path",t[t.query=5]="query",t[t.fragment=6]="fragment"}(t.Fields||(t.Fields={}));var e=t.Fields;Object.freeze(e)}(c||(c={}));var y="/",b="//",v="?",x="#",O="",w="@";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=c});
//# sourceMappingURL=Uri.js.map
