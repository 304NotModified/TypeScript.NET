{"version":3,"sources":["System/Collections/Enumeration/EnumeratorBase.ts"],"names":["Yielder","Yielder.yieldReturn","Yielder.yieldBreak","Yielder.current","EnumeratorState","EnumeratorBase","EnumeratorBase.constructor","EnumeratorBase.reset","EnumeratorBase.moveNext","EnumeratorBase._onDispose","EnumeratorBase.current"],"mappings":"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","file":"System/Collections/Enumeration/EnumeratorBase.js","sourcesContent":["/*\r\n * @author electricessence / https://github.com/electricessence/\r\n * Licensing: MIT https://github.com/electricessence/TypeScript.NET/blob/master/LICENSE.md\r\n */\r\n\r\n///<reference path=\"../../Disposable/IDisposable.d.ts\"/>\r\n///<reference path=\"IEnumerator.d.ts\"/>\r\n///<reference path=\"IYield.d.ts\"/>\r\nimport Type from '../../Types';\r\nimport DisposableBase from '../../Disposable/DisposableBase'\r\n\r\n\r\n\r\nclass Yielder<T> implements IYield<T>\r\n{\r\n\tprivate _current:T;\r\n\tget current():T { return this._current; }\r\n\r\n\tyieldReturn(value:T):boolean {\r\n\t\tthis._current = value;\r\n\t\treturn true;\r\n\t}\r\n\r\n\tyieldBreak():boolean {\r\n\t\tthis._current = null;\r\n\t\treturn false;\r\n\t}\r\n}\r\n\r\n// IEnumerator State\r\nenum EnumeratorState { Before, Running, After }\r\n\r\n// Naming this class EnumeratorBase to avoid collision with IE.\r\nexport default\r\nclass EnumeratorBase<T> extends DisposableBase implements IEnumerator<T>\r\n{\r\n\r\n\tprivate _yielder:Yielder<T>;\r\n\tprivate _state:EnumeratorState;\r\n\r\n\tget current():T {\r\n\t\treturn this._yielder.current;\r\n\t}\r\n\r\n\t// \"Enumerator\" is conflict JScript's \"Enumerator\"\r\n\tconstructor(\r\n\t\tprivate initializer:() => void,\r\n\t\tprivate tryGetNext:(yielder:IYield<T>) => boolean,\r\n\t\tprivate disposer?:() => void)\r\n\t{\r\n\t\tsuper();\r\n\t\tthis.reset();\r\n\t}\r\n\r\n\r\n\treset():void {\r\n\t\tvar _ = this;\r\n\t\t_._yielder = new Yielder<T>();\r\n\t\t_._state = EnumeratorState.Before;\r\n\t}\r\n\r\n\tmoveNext():boolean {\r\n\t\tvar _ = this;\r\n\t\ttry {\r\n\t\t\tswitch(_._state) {\r\n\t\t\t\tcase EnumeratorState.Before:\r\n\t\t\t\t\t_._state = EnumeratorState.Running;\r\n\t\t\t\t\tvar initializer = _.initializer;\r\n\t\t\t\t\tif(initializer)\r\n\t\t\t\t\t\tinitializer();\r\n\t\t\t\t// fall through\r\n\t\t\t\tcase EnumeratorState.Running:\r\n\t\t\t\t\tif(_.tryGetNext(_._yielder)) {\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tthis.dispose();\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\tcase EnumeratorState.After:\r\n\t\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t}\r\n\t\tcatch(e) {\r\n\t\t\tthis.dispose();\r\n\t\t\tthrow e;\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _onDispose():void {\r\n\t\tvar _ = this, disposer = _.disposer;\r\n\r\n\t\t_.initializer = null;\r\n\t\t_.disposer = null;\r\n\r\n\t\tvar yielder = _._yielder;\r\n\t\t_._yielder = null;\r\n\t\tif(yielder)\r\n\t\t\tyielder.yieldBreak();\r\n\r\n\t\ttry {\r\n\r\n\t\t\tif(disposer)\r\n\t\t\t\tdisposer();\r\n\r\n\t\t}\r\n\t\tfinally {\r\n\t\t\t//if(this._state==EnumeratorState.Running)\r\n\t\t\tthis._state = EnumeratorState.After;\r\n\t\t}\r\n\t}\r\n\r\n}\r\n"]}