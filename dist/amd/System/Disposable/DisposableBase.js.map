{"version":3,"sources":["System/Disposable/DisposableBase.js","System/Disposable/DisposableBase.ts"],"names":["define","require","exports","ObjectDisposedException_1","DisposableBase","_finalizer","this","_wasDisposed","Object","defineProperty","prototype","get","enumerable","configurable","throwIfDisposed","message","objectName","_disposableObjectName","ObjectDisposedException","dispose","_","_onDispose","value"],"mappings":";;;;AAIAA,QAAQ,UAAW,UAAW,6BAA8B,SAAUC,EAASC,EAASC,GACpF,YCGJ,IAAAC,GAAA,WAGC,QAAAA,GAAoBC,GAAAC,KAAAD,WAAAA,EAIZC,KAAAC,cAAuB,EA0ChC,MAzCCC,QAAAC,eAAIL,EAAAM,UAAA,eDJOC,ICIX,WAEC,MAAOL,MAAKC,cDHFK,YAAY,EACZC,cAAc,ICQfT,EAAAM,UAAAI,gBAAV,SACCC,EACAC,GAEA,GAFA,SAAAA,IAAAA,EAAoBV,KAAKW,uBAEtBX,KAAKC,aACP,KAAM,IAAIJ,GAAAe,wBAAwBF,EAAYD,EAC/C,QAAO,GAIRX,EAAAM,UAAAS,QAAA,WAEC,GAAIC,GAAId,IACR,KAAIc,EAAEb,aACN,CAGCa,EAAEb,cAAe,CACjB,KAECa,EAAEC,aDbU,QCiBTD,EAAEf,YACJe,EAAEf,gBAMID,EAAAM,UAAAW,WAAV,aAEDjB,IAjDsBF,GAAAE,eAAcA,EAmDpCI,OAAAC,eAAAP,EAAA,cAAAoB,OAAA,IDjBIpB,EAAAA,WCiBWE","file":"System/Disposable/DisposableBase.js","sourcesContent":["/*!\n * @author electricessence / https://github.com/electricessence/\n * Licensing: MIT https://github.com/electricessence/TypeScript.NET/blob/master/LICENSE.md\n */\ndefine([\"require\", \"exports\", \"./ObjectDisposedException\"], function (require, exports, ObjectDisposedException_1) {\n    \"use strict\";\n    var DisposableBase = (function () {\n        function DisposableBase(_finalizer) {\n            this._finalizer = _finalizer;\n            this._wasDisposed = false;\n        }\n        Object.defineProperty(DisposableBase.prototype, \"wasDisposed\", {\n            get: function () {\n                return this._wasDisposed;\n            },\n            enumerable: true,\n            configurable: true\n        });\n        DisposableBase.prototype.throwIfDisposed = function (message, objectName) {\n            if (objectName === void 0) { objectName = this._disposableObjectName; }\n            if (this._wasDisposed)\n                throw new ObjectDisposedException_1.ObjectDisposedException(objectName, message);\n            return true;\n        };\n        DisposableBase.prototype.dispose = function () {\n            var _ = this;\n            if (!_._wasDisposed) {\n                _._wasDisposed = true;\n                try {\n                    _._onDispose();\n                }\n                finally {\n                    if (_._finalizer)\n                        _._finalizer();\n                }\n            }\n        };\n        DisposableBase.prototype._onDispose = function () { };\n        return DisposableBase;\n    }());\n    exports.DisposableBase = DisposableBase;\n    Object.defineProperty(exports, \"__esModule\", { value: true });\n    exports.default = DisposableBase;\n});\n","/*!\r\n * @author electricessence / https://github.com/electricessence/\r\n * Licensing: MIT https://github.com/electricessence/TypeScript.NET/blob/master/LICENSE.md\r\n */\r\n\r\nimport {ObjectDisposedException} from \"./ObjectDisposedException\";\r\nimport {IDisposableAware} from \"./IDisposableAware\";\r\n\r\nexport abstract class DisposableBase implements IDisposableAware\r\n{\r\n\r\n\tconstructor(private _finalizer?:() => void)\r\n\t{\r\n\t}\r\n\r\n\tprivate _wasDisposed:boolean = false;\r\n\tget wasDisposed():boolean\r\n\t{\r\n\t\treturn this._wasDisposed;\r\n\t}\r\n\r\n\t// Allow for simple override of name.\r\n\tprotected _disposableObjectName:string;\r\n\r\n\tprotected throwIfDisposed(\r\n\t\tmessage?:string,\r\n\t\tobjectName:string = this._disposableObjectName):boolean\r\n\t{\r\n\t\tif(this._wasDisposed)\r\n\t\t\tthrow new ObjectDisposedException(objectName, message);\r\n\t\treturn true;\r\n\t}\r\n\r\n\r\n\tdispose():void\r\n\t{\r\n\t\tvar _ = this;\r\n\t\tif(!_._wasDisposed)\r\n\t\t{\r\n\t\t\t// Preemptively set wasDisposed in order to prevent repeated disposing.\r\n\t\t\t// NOTE: in true multi-threaded scenarios, this needs to be synchronized.\r\n\t\t\t_._wasDisposed = true;\r\n\t\t\ttry\r\n\t\t\t{\r\n\t\t\t\t_._onDispose(); // Protected override.\r\n\t\t\t}\r\n\t\t\tfinally\r\n\t\t\t{\r\n\t\t\t\tif(_._finalizer) // Private finalizer...\r\n\t\t\t\t\t_._finalizer();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t// Placeholder for overrides.\r\n\tprotected _onDispose():void { }\r\n\r\n}\r\n\r\nexport default DisposableBase;"]}