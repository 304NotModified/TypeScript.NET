/*
 * @author electricessence / https://github.com/electricessence/
 * Original: http://linqjs.codeplex.com/
 * Licensing: MIT https://github.com/electricessence/TypeScript.NET/blob/master/LICENSE.md
 */
var __extends=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)};define(["require","exports","../../Compare","../../Types","../../Functions","./DictionaryAbstractBase","../Enumeration/EnumeratorBase"],function(t,e,r,n,o,i,u){function a(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function s(t){return null===t?"null":void 0===t?"undefined":typeof t.toString===n.FUNCTION?t.toString():Object.prototype.toString.call(t)}var c=function(){function t(t,e,r,n){this.key=t,this.value=e,this.prev=r,this.next=n}return t}(),l=function(){function t(t,e){this.first=t,this.last=e}return t.prototype.addLast=function(t){var e=this;null!=e.last?(e.last.next=t,t.prev=e.last,e.last=t):e.first=e.last=t},t.prototype.replace=function(t,e){var r=this;null!=t.prev?(t.prev.next=e,e.prev=t.prev):r.first=e,null!=t.next?(t.next.prev=e,e.next=t.next):r.last=e},t.prototype.remove=function(t){var e=this;null!=t.prev?t.prev.next=t.next:e.first=t.next,null!=t.next?t.next.prev=t.prev:e.last=t.prev},t.prototype.clear=function(){for(var t=this;t.last;)t.remove(t.last)},t.prototype.forEach=function(t){for(var e=this,r=e.first;r;)t(r),r=r.next},t}(),p=function(t){function e(e){void 0===e&&(e=o.Identity),t.call(this),this.compareSelector=e,this._count=0,this._entries=new l,this._buckets={}}return __extends(e,t),e.prototype.setKV=function(t,e,n){var o,i=this,u=i._buckets,l=i._entries,p=i.compareSelector,f=p(t),v=s(f);if(a(u,v)){for(var h=r.areEqual,y=u[v],d=0;d<y.length;d++){var _=y[d];if(p(_.key)===f){if(!n)throw new Error("Key already exists.");var x=!h(_.value,e);return x&&(void 0===e?(l.remove(_),y.splice(d,1),y.length||delete u[v],--i._count):(o=new c(t,e),l.replace(_,o),y[d]=o),i._onValueUpdate(t,e,_.value)),x}}y.push(o=o||new c(t,e))}else{if(void 0===e){if(n)return!1;throw new Error("Cannot add 'undefined' value.")}u[v]=[o=new c(t,e)]}return++i._count,l.addLast(o),i._onValueUpdate(t,e,void 0),!0},e.prototype.addByKeyValue=function(t,e){this.setKV(t,e,!1)},e.prototype.getValue=function(t){var e=this._buckets,r=this.compareSelector,n=r(t),o=s(n);if(!a(e,o))return void 0;for(var i=e[o],u=0;u<i.length;u++){var c=i[u];if(r(c.key)===n)return c.value}return void 0},e.prototype.setValue=function(t,e){return this.setKV(t,e,!0)},e.prototype.containsKey=function(t){var e=this,r=e._buckets,n=e.compareSelector,o=n(t),i=s(o);if(!a(r,i))return!1;for(var u=r[i],c=0,l=u.length;l>c;c++)if(n(u[c].key)===o)return!0;return!1},e.prototype.clear=function(){var e=this,r=e._buckets,n=t.prototype.clear.call(this);e._count=0;for(var o in r)r.hasOwnProperty(o)&&delete r[o];return e._entries.clear(),n},Object.defineProperty(e.prototype,"count",{get:function(){return this._count},enumerable:!0,configurable:!0}),e.prototype.getEnumerator=function(){var t,e=this;return new u(function(){t=e._entries.first},function(e){if(null!=t){var r={key:t.key,value:t.value};return t=t.next,e.yieldReturn(r)}return e.yieldBreak()})},Object.defineProperty(e.prototype,"keys",{get:function(){var t=this,e=[];return t._entries.forEach(function(t){return e.push(t.key)}),e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"values",{get:function(){var t=this,e=[];return t._entries.forEach(function(t){return e.push(t.value)}),e},enumerable:!0,configurable:!0}),e}(i);return p});
//# sourceMappingURL=Dictionary.js.map
