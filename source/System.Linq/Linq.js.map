{"version":3,"sources":["System.Linq/Linq.ts"],"names":[],"mappings":"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","file":"System.Linq/Linq.js","sourcesContent":["/*!\r\n * @author electricessence / https://github.com/electricessence/\r\n * Original: http://linqjs.codeplex.com/\r\n * Licensing: MIT https://github.com/electricessence/TypeScript.NET/blob/master/LICENSE.md\r\n */\r\n\r\n\r\nimport * as Values from \"../System/Compare\";\r\nimport * as Arrays from \"../System/Collections/Array/Compare\";\r\nimport * as ArrayUtility from \"../System/Collections/Array/Utility\";\r\nimport {\r\n\tfrom as enumeratorFrom,\r\n\tforEach,\r\n\ttoArray,\r\n\tmap,\r\n\tisEnumerable,\r\n\tthrowIfEndless\r\n} from \"../System/Collections/Enumeration/Enumerator\";\r\nimport {EmptyEnumerator} from \"../System/Collections/Enumeration/EmptyEnumerator\";\r\nimport {Type} from \"../System/Types\";\r\nimport {Integer} from \"../System/Integer\";\r\nimport {Functions as BaseFunctions} from \"../System/Functions\";\r\nimport {ArrayEnumerator} from \"../System/Collections/Enumeration/ArrayEnumerator\";\r\nimport {EnumeratorBase} from \"../System/Collections/Enumeration/EnumeratorBase\";\r\nimport {Dictionary} from \"../System/Collections/Dictionaries/Dictionary\";\r\nimport {Queue} from \"../System/Collections/Queue\";\r\nimport {dispose, using} from \"../System/Disposable/dispose\";\r\nimport {DisposableBase} from \"../System/Disposable/DisposableBase\";\r\nimport {UnsupportedEnumerableException} from \"../System/Collections/Enumeration/UnsupportedEnumerableException\";\r\nimport {ObjectDisposedException} from \"../System/Disposable/ObjectDisposedException\";\r\nimport {KeySortedContext} from \"../System/Collections/Sorting/KeySortedContext\";\r\nimport {ArgumentNullException} from \"../System/Exceptions/ArgumentNullException\";\r\nimport {ArgumentOutOfRangeException} from \"../System/Exceptions/ArgumentOutOfRangeException\";\r\nimport {IEnumerator} from \"../System/Collections/Enumeration/IEnumerator\";\r\nimport {IEnumerable} from \"../System/Collections/Enumeration/IEnumerable\";\r\nimport {Action, Predicate, Selector, EqualityComparison, Comparison} from \"../System/FunctionTypes\";\r\nimport {IEnumerableOrArray} from \"../System/Collections/IEnumerableOrArray\";\r\nimport {IArray} from \"../System/Collections/Array/IArray\";\r\nimport {IMap, IDictionary} from \"../System/Collections/Dictionaries/IDictionary\";\r\nimport {Comparable} from \"../System/IComparable\";\r\nimport {IComparer} from \"../System/IComparer\";\r\nimport {IKeyValuePair} from \"../System/KeyValuePair\";\r\nimport {Order} from \"../System/Collections/Sorting/Order\";\r\nimport {\r\n\tIInfiniteEnumerable,\r\n\tILinqEnumerable,\r\n\tIFiniteEnumerable,\r\n\tILookup,\r\n\tIOrderedEnumerable,\r\n\tIGrouping,\r\n\tEnumerableAction\r\n} from \"./Enumerable\";\r\nimport __extendsImport from \"../extends\";\r\nconst __extends = __extendsImport;\r\n\r\n\r\n// #region Local Constants.\r\n\r\nconst INVALID_DEFAULT:any = {}; // create a private unique instance for referencing.\r\nconst VOID0:any = void 0;\r\nconst BREAK:(e:any)=>EnumerableAction = element => EnumerableAction.Break;\r\n\r\n// Leave internal to avoid accidental overwriting.\r\nclass LinqFunctions extends BaseFunctions\r\n{\r\n\tGreater<T>(a:T, b:T)\r\n\t{\r\n\t\treturn a>b ? a : b;\r\n\t}\r\n\r\n\tLesser<T>(a:T, b:T)\r\n\t{\r\n\t\treturn a<b ? a : b;\r\n\t}\r\n}\r\n\r\nvar Functions = new LinqFunctions();\r\nObject.freeze(Functions);\r\n\r\n// For re-use as a factory.\r\nfunction getEmptyEnumerator():IEnumerator<any>\r\n{\r\n\treturn EmptyEnumerator;\r\n}\r\n\r\n// #endregion\r\n\r\n\r\n\r\n/*\r\n * NOTE: About InfiniteEnumerable<T> and Enumerable<T>.\r\n * There may seem like there's extra overrides here and they may seem unnecessary.\r\n * But after closer inspection you'll see the type chain is retained and\r\n * infinite enumerables are prevented from having features that finite ones have.\r\n *\r\n * I'm not sure if it's the best option to just use overrides, but it honors the typing properly.\r\n */\r\n\r\nexport class InfiniteEnumerable<T>\r\nextends DisposableBase implements IInfiniteEnumerable<T>\r\n{\r\n\tconstructor(\r\n\t\tprotected _enumeratorFactory:() => IEnumerator<T>,\r\n\t\tfinalizer?:() => void)\r\n\t{\r\n\t\tsuper(finalizer);\r\n\t\tthis._isEndless = true;\r\n\t}\r\n\r\n\tprotected _isEndless:boolean;\r\n\tget isEndless():boolean\r\n\t{\r\n\t\treturn this._isEndless;\r\n\t}\r\n\r\n\t// #region IEnumerable<T> Implementation...\r\n\tgetEnumerator():IEnumerator<T>\r\n\t{\r\n\r\n\t\tthis.throwIfDisposed();\r\n\r\n\t\treturn this._enumeratorFactory();\r\n\t}\r\n\r\n\t// #endregion\r\n\r\n\t// #region IDisposable override...\r\n\tprotected _onDispose():void\r\n\t{\r\n\t\tsuper._onDispose(); // Just in case.\r\n\t\tthis._enumeratorFactory = null;\r\n\t}\r\n\r\n\t// #endregion\r\n\r\n\t// Return a default (unfiltered) enumerable.\r\n\tasEnumerable():InfiniteEnumerable<T>\r\n\t{\r\n\t\tvar _ = this;\r\n\t\t_.throwIfDisposed();\r\n\t\treturn new InfiniteEnumerable<T>(() => _.getEnumerator());\r\n\t}\r\n\r\n\r\n\t/**\r\n\t * Similar to forEach, but executes an action for each time a value is enumerated.\r\n\t * If the action explicitly returns false or 0 (EnumerationAction.Break), the enumeration will complete.\r\n\t * If it returns a 2 (EnumerationAction.Skip) it will move on to the next item.\r\n\t * This also automatically handles disposing the enumerator.\r\n\t */\r\n\tdoAction(\r\n\t\taction:Action<T> | Predicate<T> | Selector<T, number> | Selector<T, EnumerableAction>,\r\n\t\tinitializer?:()=>void,\r\n\t\tisEndless:boolean = this.isEndless):InfiniteEnumerable<T>\r\n\t{\r\n\r\n\t\tvar _ = this, disposed = !_.throwIfDisposed();\r\n\r\n\t\treturn new Enumerable<T>(\r\n\t\t\t() =>\r\n\t\t\t{\r\n\t\t\t\tvar enumerator:IEnumerator<T>;\r\n\t\t\t\tvar index:number = 0;\r\n\r\n\t\t\t\treturn new EnumeratorBase<T>(\r\n\t\t\t\t\t() =>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthrowIfDisposed(disposed);\r\n\r\n\t\t\t\t\t\tif(initializer) initializer();\r\n\t\t\t\t\t\tindex = 0;\r\n\t\t\t\t\t\tenumerator = _.getEnumerator();\r\n\t\t\t\t\t\t// May need a way to propagate isEndless\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\t(yielder)=>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthrowIfDisposed(disposed);\r\n\r\n\t\t\t\t\t\twhile(enumerator.moveNext())\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tvar actionResult = <any>action(enumerator.current, index++);\r\n\r\n\t\t\t\t\t\t\tif(actionResult===false || actionResult===EnumerableAction.Break)\r\n\t\t\t\t\t\t\t\treturn yielder.yieldBreak();\r\n\r\n\t\t\t\t\t\t\tif(actionResult!==EnumerableAction.Skip) // || !== 2\r\n\t\t\t\t\t\t\t\treturn yielder.yieldReturn(enumerator.current);\r\n\r\n\t\t\t\t\t\t\t// If actionResult===2, then a signal for skip is received.\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\t() =>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tdispose(enumerator);\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\tisEndless\r\n\t\t\t\t);\r\n\r\n\t\t\t},\r\n\t\t\t// Using a finalizer value reduces the chance of a circular reference\r\n\t\t\t// since we could simply reference the enumeration and check e.wasDisposed.\r\n\t\t\t() =>\r\n\t\t\t{\r\n\t\t\t\tdisposed = true;\r\n\t\t\t},\r\n\r\n\t\t\tisEndless\r\n\t\t);\r\n\t}\r\n\r\n\r\n\tforce():void\r\n\t{\r\n\t\tthis.throwIfDisposed();\r\n\t\tthis.doAction(BREAK)\r\n\t\t\t.getEnumerator()\r\n\t\t\t.moveNext();\r\n\r\n\t}\r\n\r\n\t// #region Indexing/Paging methods.\r\n\tskip(count:number):InfiniteEnumerable<T>\r\n\t{\r\n\t\tvar _ = this;\r\n\t\t_.throwIfDisposed();\r\n\r\n\t\tif(!isFinite(count)) // +Infinity equals skip all so return empty.\r\n\t\t\treturn Enumerable.empty<T>();\r\n\r\n\t\tInteger.assert(count, \"count\");\r\n\r\n\t\treturn this.doAction(\r\n\t\t\t(element:T, index?:number) =>\r\n\t\t\t\tindex<count\r\n\t\t\t\t\t? EnumerableAction.Skip\r\n\t\t\t\t\t: EnumerableAction.Return\r\n\t\t);\r\n\t}\r\n\r\n\r\n\ttake(count:number):FiniteEnumerable<T>\r\n\t{\r\n\t\tif(!(count>0)) // Out of bounds? Empty.\r\n\t\t\treturn Enumerable.empty<T>();\r\n\r\n\t\tvar _ = this;\r\n\t\t_.throwIfDisposed();\r\n\r\n\t\tif(!isFinite(count))\r\n\t\t\tthrow new ArgumentOutOfRangeException('count', count, 'Must be finite.');\r\n\r\n\t\tInteger.assert(count, \"count\");\r\n\r\n\t\t// Once action returns false, the enumeration will stop.\r\n\t\treturn <Enumerable<T>>_.doAction((element:T, index?:number) => index<count, null, false);\r\n\t}\r\n\r\n\t// #region Single Value Return...\r\n\r\n\telementAt(index:number):T\r\n\t{\r\n\t\tvar v = this.elementAtOrDefault(index, INVALID_DEFAULT);\r\n\t\tif(v===INVALID_DEFAULT) throw new ArgumentOutOfRangeException('index', index, \"is greater than or equal to the number of elements in source\");\r\n\t\treturn v;\r\n\t}\r\n\r\n\telementAtOrDefault(index:number, defaultValue:T = null):T\r\n\t{\r\n\t\tvar _ = this;\r\n\t\t_.throwIfDisposed();\r\n\r\n\t\tInteger.assertZeroOrGreater(index, 'index');\r\n\t\tvar n:number = index;\r\n\r\n\t\treturn using(\r\n\t\t\tthis.getEnumerator(),\r\n\t\t\te=>\r\n\t\t\t{\r\n\t\t\t\tvar i = 0;\r\n\t\t\t\twhile(e.moveNext())\r\n\t\t\t\t{\r\n\t\t\t\t\tif(i==n) return e.current;\r\n\t\t\t\t\ti++;\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn defaultValue;\r\n\t\t\t});\r\n\t}\r\n\r\n\t/* Note: Unlike previous implementations, you could pass a predicate into these methods.\r\n\t * But since under the hood it ends up calling .where(predicate) anyway,\r\n\t * it may be better to remove this to allow for a cleaner signature/override.\r\n\t * JavaScript/TypeScript does not easily allow for a strict method interface like C#.\r\n\t * Having to write extra override logic is error prone and confusing to the consumer.\r\n\t * Removing the predicate here may also cause the consumer of this method to think more about how they structure their query.\r\n\t * The end all difference is that the user must declare .where(predicate) before .first(), .single(), or .last().\r\n\t * */\r\n\r\n\tfirst():T\r\n\t{\r\n\t\tvar v = this.firstOrDefault(INVALID_DEFAULT);\r\n\t\tif(v===INVALID_DEFAULT) throw new Error(\"first:The sequence is empty.\");\r\n\t\treturn v;\r\n\t}\r\n\r\n\tfirstOrDefault(defaultValue:T = null):T\r\n\t{\r\n\t\tvar _ = this;\r\n\t\t_.throwIfDisposed();\r\n\r\n\t\treturn using(\r\n\t\t\tthis.getEnumerator(),\r\n\t\t\te=> e.moveNext() ? e.current : defaultValue\r\n\t\t);\r\n\t}\r\n\r\n\r\n\tsingle():T\r\n\t{\r\n\t\tvar _ = this;\r\n\t\t_.throwIfDisposed();\r\n\r\n\t\treturn using(\r\n\t\t\tthis.getEnumerator(),\r\n\t\t\te=>\r\n\t\t\t{\r\n\t\t\t\tif(e.moveNext())\r\n\t\t\t\t{\r\n\t\t\t\t\tvar value = e.current;\r\n\t\t\t\t\tif(!e.moveNext()) return value;\r\n\t\t\t\t\tthrow new Error(\"single:sequence contains more than one element.\");\r\n\t\t\t\t}\r\n\t\t\t\tthrow new Error(\"single:The sequence is empty.\");\r\n\t\t\t}\r\n\t\t);\r\n\t}\r\n\r\n\tsingleOrDefault(defaultValue:T = null):T\r\n\t{\r\n\r\n\t\tvar _ = this;\r\n\t\t_.throwIfDisposed();\r\n\r\n\t\treturn using(\r\n\t\t\tthis.getEnumerator(),\r\n\t\t\te=>\r\n\t\t\t{\r\n\t\t\t\tif(e.moveNext())\r\n\t\t\t\t{\r\n\t\t\t\t\tvar value = e.current;\r\n\t\t\t\t\tif(!e.moveNext()) return value;\r\n\t\t\t\t}\r\n\t\t\t\treturn defaultValue;\r\n\t\t\t}\r\n\t\t);\r\n\t}\r\n\r\n\tany():boolean\r\n\t{\r\n\t\tvar _ = this;\r\n\t\t_.throwIfDisposed();\r\n\r\n\t\treturn using(\r\n\t\t\tthis.getEnumerator(),\r\n\t\t\te=> e.moveNext()\r\n\t\t);\r\n\t}\r\n\r\n\tisEmpty():boolean\r\n\t{\r\n\t\treturn !this.any();\r\n\t}\r\n\r\n\t// #endregion\r\n\r\n\r\n\t// #region Projection and Filtering Methods\r\n\r\n\ttraverseBreadthFirst(\r\n\t\tchildrenSelector:(element:T) => IEnumerableOrArray<T>):Enumerable<T>;\r\n\r\n\ttraverseBreadthFirst<TNode>(\r\n\t\tchildrenSelector:(element:T|TNode) => IEnumerableOrArray<TNode>):Enumerable<TNode>;\r\n\r\n\ttraverseBreadthFirst<TResult>(\r\n\t\tchildrenSelector:(element:T) => IEnumerableOrArray<T>,\r\n\t\tresultSelector?:(element:T, nestLevel?:number) => TResult):Enumerable<TResult>;\r\n\r\n\ttraverseBreadthFirst<TNode, TResult>(\r\n\t\tchildrenSelector:(element:T|TNode) => IEnumerableOrArray<TNode>,\r\n\t\tresultSelector?:(element:TNode, nestLevel?:number) => TResult):Enumerable<TResult>;\r\n\r\n\ttraverseBreadthFirst<TNode>(\r\n\t\tchildrenSelector:(element:T|TNode) => IEnumerableOrArray<TNode>,\r\n\t\tresultSelector:(\r\n\t\t\telement:TNode,\r\n\t\t\tnestLevel?:number) => any = Functions.Identity):Enumerable<any>\r\n\t{\r\n\t\tvar _ = this, isEndless = _._isEndless || null; // Is endless is not affirmative if false.\r\n\r\n\r\n\t\treturn new Enumerable<any>(\r\n\t\t\t() =>\r\n\t\t\t{\r\n\t\t\t\tvar enumerator:IEnumerator<any>;\r\n\t\t\t\tvar nestLevel:number = 0;\r\n\t\t\t\tvar buffer:any[], len:number;\r\n\r\n\t\t\t\treturn new EnumeratorBase<any>(\r\n\t\t\t\t\t() =>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tnestLevel = 0;\r\n\t\t\t\t\t\tbuffer = [];\r\n\t\t\t\t\t\tlen = 0;\r\n\t\t\t\t\t\tenumerator = _.getEnumerator();\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\t(yielder)=>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\twhile(true)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tif(enumerator.moveNext())\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tbuffer[len++] = enumerator.current;\r\n\t\t\t\t\t\t\t\treturn yielder.yieldReturn(resultSelector(enumerator.current, nestLevel));\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tif(!len)\r\n\t\t\t\t\t\t\t\treturn yielder.yieldBreak();\r\n\r\n\t\t\t\t\t\t\tvar next = Enumerable\r\n\t\t\t\t\t\t\t\t.from(buffer)\r\n\t\t\t\t\t\t\t\t.selectMany(childrenSelector);\r\n\r\n\t\t\t\t\t\t\tif(!next.any())\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\treturn yielder.yieldBreak();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tnestLevel++;\r\n\t\t\t\t\t\t\t\tbuffer = [];\r\n\t\t\t\t\t\t\t\tlen = 0;\r\n\t\t\t\t\t\t\t\tenumerator.dispose();\r\n\t\t\t\t\t\t\t\tenumerator = next.getEnumerator();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\t() =>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tdispose(enumerator);\r\n\t\t\t\t\t\tbuffer.length = 0;\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\tisEndless\r\n\t\t\t\t);\r\n\t\t\t},\r\n\t\t\tnull,\r\n\r\n\t\t\tisEndless\r\n\t\t);\r\n\t}\r\n\r\n\r\n\ttraverseDepthFirst(\r\n\t\tchildrenSelector:(element:T) => IEnumerableOrArray<T>):Enumerable<T>;\r\n\r\n\ttraverseDepthFirst<TNode>(\r\n\t\tchildrenSelector:(element:T|TNode) => IEnumerableOrArray<TNode>):Enumerable<TNode>;\r\n\r\n\ttraverseDepthFirst<TResult>(\r\n\t\tchildrenSelector:(element:T) => IEnumerableOrArray<T>,\r\n\t\tresultSelector?:(element:T, nestLevel?:number) => TResult):Enumerable<TResult>;\r\n\r\n\ttraverseDepthFirst<TNode, TResult>(\r\n\t\tchildrenSelector:(element:T|TNode) => IEnumerableOrArray<TNode>,\r\n\t\tresultSelector?:(element:TNode, nestLevel?:number) => TResult):Enumerable<TResult>;\r\n\r\n\ttraverseDepthFirst<TNode>(\r\n\t\tchildrenSelector:(element:T|TNode) => IEnumerableOrArray<TNode>,\r\n\t\tresultSelector:(\r\n\t\t\telement:TNode,\r\n\t\t\tnestLevel?:number) => any = Functions.Identity):Enumerable<any>\r\n\t{\r\n\t\tvar _ = this, isEndless = _._isEndless || null; // Is endless is not affirmative if false.\r\n\r\n\t\treturn new Enumerable<any>(\r\n\t\t\t() =>\r\n\t\t\t{\r\n\t\t\t\t// Dev Note: May want to consider using an actual stack and not an array.\r\n\t\t\t\tvar enumeratorStack:IEnumerator<any>[] = [];\r\n\t\t\t\tvar enumerator:IEnumerator<any>;\r\n\t\t\t\tvar len:number;  // Avoid using push/pop since they query .length every time and can be slower.\r\n\r\n\t\t\t\treturn new EnumeratorBase<T>(\r\n\t\t\t\t\t() =>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tenumerator = _.getEnumerator();\r\n\t\t\t\t\t\tlen = 0;\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\t(yielder)=>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\twhile(true)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tif(enumerator.moveNext())\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tlet value = resultSelector(enumerator.current, len);\r\n\t\t\t\t\t\t\t\tenumeratorStack[len++] = enumerator;\r\n\t\t\t\t\t\t\t\tlet e = Enumerable.fromAny<any>(childrenSelector(enumerator.current));\r\n\t\t\t\t\t\t\t\tenumerator = e ? e.getEnumerator() : EmptyEnumerator;\r\n\t\t\t\t\t\t\t\treturn yielder.yieldReturn(value);\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tif(len==0) return false;\r\n\r\n\t\t\t\t\t\t\tenumerator.dispose();\r\n\t\t\t\t\t\t\tenumerator = enumeratorStack[--len];\r\n\t\t\t\t\t\t\tenumeratorStack.length = len;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\t() =>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\ttry\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tdispose(enumerator);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tfinally\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tdispose.these(enumeratorStack);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\tisEndless\r\n\t\t\t\t);\r\n\t\t\t},\r\n\t\t\tnull,\r\n\t\t\tisEndless\r\n\t\t);\r\n\t}\r\n\r\n\r\n\tflatten():Enumerable<any>\r\n\t{\r\n\t\tvar _ = this, isEndless = _._isEndless || null; // Is endless is not affirmative if false.;\r\n\r\n\t\treturn new Enumerable<any>(\r\n\t\t\t() =>\r\n\t\t\t{\r\n\t\t\t\tvar enumerator:IEnumerator<any>;\r\n\t\t\t\tvar middleEnumerator:IEnumerator<any> = null;\r\n\r\n\t\t\t\treturn new EnumeratorBase<T>(\r\n\t\t\t\t\t() =>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tenumerator = _.getEnumerator();\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\t(yielder)=>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\twhile(true)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tif(middleEnumerator)\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tif(middleEnumerator.moveNext())\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\treturn yielder.yieldReturn(middleEnumerator.current);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\tmiddleEnumerator.dispose();\r\n\t\t\t\t\t\t\t\t\tmiddleEnumerator = null;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tif(enumerator.moveNext())\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tvar c = enumerator.current;\r\n\t\t\t\t\t\t\t\t// Because strings are enumerable, we can get stuck in an infinite loop.\r\n\t\t\t\t\t\t\t\t// Treat strings as primitives here.\r\n\t\t\t\t\t\t\t\tvar e = !Type.isString(c) && Enumerable.fromAny(c);\r\n\t\t\t\t\t\t\t\tif(e)\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\tmiddleEnumerator\r\n\t\t\t\t\t\t\t\t\t\t= e\r\n\t\t\t\t\t\t\t\t\t\t.selectMany(Functions.Identity)\r\n\t\t\t\t\t\t\t\t\t\t.flatten()\r\n\t\t\t\t\t\t\t\t\t\t.getEnumerator();\r\n\t\t\t\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\treturn yielder.yieldReturn(c);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\treturn yielder.yieldBreak();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\t() =>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tdispose(enumerator, middleEnumerator);\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\tisEndless\r\n\t\t\t\t);\r\n\t\t\t},\r\n\t\t\tnull,\r\n\t\t\tisEndless\r\n\t\t);\r\n\t}\r\n\r\n\r\n\tpairwise<TSelect>(selector:(prev:T, current:T) => TSelect):Enumerable<TSelect>\r\n\t{\r\n\t\tvar _ = this;\r\n\r\n\t\treturn new Enumerable<TSelect>(\r\n\t\t\t() =>\r\n\t\t\t{\r\n\t\t\t\tvar enumerator:IEnumerator<T>;\r\n\r\n\t\t\t\treturn new EnumeratorBase<TSelect>(\r\n\t\t\t\t\t() =>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tenumerator = _.getEnumerator();\r\n\t\t\t\t\t\tenumerator.moveNext();\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\t(yielder)=>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar prev = enumerator.current;\r\n\t\t\t\t\t\treturn enumerator.moveNext()\r\n\t\t\t\t\t\t\t&& yielder.yieldReturn(selector(prev, enumerator.current));\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\t() =>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tdispose(enumerator);\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\t_._isEndless\r\n\t\t\t\t);\r\n\t\t\t},\r\n\t\t\tnull,\r\n\r\n\t\t\t_._isEndless\r\n\t\t);\r\n\t}\r\n\r\n\tscan(func:(a:T, b:T) => T, seed?:T):Enumerable<T>\r\n\t{\r\n\r\n\t\tvar isUseSeed = seed!==VOID0; // For now...\r\n\t\tvar _ = this;\r\n\r\n\t\treturn new Enumerable<T>(\r\n\t\t\t() =>\r\n\t\t\t{\r\n\t\t\t\tvar enumerator:IEnumerator<T>;\r\n\t\t\t\tvar value:T;\r\n\t\t\t\tvar isFirst:boolean;\r\n\r\n\t\t\t\treturn new EnumeratorBase<T>(\r\n\t\t\t\t\t() =>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tenumerator = _.getEnumerator();\r\n\t\t\t\t\t\tisFirst = true;\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\t(yielder)=>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tif(isFirst)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tisFirst = false;\r\n\t\t\t\t\t\t\t//noinspection JSUnusedAssignment\r\n\t\t\t\t\t\t\treturn isUseSeed\r\n\t\t\t\t\t\t\t\t? yielder.yieldReturn(value = seed)\r\n\t\t\t\t\t\t\t\t: enumerator.moveNext() && yielder.yieldReturn(value\r\n\t\t\t\t\t\t\t\t= enumerator.current);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\treturn (enumerator.moveNext())\r\n\t\t\t\t\t\t\t? yielder.yieldReturn(value = func(value, enumerator.current))\r\n\t\t\t\t\t\t\t: false;\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\t() =>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tdispose(enumerator);\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\t_._isEndless\r\n\t\t\t\t);\r\n\t\t\t},\r\n\t\t\tnull,\r\n\r\n\t\t\t_._isEndless\r\n\t\t);\r\n\t}\r\n\r\n\t// #endregion\r\n\r\n\tselect<TResult>(selector:Selector<T, TResult>):InfiniteEnumerable<TResult>\r\n\t{\r\n\t\tvar _ = this, disposed = !_.throwIfDisposed();\r\n\r\n\t\treturn new Enumerable<TResult>(\r\n\t\t\t() =>\r\n\t\t\t{\r\n\t\t\t\tvar enumerator:IEnumerator<T>;\r\n\t\t\t\tvar index:number = 0;\r\n\r\n\t\t\t\treturn new EnumeratorBase<TResult>(\r\n\t\t\t\t\t() =>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthrowIfDisposed(disposed);\r\n\r\n\t\t\t\t\t\tindex = 0;\r\n\t\t\t\t\t\tenumerator = _.getEnumerator();\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\t(yielder)=>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthrowIfDisposed(disposed);\r\n\r\n\t\t\t\t\t\treturn enumerator.moveNext()\r\n\t\t\t\t\t\t\t? yielder.yieldReturn(selector(enumerator.current, index++))\r\n\t\t\t\t\t\t\t: yielder.yieldBreak();\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\t() =>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tdispose(enumerator);\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\t_._isEndless\r\n\t\t\t\t);\r\n\t\t\t},\r\n\r\n\t\t\t() =>\r\n\t\t\t{\r\n\t\t\t\tdisposed = true;\r\n\t\t\t},\r\n\r\n\t\t\t_._isEndless\r\n\t\t);\r\n\t}\r\n\r\n\t/*\r\n\tpublic static IEnumerable<TResult> SelectMany<TSource, TCollection, TResult>(\r\n\t\tthis IEnumerable<TSource> source,\r\n\t\tFunc<TSource, IEnumerable<TCollection>> collectionSelector,\r\n\t\tFunc<TSource, TCollection, TResult> resultSelector)\r\n\t */\r\n\r\n\tprotected _selectMany<TElement, TResult>(\r\n\t\tcollectionSelector:Selector<T, IEnumerableOrArray<TElement>>,\r\n\t\tresultSelector?:(collection:T, element:TElement) => TResult):Enumerable<TResult>\r\n\t{\r\n\t\tvar _ = this, isEndless = _._isEndless || null; // Do second enumeration, it will be indeterminate if false.\r\n\t\tif(!resultSelector)\r\n\t\t\tresultSelector = (a:T, b:any) => <TResult>b;\r\n\r\n\t\treturn new Enumerable<TResult>(\r\n\t\t\t() =>\r\n\t\t\t{\r\n\t\t\t\tvar enumerator:IEnumerator<T>;\r\n\t\t\t\tvar middleEnumerator:IEnumerator<any>;\r\n\t\t\t\tvar index:number = 0;\r\n\r\n\t\t\t\treturn new EnumeratorBase<TResult>(\r\n\t\t\t\t\t() =>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tenumerator = _.getEnumerator();\r\n\t\t\t\t\t\tmiddleEnumerator = undefined;\r\n\t\t\t\t\t\tindex = 0;\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\t(yielder)=>\r\n\t\t\t\t\t{\r\n\r\n\t\t\t\t\t\t// Just started, and nothing to enumerate? End.\r\n\t\t\t\t\t\tif(middleEnumerator===VOID0 && !enumerator.moveNext())\r\n\t\t\t\t\t\t\treturn false;\r\n\r\n\t\t\t\t\t\t// moveNext has been called at least once...\r\n\t\t\t\t\t\tdo\r\n\t\t\t\t\t\t{\r\n\r\n\t\t\t\t\t\t\t// Initialize middle if there isn't one.\r\n\t\t\t\t\t\t\tif(!middleEnumerator)\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tvar middleSeq = collectionSelector(enumerator.current, index++);\r\n\r\n\t\t\t\t\t\t\t\t// Collection is null?  Skip it...\r\n\t\t\t\t\t\t\t\tif(!middleSeq)\r\n\t\t\t\t\t\t\t\t\tcontinue;\r\n\r\n\t\t\t\t\t\t\t\tmiddleEnumerator = enumeratorFrom(middleSeq);\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tif(middleEnumerator.moveNext())\r\n\t\t\t\t\t\t\t\treturn yielder.yieldReturn(\r\n\t\t\t\t\t\t\t\t\tresultSelector(\r\n\t\t\t\t\t\t\t\t\t\tenumerator.current, middleEnumerator.current\r\n\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\t\t// else no more in this middle?  Then clear and reset for next...\r\n\r\n\t\t\t\t\t\t\tmiddleEnumerator.dispose();\r\n\t\t\t\t\t\t\tmiddleEnumerator = null;\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\twhile(enumerator.moveNext());\r\n\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\t() =>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tdispose(enumerator, middleEnumerator);\r\n\t\t\t\t\t\tenumerator = null;\r\n\t\t\t\t\t\tmiddleEnumerator = null;\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\tisEndless\r\n\t\t\t\t);\r\n\t\t\t},\r\n\t\t\tnull,\r\n\r\n\t\t\tisEndless\r\n\t\t);\r\n\t}\r\n\r\n\tselectMany<TResult>(\r\n\t\tcollectionSelector:Selector<T, IEnumerableOrArray<TResult>>):InfiniteEnumerable<TResult>;\r\n\r\n\tselectMany<TElement, TResult>(\r\n\t\tcollectionSelector:Selector<T, IEnumerableOrArray<TElement>>,\r\n\t\tresultSelector:(collection:T, element:TElement) => TResult):InfiniteEnumerable<TResult>;\r\n\r\n\tselectMany<TResult>(\r\n\t\tcollectionSelector:Selector<T, IEnumerableOrArray<any>>,\r\n\t\tresultSelector?:(collection:T, element:any) => TResult):InfiniteEnumerable<TResult>\r\n\t{\r\n\t\treturn this._selectMany(collectionSelector, resultSelector);\r\n\t}\r\n\r\n\tprotected _choose<TResult>(selector:Selector<T, TResult>):Enumerable<TResult>\r\n\t{\r\n\r\n\t\tvar _ = this, disposed = !_.throwIfDisposed();\r\n\r\n\t\treturn new Enumerable<TResult>(\r\n\t\t\t() =>\r\n\t\t\t{\r\n\t\t\t\tvar enumerator:IEnumerator<T>;\r\n\t\t\t\tvar index:number = 0;\r\n\r\n\t\t\t\treturn new EnumeratorBase<TResult>(\r\n\t\t\t\t\t() =>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthrowIfDisposed(disposed);\r\n\r\n\t\t\t\t\t\tindex = 0;\r\n\t\t\t\t\t\tenumerator = _.getEnumerator();\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\t(yielder)=>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthrowIfDisposed(disposed);\r\n\r\n\t\t\t\t\t\twhile(enumerator.moveNext())\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tvar result = selector(enumerator.current, index++);\r\n\t\t\t\t\t\t\tif(result!==null && result!==VOID0)\r\n\t\t\t\t\t\t\t\treturn yielder.yieldReturn(result);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\t() =>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tdispose(enumerator);\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\t_._isEndless\r\n\t\t\t\t);\r\n\t\t\t},\r\n\r\n\t\t\t() =>\r\n\t\t\t{\r\n\t\t\t\tdisposed = true;\r\n\t\t\t},\r\n\r\n\t\t\t_._isEndless\r\n\t\t);\r\n\t}\r\n\r\n\t/**\r\n\t * Returns selected values that are not null or undefined.\r\n\t */\r\n\tchoose():InfiniteEnumerable<T>;\r\n\tchoose<TResult>(selector?:Selector<T, TResult>):InfiniteEnumerable<TResult>\r\n\tchoose(selector:Selector<T, any> = Functions.Identity):InfiniteEnumerable<any>\r\n\t{\r\n\t\treturn this._choose(selector)\r\n\t}\r\n\r\n\twhere(predicate:Predicate<T>):InfiniteEnumerable<T>\r\n\t{\r\n\r\n\t\tvar _ = this, disposed = !_.throwIfDisposed();\r\n\r\n\t\treturn new Enumerable<T>(\r\n\t\t\t() =>\r\n\t\t\t{\r\n\t\t\t\tvar enumerator:IEnumerator<T>;\r\n\t\t\t\tvar index:number = 0;\r\n\r\n\t\t\t\treturn new EnumeratorBase<T>(\r\n\t\t\t\t\t() =>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthrowIfDisposed(disposed);\r\n\r\n\t\t\t\t\t\tindex = 0;\r\n\t\t\t\t\t\tenumerator = _.getEnumerator();\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\t(yielder)=>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthrowIfDisposed(disposed);\r\n\r\n\t\t\t\t\t\twhile(enumerator.moveNext())\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tif(predicate(enumerator.current, index++))\r\n\t\t\t\t\t\t\t\treturn yielder.yieldReturn(enumerator.current);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\t() =>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tdispose(enumerator);\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\t_._isEndless\r\n\t\t\t\t);\r\n\t\t\t},\r\n\r\n\t\t\t() =>\r\n\t\t\t{\r\n\t\t\t\tdisposed = true;\r\n\t\t\t},\r\n\r\n\t\t\t_._isEndless\r\n\t\t);\r\n\r\n\t}\r\n\r\n\tofType<TType>(type:{ new (...params:any[]):TType }):InfiniteEnumerable<TType>;\r\n\tofType<TType>(type:any):InfiniteEnumerable<TType>\r\n\t{\r\n\t\tvar typeName:string;\r\n\t\tswitch(<any>type)\r\n\t\t{\r\n\t\t\tcase Number:\r\n\t\t\t\ttypeName = Type.NUMBER;\r\n\t\t\t\tbreak;\r\n\t\t\tcase String:\r\n\t\t\t\ttypeName = Type.STRING;\r\n\t\t\t\tbreak;\r\n\t\t\tcase Boolean:\r\n\t\t\t\ttypeName = Type.BOOLEAN;\r\n\t\t\t\tbreak;\r\n\t\t\tcase Function:\r\n\t\t\t\ttypeName = Type.FUNCTION;\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\treturn <Enumerable<any>>this\r\n\t\t\t\t\t.where(x=>x instanceof type);\r\n\t\t}\r\n\t\treturn <Enumerable<any>>this\r\n\t\t\t.choose()\r\n\t\t\t.where(x=>(typeof x)===typeName);\r\n\t}\r\n\r\n\texcept<TCompare>(\r\n\t\tsecond:IEnumerableOrArray<T>,\r\n\t\tcompareSelector?:Selector<T, TCompare>):InfiniteEnumerable<T>\r\n\t{\r\n\t\tvar _ = this, disposed = !_.throwIfDisposed();\r\n\r\n\t\treturn new Enumerable<T>(\r\n\t\t\t() =>\r\n\t\t\t{\r\n\t\t\t\tvar enumerator:IEnumerator<T>;\r\n\t\t\t\tvar keys:Dictionary<T, boolean>;\r\n\r\n\t\t\t\treturn new EnumeratorBase<T>(\r\n\t\t\t\t\t() =>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthrowIfDisposed(disposed);\r\n\t\t\t\t\t\tenumerator = _.getEnumerator();\r\n\t\t\t\t\t\tkeys = new Dictionary<T, boolean>(compareSelector);\r\n\t\t\t\t\t\tif(second)\r\n\t\t\t\t\t\t\tforEach(second, key => { keys.addByKeyValue(key, true) });\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\t(yielder)=>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthrowIfDisposed(disposed);\r\n\t\t\t\t\t\twhile(enumerator.moveNext())\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tvar current = enumerator.current;\r\n\t\t\t\t\t\t\tif(!keys.containsKey(current))\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tkeys.addByKeyValue(current, true);\r\n\t\t\t\t\t\t\t\treturn yielder.yieldReturn(current);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\t() =>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tdispose(enumerator);\r\n\t\t\t\t\t\tkeys.clear();\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\t_._isEndless\r\n\t\t\t\t);\r\n\t\t\t},\r\n\r\n\t\t\t() =>\r\n\t\t\t{\r\n\t\t\t\tdisposed = true;\r\n\t\t\t},\r\n\r\n\t\t\t_._isEndless\r\n\t\t);\r\n\t}\r\n\r\n\tdistinct(compareSelector?:(value:T) => T):InfiniteEnumerable<T>\r\n\t{\r\n\t\treturn this.except(null, compareSelector);\r\n\t}\r\n\r\n\t// [0,0,0,1,1,1,2,2,2,0,0,0,1,1] results in [0,1,2,0,1];\r\n\tdistinctUntilChanged<TCompare>(compareSelector:Selector<T, TCompare> = Functions.Identity):InfiniteEnumerable<T>\r\n\t{\r\n\r\n\t\tvar _ = this, disposed = !_.throwIfDisposed();\r\n\r\n\t\treturn new Enumerable<T>(\r\n\t\t\t() =>\r\n\t\t\t{\r\n\t\t\t\tvar enumerator:IEnumerator<T>;\r\n\t\t\t\tvar compareKey:TCompare;\r\n\t\t\t\tvar initial:boolean = true;\r\n\r\n\t\t\t\treturn new EnumeratorBase<T>(\r\n\t\t\t\t\t() =>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthrowIfDisposed(disposed);\r\n\t\t\t\t\t\tenumerator = _.getEnumerator();\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\t(yielder)=>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthrowIfDisposed(disposed);\r\n\t\t\t\t\t\twhile(enumerator.moveNext())\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tvar key = compareSelector(enumerator.current);\r\n\r\n\t\t\t\t\t\t\tif(initial)\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tinitial = false;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse if(Values.areEqual(compareKey, key))\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tcompareKey = key;\r\n\t\t\t\t\t\t\treturn yielder.yieldReturn(enumerator.current);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\t() =>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tdispose(enumerator);\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\t_._isEndless\r\n\t\t\t\t);\r\n\t\t\t},\r\n\r\n\t\t\t() =>\r\n\t\t\t{\r\n\t\t\t\tdisposed = true;\r\n\t\t\t},\r\n\r\n\t\t\t_._isEndless\r\n\t\t);\r\n\t}\r\n\r\n\r\n\t/**\r\n\t * Returns a single default value if empty.\r\n\t * @param defaultValue\r\n\t * @returns {Enumerable}\r\n\t */\r\n\tdefaultIfEmpty(defaultValue:T = null):Enumerable<T>\r\n\t{\r\n\t\tvar _ = this, disposed:boolean = !_.throwIfDisposed();\r\n\r\n\t\treturn new Enumerable<T>(\r\n\t\t\t() =>\r\n\t\t\t{\r\n\t\t\t\tvar enumerator:IEnumerator<T>;\r\n\t\t\t\tvar isFirst:boolean;\r\n\r\n\t\t\t\treturn new EnumeratorBase<T>(\r\n\t\t\t\t\t() =>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tisFirst = true;\r\n\t\t\t\t\t\tthrowIfDisposed(disposed);\r\n\t\t\t\t\t\tenumerator = _.getEnumerator();\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\t(yielder)=>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthrowIfDisposed(disposed);\r\n\r\n\t\t\t\t\t\tif(enumerator.moveNext())\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tisFirst = false;\r\n\t\t\t\t\t\t\treturn yielder.yieldReturn(enumerator.current);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if(isFirst)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tisFirst = false;\r\n\t\t\t\t\t\t\treturn yielder.yieldReturn(defaultValue);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\t() =>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tdispose(enumerator);\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\t_._isEndless\r\n\t\t\t\t);\r\n\t\t\t},\r\n\t\t\tnull,\r\n\r\n\t\t\t_._isEndless\r\n\t\t);\r\n\t}\r\n\r\n\tzip<TSecond, TResult>(\r\n\t\tsecond:IEnumerableOrArray<TSecond>,\r\n\t\tresultSelector:(first:T, second:TSecond, index?:number) => TResult):Enumerable<TResult>\r\n\t{\r\n\t\tvar _ = this;\r\n\t\t_.throwIfDisposed();\r\n\r\n\r\n\t\treturn new Enumerable<TResult>(\r\n\t\t\t() =>\r\n\t\t\t{\r\n\t\t\t\tvar firstEnumerator:IEnumerator<T>;\r\n\t\t\t\tvar secondEnumerator:IEnumerator<TSecond>;\r\n\t\t\t\tvar index:number = 0;\r\n\r\n\t\t\t\treturn new EnumeratorBase<TResult>(\r\n\t\t\t\t\t() =>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tindex = 0;\r\n\t\t\t\t\t\tfirstEnumerator = _.getEnumerator();\r\n\t\t\t\t\t\tsecondEnumerator = enumeratorFrom<TSecond>(second);\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\t(yielder)=> firstEnumerator.moveNext()\r\n\t\t\t\t\t&& secondEnumerator.moveNext()\r\n\t\t\t\t\t&& yielder.yieldReturn(resultSelector(firstEnumerator.current, secondEnumerator.current, index++)),\r\n\r\n\t\t\t\t\t() =>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tdispose(firstEnumerator, secondEnumerator);\r\n\t\t\t\t\t}\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t);\r\n\t}\r\n\r\n\r\n\tzipMultiple<TSecond, TResult>(\r\n\t\tsecond:IArray<IEnumerableOrArray<TSecond>>,\r\n\t\tresultSelector:(first:T, second:TSecond, index?:number) => TResult):Enumerable<TResult>\r\n\t{\r\n\t\tvar _ = this;\r\n\t\t_.throwIfDisposed();\r\n\r\n\t\tif(!second.length)\r\n\t\t\treturn Enumerable.empty<TResult>();\r\n\r\n\t\treturn new Enumerable<TResult>(\r\n\t\t\t() =>\r\n\t\t\t{\r\n\t\t\t\tvar secondTemp:Queue<any>;\r\n\t\t\t\tvar firstEnumerator:IEnumerator<T>;\r\n\t\t\t\tvar secondEnumerator:IEnumerator<TSecond>;\r\n\t\t\t\tvar index:number = 0;\r\n\r\n\t\t\t\treturn new EnumeratorBase<TResult>(\r\n\t\t\t\t\t() =>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tsecondTemp = new Queue<any>(second);\r\n\t\t\t\t\t\tindex = 0;\r\n\t\t\t\t\t\tfirstEnumerator = _.getEnumerator();\r\n\t\t\t\t\t\tsecondEnumerator = null;\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\t(yielder)=>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tif(firstEnumerator.moveNext())\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\twhile(true)\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\twhile(!secondEnumerator)\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\tif(secondTemp.count)\r\n\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\tvar next = secondTemp.dequeue();\r\n\t\t\t\t\t\t\t\t\t\tif(next) // In case by chance next is null, then try again.\r\n\t\t\t\t\t\t\t\t\t\t\tsecondEnumerator = enumeratorFrom<TSecond>(next);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\t\t\t\treturn yielder.yieldBreak();\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\tif(secondEnumerator.moveNext())\r\n\t\t\t\t\t\t\t\t\treturn yielder.yieldReturn(\r\n\t\t\t\t\t\t\t\t\t\tresultSelector(firstEnumerator.current, secondEnumerator.current, index++)\r\n\t\t\t\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\t\t\tsecondEnumerator.dispose();\r\n\t\t\t\t\t\t\t\tsecondEnumerator = null;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\treturn yielder.yieldBreak();\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\t() =>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tdispose(firstEnumerator, secondTemp);\r\n\t\t\t\t\t}\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t);\r\n\t}\r\n\r\n\r\n\t// #region Join Methods\r\n\r\n\tjoin<TInner, TKey, TResult, TCompare>(\r\n\t\tinner:IEnumerableOrArray<TInner>,\r\n\t\touterKeySelector:Selector<T, TKey>,\r\n\t\tinnerKeySelector:Selector<TInner, TKey>,\r\n\t\tresultSelector:(outer:T, inner:TInner) => TResult,\r\n\t\tcompareSelector:Selector<TKey, TCompare> = Functions.Identity):Enumerable<TResult>\r\n\t{\r\n\r\n\t\tvar _ = this;\r\n\t\treturn new Enumerable<TResult>(\r\n\t\t\t() =>\r\n\t\t\t{\r\n\t\t\t\tvar outerEnumerator:IEnumerator<T>;\r\n\t\t\t\tvar lookup:ILookup<TKey,TInner>;\r\n\t\t\t\tvar innerElements:TInner[] = null;\r\n\t\t\t\tvar innerCount:number = 0;\r\n\r\n\t\t\t\treturn new EnumeratorBase<TResult>(\r\n\t\t\t\t\t() =>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\touterEnumerator = _.getEnumerator();\r\n\t\t\t\t\t\tlookup = Enumerable.from(inner)\r\n\t\t\t\t\t\t\t.toLookup(innerKeySelector, Functions.Identity, compareSelector);\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\t(yielder)=>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\twhile(true)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tif(innerElements!=null)\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tvar innerElement = innerElements[innerCount++];\r\n\t\t\t\t\t\t\t\tif(innerElement!==VOID0)\r\n\t\t\t\t\t\t\t\t\treturn yielder.yieldReturn(resultSelector(outerEnumerator.current, innerElement));\r\n\r\n\t\t\t\t\t\t\t\tinnerElement = null;\r\n\t\t\t\t\t\t\t\tinnerCount = 0;\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tif(outerEnumerator.moveNext())\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tvar key = outerKeySelector(outerEnumerator.current);\r\n\t\t\t\t\t\t\t\tinnerElements = lookup.get(key);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\treturn yielder.yieldBreak();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\t() =>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tdispose(outerEnumerator);\r\n\t\t\t\t\t}\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t);\r\n\t}\r\n\r\n\tgroupJoin<TInner, TKey, TResult, TCompare>(\r\n\t\tinner:IEnumerableOrArray<TInner>,\r\n\t\touterKeySelector:Selector<T, TKey>,\r\n\t\tinnerKeySelector:Selector<TInner, TKey>,\r\n\t\tresultSelector:(outer:T, inner:TInner[]) => TResult,\r\n\t\tcompareSelector:Selector<TKey, TCompare> = Functions.Identity):Enumerable<TResult>\r\n\t{\r\n\t\tvar _ = this;\r\n\r\n\t\treturn new Enumerable<TResult>(\r\n\t\t\t() =>\r\n\t\t\t{\r\n\t\t\t\tvar enumerator:IEnumerator<T>;\r\n\t\t\t\tvar lookup:ILookup<TKey, TInner> = null;\r\n\r\n\t\t\t\treturn new EnumeratorBase<TResult>(\r\n\t\t\t\t\t() =>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tenumerator = _.getEnumerator();\r\n\t\t\t\t\t\tlookup = Enumerable.from(inner)\r\n\t\t\t\t\t\t\t.toLookup(innerKeySelector, Functions.Identity, compareSelector);\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\t(yielder)=>\r\n\t\t\t\t\tenumerator.moveNext()\r\n\t\t\t\t\t&& yielder.yieldReturn(\r\n\t\t\t\t\t\tresultSelector(\r\n\t\t\t\t\t\t\tenumerator.current,\r\n\t\t\t\t\t\t\tlookup.get(outerKeySelector(enumerator.current))\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t),\r\n\r\n\t\t\t\t\t() =>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tdispose(enumerator);\r\n\t\t\t\t\t}\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t);\r\n\t}\r\n\r\n\r\n\tmerge(enumerables:IArray<IEnumerableOrArray<T>>):InfiniteEnumerable<T>\r\n\t{\r\n\t\tvar _ = this, isEndless = _._isEndless || null;\r\n\r\n\t\tif(!enumerables || enumerables.length==0)\r\n\t\t\treturn _;\r\n\r\n\t\treturn new Enumerable<T>(\r\n\t\t\t() =>\r\n\t\t\t{\r\n\t\t\t\tvar enumerator:IEnumerator<T>;\r\n\t\t\t\tvar queue:Queue<IEnumerableOrArray<T>>;\r\n\r\n\t\t\t\treturn new EnumeratorBase<T>(\r\n\t\t\t\t\t() =>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t// 1) First get our values...\r\n\t\t\t\t\t\tenumerator = _.getEnumerator();\r\n\t\t\t\t\t\tqueue = new Queue<IEnumerableOrArray<T>>(enumerables);\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\t(yielder) =>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\twhile(true)\r\n\t\t\t\t\t\t{\r\n\r\n\t\t\t\t\t\t\twhile(!enumerator && queue.count)\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tenumerator = enumeratorFrom<T>(queue.dequeue()); // 4) Keep going and on to step 2.  Else fall through to yieldBreak().\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tif(enumerator && enumerator.moveNext()) // 2) Keep returning until done.\r\n\t\t\t\t\t\t\t\treturn yielder.yieldReturn(enumerator.current);\r\n\r\n\t\t\t\t\t\t\tif(enumerator) // 3) Dispose and reset for next.\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tenumerator.dispose();\r\n\t\t\t\t\t\t\t\tenumerator = null;\r\n\t\t\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\treturn yielder.yieldBreak();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\t() =>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tdispose(enumerator, queue); // Just in case this gets disposed early.\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\tisEndless\r\n\t\t\t\t);\r\n\t\t\t},\r\n\t\t\tnull,\r\n\t\t\tisEndless\r\n\t\t);\r\n\t}\r\n\r\n\tconcat(...enumerables:Array<IEnumerableOrArray<T>>):InfiniteEnumerable<T>\r\n\t{\r\n\t\treturn this.merge(enumerables);\r\n\t}\r\n\r\n\r\n\tunion<TCompare>(\r\n\t\tsecond:IEnumerableOrArray<T>,\r\n\t\tcompareSelector:Selector<T, TCompare> = Functions.Identity):Enumerable<T>\r\n\t{\r\n\t\tvar _ = this, isEndless = _._isEndless || null;\r\n\t\treturn new Enumerable<T>(\r\n\t\t\t() =>\r\n\t\t\t{\r\n\t\t\t\tvar firstEnumerator:IEnumerator<T>;\r\n\t\t\t\tvar secondEnumerator:IEnumerator<T>;\r\n\t\t\t\tvar keys:Dictionary<T, any>;\r\n\r\n\t\t\t\treturn new EnumeratorBase<T>(\r\n\t\t\t\t\t() =>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tfirstEnumerator = _.getEnumerator();\r\n\t\t\t\t\t\tkeys = new Dictionary<T, any>(compareSelector); // Acting as a HashSet.\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\t(yielder)=>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar current:T;\r\n\t\t\t\t\t\tif(secondEnumerator===VOID0)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\twhile(firstEnumerator.moveNext())\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tcurrent = firstEnumerator.current;\r\n\t\t\t\t\t\t\t\tif(!keys.containsKey(current))\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\tkeys.addByKeyValue(current, null);\r\n\t\t\t\t\t\t\t\t\treturn yielder.yieldReturn(current);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tsecondEnumerator = enumeratorFrom(second);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\twhile(secondEnumerator.moveNext())\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tcurrent = secondEnumerator.current;\r\n\t\t\t\t\t\t\tif(!keys.containsKey(current))\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tkeys.addByKeyValue(current, null);\r\n\t\t\t\t\t\t\t\treturn yielder.yieldReturn(current);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\t() =>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tdispose(firstEnumerator, secondEnumerator);\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\tisEndless\r\n\t\t\t\t);\r\n\t\t\t},\r\n\t\t\tnull,\r\n\r\n\t\t\tisEndless\r\n\t\t);\r\n\t}\r\n\r\n\tinsertAt(index:number, other:IEnumerableOrArray<T>):Enumerable<T>\r\n\t{\r\n\t\tInteger.assertZeroOrGreater(index, 'index');\r\n\t\tvar n:number = index;\r\n\r\n\t\tvar _ = this, isEndless = _._isEndless || null;\r\n\t\t_.throwIfDisposed();\r\n\r\n\t\treturn new Enumerable<T>(\r\n\t\t\t() =>\r\n\t\t\t{\r\n\r\n\t\t\t\tvar firstEnumerator:IEnumerator<T>;\r\n\t\t\t\tvar secondEnumerator:IEnumerator<T>;\r\n\r\n\t\t\t\tvar count:number = 0;\r\n\t\t\t\tvar isEnumerated:boolean = false;\r\n\r\n\t\t\t\treturn new EnumeratorBase<T>(\r\n\t\t\t\t\t() =>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tcount = 0;\r\n\t\t\t\t\t\tfirstEnumerator = _.getEnumerator();\r\n\t\t\t\t\t\tsecondEnumerator = enumeratorFrom<T>(other);\r\n\t\t\t\t\t\tisEnumerated = false;\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\t(yielder) =>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tif(count==n)\r\n\t\t\t\t\t\t{ // Inserting?\r\n\t\t\t\t\t\t\tisEnumerated = true;\r\n\t\t\t\t\t\t\tif(secondEnumerator.moveNext())\r\n\t\t\t\t\t\t\t\treturn yielder.yieldReturn(secondEnumerator.current);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif(firstEnumerator.moveNext())\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tcount++;\r\n\t\t\t\t\t\t\treturn yielder.yieldReturn(firstEnumerator.current);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\treturn !isEnumerated\r\n\t\t\t\t\t\t\t&& secondEnumerator.moveNext()\r\n\t\t\t\t\t\t\t&& yielder.yieldReturn(secondEnumerator.current);\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\t() =>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tdispose(firstEnumerator, secondEnumerator);\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\tisEndless\r\n\t\t\t\t);\r\n\t\t\t},\r\n\t\t\tnull,\r\n\r\n\t\t\tisEndless\r\n\t\t);\r\n\t}\r\n\r\n\r\n\talternateMultiple(sequence:IEnumerableOrArray<T>):Enumerable<T>\r\n\t{\r\n\t\tvar _ = this;\r\n\r\n\t\treturn new Enumerable<T>(\r\n\t\t\t() =>\r\n\t\t\t{\r\n\t\t\t\tvar buffer:T,\r\n\t\t\t\t    mode:EnumerableAction,\r\n\t\t\t\t    enumerator:IEnumerator<T>,\r\n\t\t\t\t    alternateEnumerator:IEnumerator<T>;\r\n\r\n\t\t\t\treturn new EnumeratorBase<T>(\r\n\t\t\t\t\t() =>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t// Instead of recalling getEnumerator every time, just reset the existing one.\r\n\t\t\t\t\t\talternateEnumerator = new ArrayEnumerator(\r\n\t\t\t\t\t\t\tEnumerable.toArray<T>(sequence)\r\n\t\t\t\t\t\t); // Freeze\r\n\r\n\t\t\t\t\t\tenumerator = _.getEnumerator();\r\n\r\n\t\t\t\t\t\tvar hasAtLeastOne = enumerator.moveNext();\r\n\t\t\t\t\t\tmode = hasAtLeastOne\r\n\t\t\t\t\t\t\t? EnumerableAction.Return\r\n\t\t\t\t\t\t\t: EnumerableAction.Break;\r\n\r\n\t\t\t\t\t\tif(hasAtLeastOne)\r\n\t\t\t\t\t\t\tbuffer = enumerator.current;\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\t(yielder)=>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tswitch(mode)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tcase EnumerableAction.Break: // We're done?\r\n\t\t\t\t\t\t\t\treturn yielder.yieldBreak();\r\n\r\n\t\t\t\t\t\t\tcase EnumerableAction.Skip:\r\n\t\t\t\t\t\t\t\tif(alternateEnumerator.moveNext())\r\n\t\t\t\t\t\t\t\t\treturn yielder.yieldReturn(alternateEnumerator.current);\r\n\t\t\t\t\t\t\t\talternateEnumerator.reset();\r\n\t\t\t\t\t\t\t\tmode = EnumerableAction.Return;\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tvar latest = buffer;\r\n\r\n\t\t\t\t\t\t// Set up the next round...\r\n\r\n\t\t\t\t\t\t// Is there another one?  Set the buffer and setup instruct for the next one to be the alternate.\r\n\t\t\t\t\t\tvar another = enumerator.moveNext();\r\n\t\t\t\t\t\tmode = another\r\n\t\t\t\t\t\t\t? EnumerableAction.Skip\r\n\t\t\t\t\t\t\t: EnumerableAction.Break;\r\n\r\n\t\t\t\t\t\tif(another)\r\n\t\t\t\t\t\t\tbuffer = enumerator.current;\r\n\r\n\t\t\t\t\t\treturn yielder.yieldReturn(latest);\r\n\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\t() =>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tdispose(enumerator, alternateEnumerator);\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\t_._isEndless\r\n\t\t\t\t);\r\n\t\t\t},\r\n\t\t\tnull,\r\n\r\n\t\t\t_._isEndless\r\n\t\t);\r\n\t}\r\n\r\n\talternateSingle(value:T):Enumerable<T>\r\n\t{\r\n\t\treturn this.alternateMultiple(Enumerable.make(value));\r\n\t}\r\n\r\n\talternate(...sequence:T[]):Enumerable<T>\r\n\t{\r\n\t\treturn this.alternateMultiple(sequence);\r\n\t}\r\n\r\n\r\n\t// #region Error Handling\r\n\tcatchError(handler:(e:any) => void):InfiniteEnumerable<T>\r\n\t{\r\n\t\tvar _ = this, disposed = !_.throwIfDisposed();\r\n\t\treturn new Enumerable<T>(\r\n\t\t\t() =>\r\n\t\t\t{\r\n\t\t\t\tvar enumerator:IEnumerator<T>;\r\n\r\n\t\t\t\treturn new EnumeratorBase<T>(\r\n\t\t\t\t\t() =>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\ttry\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tthrowIfDisposed(disposed);\r\n\t\t\t\t\t\t\tenumerator = _.getEnumerator();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tcatch(e)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t// Don't init...\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\t(yielder)=>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\ttry\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tthrowIfDisposed(disposed);\r\n\t\t\t\t\t\t\tif(enumerator.moveNext())\r\n\t\t\t\t\t\t\t\treturn yielder.yieldReturn(enumerator.current);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tcatch(e)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\thandler(e);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\t() =>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tdispose(enumerator);\r\n\t\t\t\t\t}\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t);\r\n\t}\r\n\r\n\tfinallyAction(action:() => void):InfiniteEnumerable<T>\r\n\t{\r\n\t\tvar _ = this, disposed = !_.throwIfDisposed();\r\n\r\n\t\treturn new Enumerable<T>(\r\n\t\t\t() =>\r\n\t\t\t{\r\n\t\t\t\tvar enumerator:IEnumerator<T>;\r\n\r\n\t\t\t\treturn new EnumeratorBase<T>(\r\n\t\t\t\t\t() =>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthrowIfDisposed(disposed);\r\n\t\t\t\t\t\tenumerator = _.getEnumerator();\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\t(yielder)=>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthrowIfDisposed(disposed);\r\n\t\t\t\t\t\treturn (enumerator.moveNext())\r\n\t\t\t\t\t\t\t? yielder.yieldReturn(enumerator.current)\r\n\t\t\t\t\t\t\t: false;\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\t() =>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\ttry\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tdispose(enumerator);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tfinally\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\taction();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t);\r\n\t}\r\n\r\n\r\n\tbuffer(size:number):InfiniteEnumerable<T[]>\r\n\t{\r\n\t\tif(size<1 || !isFinite(size))\r\n\t\t\tthrow new Error(\"Invalid buffer size.\");\r\n\r\n\t\tInteger.assert(size, \"size\");\r\n\r\n\t\tvar _ = this, len:number;\r\n\r\n\t\treturn new Enumerable<T[]>(\r\n\t\t\t() =>\r\n\t\t\t{\r\n\t\t\t\tvar enumerator:IEnumerator<T>;\r\n\t\t\t\treturn new EnumeratorBase<T[]>(\r\n\t\t\t\t\t() =>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tenumerator = _.getEnumerator();\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\t(yielder)=>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar array:T[] = ArrayUtility.initialize<T>(size);\r\n\t\t\t\t\t\tlen = 0;\r\n\t\t\t\t\t\twhile(len<size && enumerator.moveNext())\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tarray[len++] = enumerator.current;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tarray.length = len;\r\n\t\t\t\t\t\treturn len && yielder.yieldReturn(array);\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\t() =>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tdispose(enumerator);\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\t_._isEndless\r\n\t\t\t\t);\r\n\t\t\t},\r\n\t\t\tnull,\r\n\r\n\t\t\t_._isEndless\r\n\t\t);\r\n\t}\r\n\r\n\r\n\tshare():InfiniteEnumerable<T>\r\n\t{\r\n\t\tvar _ = this;\r\n\t\t_.throwIfDisposed();\r\n\r\n\t\tvar sharedEnumerator:IEnumerator<T>;\r\n\t\treturn new Enumerable<T>(\r\n\t\t\t() =>\r\n\t\t\t{\r\n\t\t\t\treturn sharedEnumerator || (sharedEnumerator = _.getEnumerator());\r\n\t\t\t},\r\n\r\n\t\t\t() =>\r\n\t\t\t{\r\n\t\t\t\tdispose(sharedEnumerator);\r\n\t\t\t},\r\n\r\n\t\t\t_._isEndless\r\n\t\t);\r\n\t}\r\n\r\n\r\n}\r\n\r\n\r\n/**\r\n * Enumerable<T> is a wrapper class that allows more primitive enumerables to exhibit LINQ behavior.\r\n *\r\n * In C# Enumerable<T> is not an instance but has extensions for IEnumerable<T>.\r\n * In this case, we use Enumerable<T> as the underlying class that is being chained.\r\n */\r\nexport class Enumerable<T>\r\nextends InfiniteEnumerable<T> implements ILinqEnumerable<T>\r\n{\r\n\r\n\tconstructor(\r\n\t\tenumeratorFactory:() => IEnumerator<T>,\r\n\t\tfinalizer?:() => void,\r\n\t\tisEndless:boolean = null)\r\n\t{\r\n\t\tsuper(enumeratorFactory, finalizer);\r\n\t\tthis._isEndless = isEndless;\r\n\t}\r\n\r\n\t/**\r\n\t * Universal method for converting a primitive enumerables into a LINQ enabled ones.\r\n\t *\r\n\t * Is not limited to TypeScript usages.\r\n\t */\r\n\tstatic from<T>(source:IEnumerableOrArray<T>):Enumerable<T>\r\n\t{\r\n\t\tvar e = Enumerable.fromAny(source);\r\n\t\tif(!e) throw new UnsupportedEnumerableException();\r\n\t\treturn e;\r\n\t}\r\n\r\n\tstatic fromAny(\r\n\t\tsource:any):Enumerable<any>\r\n\r\n\tstatic fromAny<T>(\r\n\t\tsource:IEnumerableOrArray<T>,\r\n\t\tdefaultEnumerable?:Enumerable<T>):Enumerable<T>\r\n\r\n\tstatic fromAny<T>(\r\n\t\tsource:any,\r\n\t\tdefaultEnumerable?:Enumerable<T>):Enumerable<T>\r\n\r\n\tstatic fromAny<T>(\r\n\t\tsource:any,\r\n\t\tdefaultEnumerable:Enumerable<T> = null):Enumerable<T>\r\n\t{\r\n\t\tif(Type.isObject(source) || Type.isString(source))\r\n\t\t{\r\n\t\t\tif(source instanceof Enumerable)\r\n\t\t\t\treturn source;\r\n\r\n\t\t\tif(Type.isArrayLike<T>(source))\r\n\t\t\t\treturn new ArrayEnumerable<T>(source);\r\n\r\n\t\t\tif(isEnumerable<T>(source))\r\n\t\t\t\treturn new Enumerable<T>(\r\n\t\t\t\t\t()=>source.getEnumerator(),\r\n\t\t\t\t\tnull, source.isEndless);\r\n\t\t}\r\n\r\n\t\treturn defaultEnumerable;\r\n\t}\r\n\r\n\tstatic fromOrEmpty<T>(source:IEnumerableOrArray<T>):Enumerable<T>\r\n\t{\r\n\t\treturn Enumerable.fromAny(source) || Enumerable.empty<T>();\r\n\t}\r\n\r\n\t/**\r\n\t * Static helper for converting enumerables to an array.\r\n\t * @param source\r\n\t * @returns {any}\r\n\t */\r\n\tstatic toArray<T>(source:IEnumerableOrArray<T>):T[]\r\n\t{\r\n\t\tif(source instanceof Enumerable)\r\n\t\t\treturn source.toArray();\r\n\r\n\t\treturn toArray(source);\r\n\t}\r\n\r\n\r\n\t//////////////////////////////////////////\r\n\t// #region Static Methods...\r\n\tstatic choice<T>(values:IArray<T>):InfiniteEnumerable<T>\r\n\t{\r\n\t\tvar len = values && values.length;\r\n\t\t// We could return empty if no length, but that would break the typing and produce unexpected results.\r\n\t\t// Enforcing that there must be at least 1 choice is key.\r\n\t\tif(!len || !isFinite(len))\r\n\t\t\tthrow new ArgumentOutOfRangeException('length', length);\r\n\r\n\t\treturn new InfiniteEnumerable<T>(\r\n\t\t\t() => new EnumeratorBase<T>(\r\n\t\t\t\tnull,\r\n\t\t\t\t(yielder)=>\r\n\t\t\t\t\tyielder.yieldReturn(Integer.random.select(values)),\r\n\t\t\t\ttrue // Is endless!\r\n\t\t\t)\r\n\t\t);\r\n\t}\r\n\r\n\tstatic chooseFrom<T>(...args:T[]):InfiniteEnumerable<T>\r\n\t{\r\n\t\treturn Enumerable.choice(args);\r\n\t}\r\n\r\n\tstatic cycle<T>(values:IArray<T>):InfiniteEnumerable<T>\r\n\t{\r\n\t\tvar len = values && values.length;\r\n\t\t// We could return empty if no length, but that would break the typing and produce unexpected results.\r\n\t\t// Enforcing that there must be at least 1 choice is key.\r\n\t\tif(!len || !isFinite(len))\r\n\t\t\tthrow new ArgumentOutOfRangeException('length', length);\r\n\r\n\t\treturn new InfiniteEnumerable<T>(\r\n\t\t\t() =>\r\n\t\t\t{\r\n\t\t\t\tvar index:number = 0;\r\n\t\t\t\treturn new EnumeratorBase<T>(\r\n\t\t\t\t\t() =>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tindex = 0;\r\n\t\t\t\t\t}, // Reinitialize the value just in case the enumerator is restarted.\r\n\t\t\t\t\t(yielder)=>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tif(index>=values.length) index = 0;\r\n\t\t\t\t\t\treturn yielder.yieldReturn(values[index++]);\r\n\t\t\t\t\t},\r\n\t\t\t\t\ttrue // Is endless!\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t);\r\n\t}\r\n\r\n\tstatic cycleThrough<T>(...args:T[]):InfiniteEnumerable<T>\r\n\t{\r\n\t\treturn Enumerable.cycle(args);\r\n\t}\r\n\r\n\tstatic empty<T>():FiniteEnumerable<T>\r\n\t{\r\n\t\t// Could be single static instance, but for safety, we'll make a new one.\r\n\t\treturn new FiniteEnumerable<T>(getEmptyEnumerator);\r\n\t}\r\n\r\n\tstatic repeat<T>(element:T):InfiniteEnumerable<T>;\r\n\tstatic repeat<T>(element:T, count:number):FiniteEnumerable<T>;\r\n\tstatic repeat<T>(element:T, count:number = Infinity):Enumerable<T>\r\n\t{\r\n\t\tif(!(count>0))\r\n\t\t\treturn Enumerable.empty<T>();\r\n\r\n\t\treturn isFinite(count) && Integer.assert(count, \"count\")\r\n\t\t\t? new FiniteEnumerable<T>(\r\n\t\t\t() =>\r\n\t\t\t{\r\n\t\t\t\tvar c:number = count;\r\n\t\t\t\tvar index:number = 0;\r\n\r\n\t\t\t\treturn new EnumeratorBase<T>(\r\n\t\t\t\t\t() => { index = 0; },\r\n\t\t\t\t\t(yielder)=> (index++<c) && yielder.yieldReturn(element),\r\n\t\t\t\t\tnull,\r\n\t\t\t\t\tfalse\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t)\r\n\t\t\t: new Enumerable<T>(\r\n\t\t\t() =>\r\n\t\t\t\tnew EnumeratorBase<T>(\r\n\t\t\t\t\tnull,\r\n\t\t\t\t\t(yielder)=> yielder.yieldReturn(element),\r\n\t\t\t\t\ttrue // Is endless!\r\n\t\t\t\t)\r\n\t\t);\r\n\t}\r\n\r\n\t// Note: this enumeration is endless but can be disposed/cancelled and finalized.\r\n\tstatic repeatWithFinalize<T>(\r\n\t\tinitializer:() => T,\r\n\t\tfinalizer:(element:T) => void):InfiniteEnumerable<T>\r\n\t{\r\n\r\n\t\treturn new InfiniteEnumerable<T>(\r\n\t\t\t() =>\r\n\t\t\t{\r\n\t\t\t\tvar element:T;\r\n\t\t\t\treturn new EnumeratorBase<T>(\r\n\t\t\t\t\t() =>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\telement = initializer();\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\t(yielder)=> yielder.yieldReturn(element),\r\n\r\n\t\t\t\t\t() =>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tfinalizer(element);\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\ttrue // Is endless!\r\n\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t);\r\n\t}\r\n\r\n\t/**\r\n\t * Creates an enumerable of one element.\r\n\t * @param element\r\n\t * @returns {FiniteEnumerable<T>}\r\n\t */\r\n\tstatic make<T>(element:T):FiniteEnumerable<T>\r\n\t{\r\n\t\treturn Enumerable.repeat<T>(element, 1);\r\n\t}\r\n\r\n\t// start and step can be other than integer.\r\n\r\n\tstatic range(\r\n\t\tstart:number,\r\n\t\tcount:number,\r\n\t\tstep:number = 1):FiniteEnumerable<number>\r\n\t{\r\n\t\tif(!isFinite(start))\r\n\t\t\tthrow new ArgumentOutOfRangeException(\"start\", start, \"Must be a finite number.\");\r\n\r\n\t\tif(!(count>0))\r\n\t\t\treturn Enumerable.empty<number>();\r\n\r\n\t\tif(!step)\r\n\t\t\tthrow new ArgumentOutOfRangeException(\"step\", step, \"Must be a valid value\");\r\n\r\n\t\tif(!isFinite(step))\r\n\t\t\tthrow new ArgumentOutOfRangeException(\"step\", step, \"Must be a finite number.\");\r\n\r\n\t\tInteger.assert(count, \"count\");\r\n\r\n\t\treturn new FiniteEnumerable<number>(\r\n\t\t\t() =>\r\n\t\t\t{\r\n\t\t\t\tvar value:number;\r\n\t\t\t\tvar c:number = count; // Force integer evaluation.\r\n\t\t\t\tvar index:number = 0;\r\n\r\n\t\t\t\treturn new EnumeratorBase<number>(\r\n\t\t\t\t\t() =>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tindex = 0;\r\n\t\t\t\t\t\tvalue = start;\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\t(yielder)=>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar result:boolean =\r\n\t\t\t\t\t\t\t    index++<c\r\n\t\t\t\t\t\t\t    && yielder.yieldReturn(value);\r\n\r\n\t\t\t\t\t\tif(result && index<count)\r\n\t\t\t\t\t\t\tvalue += step;\r\n\r\n\t\t\t\t\t\treturn result;\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\tfalse\r\n\t\t\t\t);\r\n\t\t\t});\r\n\t}\r\n\r\n\tstatic rangeDown(\r\n\t\tstart:number,\r\n\t\tcount:number,\r\n\t\tstep:number = 1):FiniteEnumerable<number>\r\n\t{\r\n\t\tstep = Math.abs(step)* -1;\r\n\r\n\t\treturn Enumerable.range(start, count, step);\r\n\t}\r\n\r\n\t// step = -1 behaves the same as toNegativeInfinity;\r\n\tstatic toInfinity(\r\n\t\tstart:number = 0,\r\n\t\tstep:number = 1):InfiniteEnumerable<number>\r\n\t{\r\n\t\tif(!isFinite(start))\r\n\t\t\tthrow new ArgumentOutOfRangeException(\"start\", start, \"Must be a finite number.\");\r\n\r\n\t\tif(!step)\r\n\t\t\tthrow new ArgumentOutOfRangeException(\"step\", step, \"Must be a valid value\");\r\n\r\n\t\tif(!isFinite(step))\r\n\t\t\tthrow new ArgumentOutOfRangeException(\"step\", step, \"Must be a finite number.\");\r\n\r\n\t\treturn new InfiniteEnumerable<number>(\r\n\t\t\t() =>\r\n\t\t\t{\r\n\t\t\t\tvar value:number;\r\n\r\n\t\t\t\treturn new EnumeratorBase<number>(\r\n\t\t\t\t\t() =>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvalue = start;\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\t(yielder)=>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar current:number = value;\r\n\t\t\t\t\t\tvalue += step;\r\n\t\t\t\t\t\treturn yielder.yieldReturn(current);\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\ttrue // Is endless!\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t);\r\n\t}\r\n\r\n\tstatic toNegativeInfinity(\r\n\t\tstart:number = 0,\r\n\t\tstep:number = 1):InfiniteEnumerable<number>\r\n\t{\r\n\t\treturn Enumerable.toInfinity(start, -step);\r\n\t}\r\n\r\n\tstatic rangeTo(\r\n\t\tstart:number,\r\n\t\tto:number,\r\n\t\tstep:number = 1):FiniteEnumerable<number>\r\n\t{\r\n\t\tif(isNaN(to) || !isFinite(to))\r\n\t\t\tthrow new ArgumentOutOfRangeException(\"to\", to, \"Must be a finite number.\");\r\n\r\n\t\tif(step && !isFinite(step))\r\n\t\t\tthrow new ArgumentOutOfRangeException(\"step\", step, \"Must be a finite non-zero number.\");\r\n\r\n\t\t// This way we adjust for the delta from start and to so the user can say +/- step and it will work as expected.\r\n\t\tstep = Math.abs(step);\r\n\r\n\t\treturn new FiniteEnumerable<number>(\r\n\t\t\t() =>\r\n\t\t\t{\r\n\t\t\t\tvar value:number;\r\n\r\n\t\t\t\treturn new EnumeratorBase<number>(() => { value = start; },\r\n\t\t\t\t\tstart<to\r\n\t\t\t\t\t\t?\r\n\t\t\t\t\t\tyielder=>\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tvar result:boolean = value<=to && yielder.yieldReturn(value);\r\n\r\n\t\t\t\t\t\t\tif(result)\r\n\t\t\t\t\t\t\t\tvalue += step;\r\n\r\n\t\t\t\t\t\t\treturn result;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t:\r\n\t\t\t\t\t\tyielder=>\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tvar result:boolean = value>=to && yielder.yieldReturn(value);\r\n\r\n\t\t\t\t\t\t\tif(result)\r\n\t\t\t\t\t\t\t\tvalue -= step;\r\n\r\n\t\t\t\t\t\t\treturn result;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t, false);\r\n\t\t\t}\r\n\t\t);\r\n\t}\r\n\r\n\tstatic matches(input:string, pattern:any, flags:string = \"\"):FiniteEnumerable<RegExpExecArray>\r\n\t{\r\n\t\tif(input===null || input===VOID0)\r\n\t\t\tthrow new ArgumentNullException(\"input\");\r\n\t\tvar type = typeof input;\r\n\t\tif(type!=Type.STRING)\r\n\t\t\tthrow new Error(\"Cannot exec RegExp matches of type '\" + type + \"'.\");\r\n\r\n\t\tif(pattern instanceof RegExp)\r\n\t\t{\r\n\t\t\tflags += (pattern.ignoreCase) ? \"i\" : \"\";\r\n\t\t\tflags += (pattern.multiline) ? \"m\" : \"\";\r\n\t\t\tpattern = pattern.source;\r\n\t\t}\r\n\r\n\t\tif(flags.indexOf(\"g\")=== -1) flags += \"g\";\r\n\r\n\t\treturn new FiniteEnumerable<RegExpExecArray>(\r\n\t\t\t() =>\r\n\t\t\t{\r\n\t\t\t\tvar regex:RegExp;\r\n\t\t\t\treturn new EnumeratorBase<RegExpExecArray>(\r\n\t\t\t\t\t() =>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tregex = new RegExp(pattern, flags);\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\t(yielder)=>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t// Calling regex.exec consecutively on the same input uses the lastIndex to start the next match.\r\n\t\t\t\t\t\tvar match = regex.exec(input);\r\n\t\t\t\t\t\treturn (match!==null) ? yielder.yieldReturn(match) : false;\r\n\t\t\t\t\t}\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t);\r\n\t}\r\n\r\n\tstatic generate<T>(factory:(index?:number) => T):InfiniteEnumerable<T>;\r\n\tstatic generate<T>(factory:(index?:number) => T, count:number):FiniteEnumerable<T>;\r\n\tstatic generate<T>(factory:(index?:number) => T, count:number = Infinity):InfiniteEnumerable<T>\r\n\t{\r\n\r\n\t\tif(isNaN(count) || count<=0)\r\n\t\t\treturn Enumerable.empty<T>();\r\n\r\n\t\treturn isFinite(count) && Integer.assert(count, \"count\")\r\n\t\t\t?\r\n\t\t\tnew FiniteEnumerable<T>(\r\n\t\t\t\t() =>\r\n\t\t\t\t{\r\n\t\t\t\t\tvar c:number = count;\r\n\t\t\t\t\tvar index:number = 0;\r\n\r\n\t\t\t\t\treturn new EnumeratorBase<T>(\r\n\t\t\t\t\t\t() =>\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tindex = 0;\r\n\t\t\t\t\t\t},\r\n\r\n\t\t\t\t\t\t(yielder)=>\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tvar current:number = index++;\r\n\t\t\t\t\t\t\treturn current<c && yielder.yieldReturn(factory(current));\r\n\t\t\t\t\t\t},\r\n\r\n\t\t\t\t\t\tfalse\r\n\t\t\t\t\t);\r\n\t\t\t\t})\r\n\t\t\t:\r\n\t\t\tnew InfiniteEnumerable<T>(\r\n\t\t\t\t() =>\r\n\t\t\t\t{\r\n\t\t\t\t\tvar index:number = 0;\r\n\t\t\t\t\treturn new EnumeratorBase<T>(\r\n\t\t\t\t\t\t() =>\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tindex = 0;\r\n\t\t\t\t\t\t},\r\n\r\n\t\t\t\t\t\t(yielder)=> yielder.yieldReturn(factory(index++)),\r\n\r\n\t\t\t\t\t\ttrue // Is endless!\r\n\t\t\t\t\t);\r\n\t\t\t\t});\r\n\t}\r\n\r\n\tstatic unfold<T>(\r\n\t\tseed:T,\r\n\t\tvalueFactory:Selector<T, T>,\r\n\t\tskipSeed:Boolean = false):InfiniteEnumerable<T>\r\n\t{\r\n\t\treturn new InfiniteEnumerable<T>(\r\n\t\t\t() =>\r\n\t\t\t{\r\n\t\t\t\tvar index:number = 0;\r\n\t\t\t\tvar value:T;\r\n\t\t\t\tvar isFirst:boolean;\r\n\t\t\t\treturn new EnumeratorBase<T>(\r\n\t\t\t\t\t() =>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tindex = 0;\r\n\t\t\t\t\t\tvalue = seed;\r\n\t\t\t\t\t\tisFirst = !skipSeed;\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\t(yielder)=>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar i = index++;\r\n\t\t\t\t\t\tif(isFirst)\r\n\t\t\t\t\t\t\tisFirst = false;\r\n\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\tvalue = valueFactory(value, i);\r\n\t\t\t\t\t\treturn yielder.yieldReturn(value);\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\ttrue // Is endless!\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t);\r\n\t}\r\n\r\n\tstatic forEach<T>(\r\n\t\tenumerable:IEnumerableOrArray<T>,\r\n\t\taction:(element:T, index?:number) => any,\r\n\t\tmax:number = Infinity):number\r\n\t{\r\n\t\t// Will properly dispose created enumerable.\r\n\t\t// Will throw if enumerable is endless.\r\n\t\treturn forEach(enumerable, action, max);\r\n\t}\r\n\r\n\tstatic map<T,TResult>(\r\n\t\tenumerable:IEnumerableOrArray<T>,\r\n\t\tselector:Selector<T,TResult>):TResult[]\r\n\t{\r\n\t\t// Will properly dispose created enumerable.\r\n\t\t// Will throw if enumerable is endless.\r\n\t\treturn map(enumerable, selector);\r\n\r\n\t}\r\n\r\n\t// Slightly optimized versions for numbers.\r\n\tstatic max(values:FiniteEnumerable<number>):number\r\n\t{\r\n\t\treturn values\r\n\t\t\t.takeUntil(v=> v== +Infinity, true)\r\n\t\t\t.aggregate(Functions.Greater);\r\n\t}\r\n\r\n\tstatic min(values:FiniteEnumerable<number>):number\r\n\t{\r\n\t\treturn values\r\n\t\t\t.takeUntil(v=> v== -Infinity, true)\r\n\t\t\t.aggregate(Functions.Lesser);\r\n\t}\r\n\r\n\r\n\t/**\r\n\t * Takes any set of collections of the same type and weaves them together.\r\n\t * @param enumerables\r\n\t * @returns {Enumerable<T>}\r\n\t */\r\n\tstatic weave<T>(\r\n\t\tenumerables:IEnumerableOrArray<IEnumerableOrArray<T>>):Enumerable<T>\r\n\t{\r\n\t\tif(!enumerables)\r\n\t\t\tthrow new ArgumentNullException('enumerables');\r\n\r\n\t\treturn new Enumerable<T>(\r\n\t\t\t() =>\r\n\t\t\t{\r\n\t\t\t\tvar queue:Queue<IEnumerator<T>>;\r\n\t\t\t\tvar mainEnumerator:IEnumerator<IEnumerableOrArray<T>>;\r\n\t\t\t\tvar index:number;\r\n\r\n\t\t\t\treturn new EnumeratorBase<T>(\r\n\t\t\t\t\t() =>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tindex = 0;\r\n\t\t\t\t\t\tqueue = new Queue<IEnumerator<T>>();\r\n\t\t\t\t\t\tmainEnumerator = enumeratorFrom(enumerables);\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\t(yielder)=>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tlet e:IEnumerator<T>;\r\n\r\n\t\t\t\t\t\t// First pass...\r\n\t\t\t\t\t\tif(mainEnumerator)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\twhile(!e && mainEnumerator.moveNext())\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tlet c = mainEnumerator.current;\r\n\t\t\t\t\t\t\t\te = nextEnumerator(queue, c && enumeratorFrom(c));\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tif(!e)\r\n\t\t\t\t\t\t\t\tmainEnumerator = null;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\twhile(!e && queue.count)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\te = nextEnumerator(queue, queue.dequeue());\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\treturn e\r\n\t\t\t\t\t\t\t? yielder.yieldReturn(e.current)\r\n\t\t\t\t\t\t\t: yielder.yieldBreak();\r\n\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\t() =>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tdispose.these(queue.dump());\r\n\t\t\t\t\t\tdispose(mainEnumerator, queue);\r\n\t\t\t\t\t\tmainEnumerator = null;\r\n\t\t\t\t\t\tqueue = null;\r\n\t\t\t\t\t}\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t);\r\n\t}\r\n\r\n\t// #endregion\r\n\r\n\tdoAction(\r\n\t\taction:Action<T>|Predicate<T>|Selector<T, number>|Selector<T, EnumerableAction>,\r\n\t\tinitializer?:()=>void,\r\n\t\tisEndless:boolean = this.isEndless):Enumerable<T>\r\n\t{\r\n\t\treturn <Enumerable<T>>super.doAction(action, initializer, isEndless);\r\n\t}\r\n\r\n// #region Indexing/Paging methods.\r\n\r\n\tskip(count:number):Enumerable<T>\r\n\t{\r\n\t\treturn <Enumerable<T>>super.skip(count);\r\n\t}\r\n\r\n\tskipWhile(predicate:Predicate<T>):Enumerable<T>\r\n\t{\r\n\t\tthis.throwIfDisposed();\r\n\t\treturn this.doAction(\r\n\t\t\t(element:T, index?:number) =>\r\n\t\t\t\tpredicate(element, index)\r\n\t\t\t\t\t? EnumerableAction.Skip\r\n\t\t\t\t\t: EnumerableAction.Return\r\n\t\t);\r\n\t}\r\n\r\n\ttakeWhile(predicate:Predicate<T>):Enumerable<T>\r\n\t{\r\n\t\tthis.throwIfDisposed();\r\n\r\n\t\tif(!predicate)\r\n\t\t\tthrow new ArgumentNullException('predicate');\r\n\r\n\t\treturn this.doAction(\r\n\t\t\t(element:T, index?:number) =>\r\n\t\t\t\tpredicate(element, index)\r\n\t\t\t\t\t? EnumerableAction.Return\r\n\t\t\t\t\t: EnumerableAction.Break,\r\n\t\t\tnull,\r\n\t\t\tnull // We don't know the state if it is endless or not.\r\n\t\t);\r\n\t}\r\n\r\n\t// Is like the inverse of take While with the ability to return the value identified by the predicate.\r\n\ttakeUntil(predicate:Predicate<T>, includeUntilValue?:boolean):Enumerable<T>\r\n\t{\r\n\t\tthis.throwIfDisposed();\r\n\r\n\t\tif(!predicate)\r\n\t\t\tthrow new ArgumentNullException('predicate');\r\n\r\n\t\tif(!includeUntilValue)\r\n\t\t\treturn this.doAction(\r\n\t\t\t\t(element:T, index?:number) =>\r\n\t\t\t\t\tpredicate(element, index)\r\n\t\t\t\t\t\t? EnumerableAction.Break\r\n\t\t\t\t\t\t: EnumerableAction.Return,\r\n\t\t\t\tnull,\r\n\t\t\t\tnull // We don't know the state if it is endless or not.\r\n\t\t\t);\r\n\r\n\t\tvar found:boolean = false;\r\n\t\treturn this.doAction(\r\n\t\t\t(element:T, index?:number) =>\r\n\t\t\t{\r\n\t\t\t\tif(found)\r\n\t\t\t\t\treturn EnumerableAction.Break;\r\n\r\n\t\t\t\tfound = predicate(element, index);\r\n\t\t\t\treturn EnumerableAction.Return;\r\n\t\t\t},\r\n\t\t\t()=>\r\n\t\t\t{\r\n\t\t\t\tfound = false;\r\n\t\t\t},\r\n\t\t\tnull // We don't know the state if it is endless or not.\r\n\t\t);\r\n\t}\r\n\r\n\r\n\tforEach(action:Predicate<T> | Action<T>):void\r\n\t{\r\n\r\n\t\tvar _ = this;\r\n\t\t_.throwIfDisposed();\r\n\t\tthrowIfEndless(_.isEndless);\r\n\r\n\t\tvar index:number = 0;\r\n\t\t// Return value of action can be anything, but if it is (===) false then the forEach will discontinue.\r\n\t\tusing(\r\n\t\t\t_.getEnumerator(), e=>\r\n\t\t\t{\r\n\t\t\t\tthrowIfEndless(e.isEndless);\r\n\r\n\t\t\t\t// It is possible that subsequently 'action' could cause the enumeration to dispose, so we have to check each time.\r\n\t\t\t\twhile(_.throwIfDisposed() && e.moveNext())\r\n\t\t\t\t{\r\n\t\t\t\t\tif(action(e.current, index++)===false)\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t);\r\n\t}\r\n\r\n\t// #region Conversion Methods\r\n\ttoArray(predicate?:Predicate<T>):T[]\r\n\t{\r\n\t\treturn predicate\r\n\t\t\t? this.where(predicate).toArray()\r\n\t\t\t: this.copyTo([]);\r\n\t}\r\n\r\n\tcopyTo(target:T[], index:number = 0, count:number = Infinity):T[]\r\n\t{\r\n\t\tthis.throwIfDisposed();\r\n\t\tif(!target) throw new ArgumentNullException(\"target\");\r\n\t\tInteger.assertZeroOrGreater(index);\r\n\r\n\t\t// If not exposing an action that could cause dispose, then use forEach utility instead.\r\n\t\tforEach<T>(this, (x, i)=>\r\n\t\t{\r\n\t\t\ttarget[i + index] = x\r\n\t\t}, count);\r\n\r\n\t\treturn target;\r\n\t}\r\n\r\n\ttoLookup<TKey, TValue, TCompare>(\r\n\t\tkeySelector:Selector<T, TKey>,\r\n\t\telementSelector:Selector<T, TValue> = Functions.Identity,\r\n\t\tcompareSelector:Selector<TKey, TCompare> = Functions.Identity):ILookup<TKey, TValue>\r\n\t{\r\n\t\tvar dict:Dictionary<TKey, TValue[]> = new Dictionary<TKey, TValue[]>(compareSelector);\r\n\t\tthis.forEach(\r\n\t\t\tx=>\r\n\t\t\t{\r\n\t\t\t\tvar key = keySelector(x);\r\n\t\t\t\tvar element = elementSelector(x);\r\n\r\n\t\t\t\tvar array = dict.getValue(key);\r\n\t\t\t\tif(array!==VOID0) array.push(element);\r\n\t\t\t\telse dict.addByKeyValue(key, [element]);\r\n\t\t\t}\r\n\t\t);\r\n\t\treturn new Lookup<TKey, TValue>(dict);\r\n\t}\r\n\r\n\ttoMap<TResult>(\r\n\t\tkeySelector:Selector<T, string>,\r\n\t\telementSelector:Selector<T, TResult>):IMap<TResult>\r\n\t{\r\n\t\tvar obj:IMap<TResult> = {};\r\n\t\tthis.forEach((x, i)=>\r\n\t\t{\r\n\t\t\tobj[keySelector(x, i)] = elementSelector(x, i);\r\n\t\t});\r\n\t\treturn obj;\r\n\t}\r\n\r\n\ttoDictionary<TKey, TValue, TCompare>(\r\n\t\tkeySelector:Selector<T, TKey>,\r\n\t\telementSelector:Selector<T, TValue>,\r\n\t\tcompareSelector:Selector<TKey, TCompare> = Functions.Identity):IDictionary<TKey, TValue>\r\n\t{\r\n\t\tvar dict:Dictionary<TKey, TValue> = new Dictionary<TKey, TValue>(compareSelector);\r\n\t\tthis.forEach((x, i)=> dict.addByKeyValue(keySelector(x, i), elementSelector(x, i)));\r\n\t\treturn dict;\r\n\t}\r\n\r\n\ttoJoinedString(separator:string = \"\", selector:Selector<T, string> = Functions.Identity)\r\n\t{\r\n\t\treturn this.select(selector).toArray().join(separator);\r\n\t}\r\n\r\n\t// #endregion\r\n\r\n\r\n\ttakeExceptLast(count:number = 1):Enumerable<T>\r\n\t{\r\n\t\tvar _ = this;\r\n\r\n\t\tif(!(count>0)) // Out of bounds?\r\n\t\t\treturn _;\r\n\r\n\t\tif(!isFinite(count)) // +Infinity equals skip all so return empty.\r\n\t\t\treturn Enumerable.empty<T>();\r\n\r\n\t\tInteger.assert(count, \"count\");\r\n\t\tvar c = count;\r\n\r\n\t\treturn new Enumerable<T>(\r\n\t\t\t() =>\r\n\t\t\t{\r\n\t\t\t\tvar enumerator:IEnumerator<T>;\r\n\t\t\t\tvar q:Queue<T>;\r\n\r\n\t\t\t\treturn new EnumeratorBase<T>(\r\n\t\t\t\t\t() =>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tenumerator = _.getEnumerator();\r\n\t\t\t\t\t\tq = new Queue<T>();\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\t(yielder)=>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\twhile(enumerator.moveNext())\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t// Add the next one to the queue.\r\n\t\t\t\t\t\t\tq.enqueue(enumerator.current);\r\n\r\n\t\t\t\t\t\t\t// Did we reach our quota?\r\n\t\t\t\t\t\t\tif(q.count>c)\r\n\t\t\t\t\t\t\t// Okay then, start returning results.\r\n\t\t\t\t\t\t\t\treturn yielder.yieldReturn(q.dequeue());\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\t() =>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tdispose(enumerator, q);\r\n\t\t\t\t\t}\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t);\r\n\t}\r\n\r\n\tskipToLast(count:number):Enumerable<T>\r\n\t{\r\n\t\tif(!(count>0)) // Out of bounds? Empty.\r\n\t\t\treturn Enumerable.empty<T>();\r\n\r\n\t\tvar _ = this;\r\n\r\n\t\tif(!isFinite(count)) // Infinity means return all.\r\n\t\t\treturn _;\r\n\r\n\t\tInteger.assert(count, \"count\");\r\n\r\n\t\t// This sets up the query so nothing is done until move next is called.\r\n\t\treturn _.reverse()\r\n\t\t\t.take(count)\r\n\t\t\t.reverse();\r\n\t}\r\n\r\n\t// To help with type guarding.\r\n\r\n\twhere(predicate:Predicate<T>):Enumerable<T>\r\n\t{\r\n\t\treturn <Enumerable<T>>super.where(predicate);\r\n\t}\r\n\r\n\tselect<TResult>(selector:Selector<T, TResult>):Enumerable<TResult>\r\n\t{\r\n\t\treturn <Enumerable<TResult>>super.select(selector);\r\n\t}\r\n\r\n\tselectMany<TResult>(\r\n\t\tcollectionSelector:Selector<T, IEnumerableOrArray<TResult>>):Enumerable<TResult>;\r\n\r\n\r\n\tselectMany<TElement, TResult>(\r\n\t\tcollectionSelector:Selector<T, IEnumerableOrArray<TElement>>,\r\n\t\tresultSelector:(collection:T, element:TElement)=>TResult):Enumerable<TResult>;\r\n\r\n\tselectMany<TResult>(\r\n\t\tcollectionSelector:Selector<T, IEnumerableOrArray<any>>,\r\n\t\tresultSelector?:(collection:T, element:any)=>TResult):Enumerable<TResult>\r\n\t{\r\n\t\treturn this._selectMany(collectionSelector, resultSelector);\r\n\t}\r\n\r\n\tchoose():Enumerable<T>;\r\n\tchoose<TResult>(selector?:Selector<T, TResult>):Enumerable<TResult>\r\n\tchoose(selector:Selector<T, any> = Functions.Identity):Enumerable<any>\r\n\t{\r\n\t\treturn this._choose(selector);\r\n\t}\r\n\r\n\treverse():Enumerable<T>\r\n\t{\r\n\t\tvar _ = this, disposed = !_.throwIfDisposed();\r\n\t\tthrowIfEndless(_._isEndless); // Cannot reverse an endless collection...\r\n\r\n\t\treturn new Enumerable<T>(\r\n\t\t\t() =>\r\n\t\t\t{\r\n\t\t\t\tvar buffer:T[];\r\n\t\t\t\tvar index:number = 0;\r\n\r\n\t\t\t\treturn new EnumeratorBase<T>(\r\n\t\t\t\t\t() =>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthrowIfDisposed(disposed);\r\n\t\t\t\t\t\tbuffer = _.toArray();\r\n\t\t\t\t\t\tindex = buffer.length;\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\t(yielder)=> index && yielder.yieldReturn(buffer[--index]),\r\n\r\n\t\t\t\t\t() =>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tbuffer.length = 0;\r\n\t\t\t\t\t}\r\n\t\t\t\t);\r\n\t\t\t},\r\n\r\n\t\t\t() =>\r\n\t\t\t{\r\n\t\t\t\tdisposed = true;\r\n\t\t\t}\r\n\t\t);\r\n\t}\r\n\r\n\tshuffle():Enumerable<T>\r\n\t{\r\n\t\tvar _ = this, disposed = !_.throwIfDisposed();\r\n\t\tthrowIfEndless(_._isEndless); // Cannot shuffle an endless collection...\r\n\r\n\t\treturn new Enumerable<T>(\r\n\t\t\t() =>\r\n\t\t\t{\r\n\t\t\t\tvar buffer:T[];\r\n\t\t\t\tvar capacity:number;\r\n\t\t\t\tvar len:number;\r\n\r\n\t\t\t\treturn new EnumeratorBase<T>(\r\n\t\t\t\t\t() =>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthrowIfDisposed(disposed);\r\n\t\t\t\t\t\tbuffer = _.toArray();\r\n\t\t\t\t\t\tcapacity = len = buffer.length;\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\t(yielder)=>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t// Avoid using major array operations like .slice();\r\n\t\t\t\t\t\tif(!len)\r\n\t\t\t\t\t\t\treturn yielder.yieldBreak();\r\n\r\n\t\t\t\t\t\tvar selectedIndex = Integer.random(len);\r\n\t\t\t\t\t\tvar selectedValue = buffer[selectedIndex];\r\n\r\n\t\t\t\t\t\tbuffer[selectedIndex] = buffer[--len]; // Take the last one and put it here.\r\n\t\t\t\t\t\tbuffer[len] = null; // clear possible reference.\r\n\r\n\t\t\t\t\t\tif(len%32==0) // Shrink?\r\n\t\t\t\t\t\t\tbuffer.length = len;\r\n\r\n\t\t\t\t\t\treturn yielder.yieldReturn(selectedValue);\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\t() =>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tbuffer.length = 0;\r\n\t\t\t\t\t}\r\n\t\t\t\t);\r\n\t\t\t},\r\n\r\n\t\t\t() =>\r\n\t\t\t{\r\n\t\t\t\tdisposed = true;\r\n\t\t\t}\r\n\t\t);\r\n\t}\r\n\r\n\tcount(predicate?:Predicate<T>):number\r\n\t{\r\n\t\tvar count:number = 0;\r\n\t\tthis.forEach(\r\n\t\t\tpredicate\r\n\r\n\t\t\t\t?\r\n\t\t\t\t(x, i) =>\r\n\t\t\t\t{\r\n\t\t\t\t\tif(predicate(x, i))++count;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t:\r\n\t\t\t\t() =>\r\n\t\t\t\t{\r\n\t\t\t\t\t++count;\r\n\t\t\t\t}\r\n\t\t);\r\n\r\n\t\treturn count;\r\n\t}\r\n\r\n\t// Akin to '.every' on an array.\r\n\tall(predicate:Predicate<T>):boolean\r\n\t{\r\n\t\tif(!predicate)\r\n\t\t\tthrow new ArgumentNullException(\"predicate\");\r\n\r\n\t\tvar result = true;\r\n\t\tthis.forEach((x, i) =>\r\n\t\t{\r\n\t\t\tif(!predicate(x, i))\r\n\t\t\t{\r\n\t\t\t\tresult = false;\r\n\t\t\t\treturn false; // break\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn result;\r\n\t}\r\n\r\n\t// 'every' has been added here for parity/compatibility with an array.\r\n\tevery(predicate:Predicate<T>):boolean\r\n\t{\r\n\t\treturn this.all(predicate);\r\n\t}\r\n\r\n\t// Akin to '.some' on an array.\r\n\tany(predicate?:Predicate<T>):boolean\r\n\t{\r\n\t\tif(!predicate)\r\n\t\t\treturn super.any();\r\n\r\n\t\tvar result = false;\r\n\t\t// Splitting the forEach up this way reduces iterative processing.\r\n\t\t// forEach handles the generation and disposal of the enumerator.\r\n\t\tthis.forEach(\r\n\t\t\t(x, i) =>\r\n\t\t\t{\r\n\t\t\t\tresult = predicate(x, i); // false = not found and therefore it should continue.  true = found and break;\r\n\t\t\t\treturn !result;\r\n\t\t\t});\r\n\t\treturn result;\r\n\r\n\t}\r\n\r\n\t// 'some' has been added here for parity/compatibility with an array.\r\n\tsome(predicate:Predicate<T>):boolean\r\n\t{\r\n\t\treturn this.any(predicate);\r\n\t}\r\n\r\n\r\n\tcontains<TCompare>(value:T, compareSelector?:Selector<T, TCompare>):boolean\r\n\t{\r\n\t\treturn compareSelector\r\n\t\t\t? this.any(v=> compareSelector(v)===compareSelector(value))\r\n\t\t\t: this.any(v=> v===value);\r\n\t}\r\n\r\n\t// Originally has an overload for a predicate,\r\n\t// but that's a bad idea since this could be an enumeration of functions and therefore fail the intent.\r\n\t// Better to chain a where statement first to be more explicit.\r\n\tindexOf<TCompare>(value:T, compareSelector?:Selector<T, TCompare>):number\r\n\t{\r\n\t\tvar found:number = -1;\r\n\t\tthis.forEach(\r\n\t\t\tcompareSelector\r\n\t\t\t\t?\r\n\t\t\t\t(element:T, i?:number) =>\r\n\t\t\t\t{\r\n\t\t\t\t\tif(Values.areEqual(compareSelector(element, i), compareSelector(value, i), true))\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tfound = i;\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t:\r\n\t\t\t\t(element:T, i?:number) =>\r\n\t\t\t\t{\r\n\t\t\t\t\t// Why?  Because NaN doesn't equal NaN. :P\r\n\t\t\t\t\tif(Values.areEqual(element, value, true))\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tfound = i;\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\r\n\r\n\t\treturn found;\r\n\t}\r\n\r\n\tlastIndexOf<TCompare>(value:T, compareSelector?:Selector<T, TCompare>):number\r\n\t{\r\n\t\tvar result:number = -1;\r\n\t\tthis.forEach(\r\n\t\t\tcompareSelector\r\n\t\t\t\t?\r\n\t\t\t\t(element:T, i?:number) =>\r\n\t\t\t\t{\r\n\t\t\t\t\tif(Values.areEqual(compareSelector(element, i), compareSelector(value, i), true)) result\r\n\t\t\t\t\t\t= i;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t:\r\n\t\t\t\t(element:T, i?:number) =>\r\n\t\t\t\t{\r\n\t\t\t\t\tif(Values.areEqual(element, value, true)) result = i;\r\n\t\t\t\t});\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\tmerge(enumerables:IArray<IEnumerableOrArray<T>>):Enumerable<T>\r\n\t{\r\n\t\treturn <Enumerable<T>>super.merge(enumerables);\r\n\t}\r\n\r\n\tconcat(...enumerables:Array<IEnumerableOrArray<T>>):Enumerable<T>\r\n\t{\r\n\t\treturn this.merge(enumerables);\r\n\t}\r\n\r\n\r\n\tintersect<TCompare>(\r\n\t\tsecond:IEnumerableOrArray<T>,\r\n\t\tcompareSelector?:Selector<T, TCompare>):Enumerable<T>\r\n\t{\r\n\t\tvar _ = this;\r\n\r\n\t\treturn new Enumerable<T>(\r\n\t\t\t() =>\r\n\t\t\t{\r\n\t\t\t\tvar enumerator:IEnumerator<T>;\r\n\t\t\t\tvar keys:Dictionary<T,boolean>;\r\n\t\t\t\tvar outs:Dictionary<T,boolean>;\r\n\r\n\t\t\t\treturn new EnumeratorBase<T>(\r\n\t\t\t\t\t() =>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tenumerator = _.getEnumerator();\r\n\r\n\t\t\t\t\t\tkeys = new Dictionary<T, boolean>(compareSelector);\r\n\t\t\t\t\t\touts = new Dictionary<T, boolean>(compareSelector);\r\n\r\n\t\t\t\t\t\tforEach(second, key=>\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tkeys.addByKeyValue(key, true);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\t(yielder)=>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\twhile(enumerator.moveNext())\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tvar current = enumerator.current;\r\n\t\t\t\t\t\t\tif(!outs.containsKey(current) && keys.containsKey(current))\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\touts.addByKeyValue(current, true);\r\n\t\t\t\t\t\t\t\treturn yielder.yieldReturn(current);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn yielder.yieldBreak();\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\t() =>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tdispose(enumerator, keys, outs);\r\n\t\t\t\t\t},\r\n\t\t\t\t\t_._isEndless\r\n\t\t\t\t);\r\n\t\t\t},\r\n\t\t\tnull,\r\n\t\t\t_._isEndless\r\n\t\t);\r\n\t}\r\n\r\n\tsequenceEqual(\r\n\t\tsecond:IEnumerableOrArray<T>,\r\n\t\tequalityComparer:EqualityComparison<T> = Values.areEqual):boolean\r\n\t{\r\n\t\treturn using(\r\n\t\t\tthis.getEnumerator(),\r\n\t\t\te1=> using(\r\n\t\t\t\tenumeratorFrom(second),\r\n\t\t\t\te2=>\r\n\t\t\t\t{\r\n\t\t\t\t\t// if both are endless, this will never evaluate.\r\n\t\t\t\t\tthrowIfEndless(e1.isEndless && e2.isEndless);\r\n\r\n\t\t\t\t\twhile(e1.moveNext())\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tif(!e2.moveNext() || !equalityComparer(e1.current, e2.current))\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\treturn !e2.moveNext();\r\n\t\t\t\t}\r\n\t\t\t)\r\n\t\t);\r\n\t}\r\n\r\n\t//isEquivalent(second:IEnumerableOrArray<T>,\r\n\t//\tequalityComparer:EqualityComparison<T> = Values.areEqual):boolean\r\n\t//{\r\n\t//\treturn this\r\n\t//\t\t.orderBy(keySelector)\r\n\t//\t\t.sequenceEqual(Enumerable.from(second).orderBy(keySelector))\r\n\t//}\r\n\r\n\r\n\t// #endregion\r\n\r\n\r\n\tofType<TType>(type:{ new (...params:any[]):TType }):Enumerable<TType>;\r\n\tofType<TType>(type:any):Enumerable<TType>\r\n\t{\r\n\t\treturn <Enumerable<TType>>super.ofType(type);\r\n\t}\r\n\r\n\texcept<TCompare>(\r\n\t\tsecond:IEnumerableOrArray<T>,\r\n\t\tcompareSelector?:Selector<T, TCompare>):Enumerable<T>\r\n\t{\r\n\t\treturn <Enumerable<T>>super.except(second, compareSelector);\r\n\t}\r\n\r\n\tdistinct(compareSelector?:(value:T)=>T):Enumerable<T>\r\n\t{\r\n\t\treturn <Enumerable<T>>super.distinct(compareSelector);\r\n\t}\r\n\r\n\tdistinctUntilChanged<TCompare>(compareSelector:Selector<T, TCompare> = Functions.Identity):Enumerable<T>\r\n\t{\r\n\t\treturn <Enumerable<T>>super.distinctUntilChanged(compareSelector);\r\n\t}\r\n\r\n// #region Ordering Methods\r\n\r\n\torderBy<TKey extends Comparable>(keySelector:Selector<T, TKey> = Functions.Identity):IOrderedEnumerable<T>\r\n\t{\r\n\t\treturn new OrderedEnumerable<T,TKey>(this, keySelector, Order.Ascending);\r\n\t}\r\n\r\n\torderUsing(comparison:Comparison<T>):IOrderedEnumerable<T>\r\n\t{\r\n\t\treturn new OrderedEnumerable<T,any>(this, null, Order.Ascending, null, comparison);\r\n\t}\r\n\r\n\torderUsingReversed(comparison:Comparison<T>):IOrderedEnumerable<T>\r\n\t{\r\n\t\treturn new OrderedEnumerable<T,any>(this, null, Order.Descending, null, comparison);\r\n\t}\r\n\r\n\torderByDescending<TKey extends Comparable>(keySelector:Selector<T, TKey> = Functions.Identity):IOrderedEnumerable<T>\r\n\t{\r\n\t\treturn new OrderedEnumerable<T,TKey>(this, keySelector, Order.Descending);\r\n\t}\r\n\r\n\t/*\r\n\t\t weightedSample(weightSelector) {\r\n\t\t weightSelector = Utils.createLambda(weightSelector);\r\n\t\t var source = this;\r\n\r\n\t\t return new Enumerable<T>(() => {\r\n\t\t var sortedByBound;\r\n\t\t var totalWeight = 0;\r\n\r\n\t\t return new EnumeratorBase<T>(\r\n\t\t () => {\r\n\t\t sortedByBound = source\r\n\t\t .choose(function (x) {\r\n\t\t var weight = weightSelector(x);\r\n\t\t if (weight <= 0) return null; // ignore 0\r\n\r\n\t\t totalWeight += weight;\r\n\t\t return { value: x, bound: totalWeight }\r\n\t\t })\r\n\t\t .toArray();\r\n\t\t },\r\n\t\t () => {\r\n\t\t if (sortedByBound.length > 0) {\r\n\t\t var draw = (Math.random() * totalWeight) + 1;\r\n\r\n\t\t var lower = -1;\r\n\t\t var upper = sortedByBound.length;\r\n\t\t while (upper - lower > 1) {\r\n\t\t var index = ((lower + upper) / 2);\r\n\t\t if (sortedByBound[index].bound >= draw) {\r\n\t\t upper = index;\r\n\t\t }\r\n\t\t else {\r\n\t\t lower = index;\r\n\t\t }\r\n\t\t }\r\n\r\n\t\t return (<any>this).yieldReturn(sortedByBound[upper].value);\r\n\t\t }\r\n\r\n\t\t return (<any>this).yieldBreak();\r\n\t\t },\r\n\t\t Functions.Blank);\r\n\t\t });\r\n\t\t }\r\n\t\t */\r\n\t// #endregion\r\n\r\n\tbuffer(size:number):Enumerable<T[]>\r\n\t{\r\n\t\treturn <Enumerable<T[]>>super.buffer(size);\r\n\t}\r\n\r\n\t// #region Grouping Methods\r\n\r\n\t// Originally contained a result selector (not common use), but this could be done simply by a select statement after.\r\n\r\n\r\n\tgroupBy<TKey>(keySelector:Selector<T, TKey>):Enumerable<IGrouping<TKey, T>>;\r\n\tgroupBy<TKey, TCompare>(\r\n\t\tkeySelector:Selector<T, TKey>,\r\n\t\telementSelector?:Selector<T, T>,\r\n\t\tcompareSelector?:Selector<TKey, TCompare>):Enumerable<IGrouping<TKey, T>>;\r\n\tgroupBy<TKey, TElement, TCompare>(\r\n\t\tkeySelector:Selector<T, TKey>,\r\n\t\telementSelector?:Selector<T, TElement>,\r\n\t\tcompareSelector?:Selector<TKey, TCompare>):Enumerable<IGrouping<TKey, TElement>>\r\n\t{\r\n\t\tif(!elementSelector) elementSelector = Functions.Identity; // Allow for 'null' and not just undefined.\r\n\t\treturn new Enumerable<IGrouping<TKey, TElement>>(\r\n\t\t\t() => this.toLookup(keySelector, elementSelector, compareSelector)\r\n\t\t\t\t.getEnumerator()\r\n\t\t);\r\n\t}\r\n\r\n\tpartitionBy<TKey>(keySelector:Selector<T, TKey>):Enumerable<IGrouping<TKey, T>>;\r\n\tpartitionBy<TKey, TElement, TCompare>(\r\n\t\tkeySelector:Selector<T, TKey>,\r\n\t\telementSelector:Selector<T, TElement>,\r\n\t\tresultSelector?:(key:TKey, element:TElement[]) => IGrouping<TKey, TElement>,\r\n\t\tcompareSelector?:Selector<TKey, TCompare>):Enumerable<IGrouping<TKey, TElement>>;\r\n\tpartitionBy<TKey, TElement, TCompare>(\r\n\t\tkeySelector:Selector<T, TKey>,\r\n\t\telementSelector?:Selector<T, TElement>,\r\n\t\tresultSelector:(key:TKey, element:TElement[]) => IGrouping<TKey, TElement>\r\n\t\t\t= (key:TKey, elements:TElement[]) => new Grouping<TKey, TElement>(key, elements),\r\n\t\tcompareSelector:Selector<TKey, TCompare>\r\n\t\t\t= Functions.Identity):Enumerable<IGrouping<TKey, T>>|Enumerable<IGrouping<TKey, TElement>>\r\n\t{\r\n\r\n\t\tvar _ = this;\r\n\t\tif(!elementSelector) elementSelector = Functions.Identity; // Allow for 'null' and not just undefined.\r\n\t\treturn new Enumerable<IGrouping<TKey, TElement>>(\r\n\t\t\t() =>\r\n\t\t\t{\r\n\t\t\t\tvar enumerator:IEnumerator<T>;\r\n\t\t\t\tvar key:TKey;\r\n\t\t\t\tvar compareKey:TCompare;\r\n\t\t\t\tvar group:TElement[];\r\n\t\t\t\tvar len:number;\r\n\r\n\t\t\t\treturn new EnumeratorBase<IGrouping<TKey, TElement>>(\r\n\t\t\t\t\t() =>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tenumerator = _.getEnumerator();\r\n\t\t\t\t\t\tif(enumerator.moveNext())\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tkey = keySelector(enumerator.current);\r\n\t\t\t\t\t\t\tcompareKey = compareSelector(key);\r\n\t\t\t\t\t\t\tgroup = [elementSelector(enumerator.current)];\r\n\t\t\t\t\t\t\tlen = 1;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\tgroup = null;\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\t(yielder)=>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tif(!group)\r\n\t\t\t\t\t\t\treturn yielder.yieldBreak();\r\n\r\n\t\t\t\t\t\tvar hasNext:boolean, c:T;\r\n\t\t\t\t\t\twhile((hasNext = enumerator.moveNext()))\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tc = enumerator.current;\r\n\t\t\t\t\t\t\tif(compareKey===compareSelector(keySelector(c)))\r\n\t\t\t\t\t\t\t\tgroup[len++] = elementSelector(c);\r\n\t\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tvar result:IGrouping<TKey, TElement>\r\n\t\t\t\t\t\t\t    = resultSelector(key, group);\r\n\r\n\t\t\t\t\t\tif(hasNext)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tc = enumerator.current;\r\n\t\t\t\t\t\t\tkey = keySelector(c);\r\n\t\t\t\t\t\t\tcompareKey = compareSelector(key);\r\n\t\t\t\t\t\t\tgroup = [elementSelector(c)];\r\n\t\t\t\t\t\t\tlen = 1;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tgroup = null;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\treturn yielder.yieldReturn(result);\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\t() =>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tdispose(enumerator);\r\n\t\t\t\t\t\tgroup = null;\r\n\t\t\t\t\t}\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t);\r\n\t}\r\n\r\n\t// #endregion\r\n\r\n\t// #region Aggregate Methods\r\n\r\n\taggregate(\r\n\t\tfunc:(a:T, b:T) => T,\r\n\t\tseed?:T):T\r\n\t{\r\n\t\treturn this.scan(func, seed).lastOrDefault();\r\n\t}\r\n\r\n\taverage(selector:Selector<T, number> = Type.numberOrNaN):number\r\n\t{\r\n\t\tvar count = 0;\r\n\t\tvar sum = this.sum((e, i)=>\r\n\t\t{\r\n\t\t\tcount++;\r\n\t\t\treturn selector(e, i);\r\n\t\t});\r\n\r\n\t\treturn (isNaN(sum) || !count)\r\n\t\t\t? NaN\r\n\t\t\t: (sum/count);\r\n\t}\r\n\r\n\t// If using numbers, it may be useful to call .takeUntil(v=>v==Infinity,true) before calling max. See static versions for numbers.\r\n\tmax():T\r\n\t{\r\n\t\treturn this.aggregate(Functions.Greater);\r\n\t}\r\n\r\n\tmin():T\r\n\t{\r\n\t\treturn this.aggregate(Functions.Lesser);\r\n\t}\r\n\r\n\tmaxBy<TCompare>(keySelector:Selector<T, TCompare> = Functions.Identity):T\r\n\t{\r\n\t\treturn this.aggregate((a:T, b:T) => (keySelector(a)>keySelector(b)) ? a : b);\r\n\t}\r\n\r\n\tminBy<TCompare>(keySelector:Selector<T, TCompare> = Functions.Identity):T\r\n\t{\r\n\t\treturn this.aggregate((a:T, b:T) => (keySelector(a)<keySelector(b)) ? a : b);\r\n\t}\r\n\r\n\t// Addition...  Only works with numerical enumerations.\r\n\tsum(selector:Selector<T, number> = Type.numberOrNaN):number\r\n\t{\r\n\t\tvar sum = 0;\r\n\r\n\t\t// This allows for infinity math that doesn't destroy the other values.\r\n\t\tvar sumInfinite = 0; // Needs more investigation since we are really trying to retain signs.\r\n\r\n\t\tthis.forEach(\r\n\t\t\tx=>\r\n\t\t\t{\r\n\t\t\t\tvar value = selector(x);\r\n\t\t\t\tif(isNaN(value))\r\n\t\t\t\t{\r\n\t\t\t\t\tsum = NaN;\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t\tif(isFinite(value))\r\n\t\t\t\t\tsum += value;\r\n\t\t\t\telse\r\n\t\t\t\t\tsumInfinite +=\r\n\t\t\t\t\t\tvalue>0 ?\r\n\t\t\t\t\t\t\t(+1) :\r\n\t\t\t\t\t\t\t(-1);\r\n\t\t\t}\r\n\t\t);\r\n\r\n\t\treturn isNaN(sum) ? NaN : (sumInfinite ? (sumInfinite*Infinity) : sum);\r\n\t}\r\n\r\n\t// Multiplication...\r\n\tproduct(selector:Selector<T, number> = Type.numberOrNaN):number\r\n\t{\r\n\t\tvar result = 1, exists:boolean = false;\r\n\r\n\t\tthis.forEach(\r\n\t\t\t(x, i)=>\r\n\t\t\t{\r\n\t\t\t\texists = true;\r\n\t\t\t\tvar value = selector(x, i);\r\n\t\t\t\tif(isNaN(value))\r\n\t\t\t\t{\r\n\t\t\t\t\tresult = NaN;\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif(value==0)\r\n\t\t\t\t{\r\n\t\t\t\t\tresult = 0; // Multiplying by zero will always end in zero.\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Multiplication can never recover from infinity and simply must retain signs.\r\n\t\t\t\t// You could cancel out infinity with 1/infinity but no available representation exists.\r\n\t\t\t\tresult *= value;\r\n\t\t\t}\r\n\t\t);\r\n\r\n\t\treturn (exists && isNaN(result)) ? NaN : result;\r\n\t}\r\n\r\n\t/**\r\n\t * Takes the first number and divides it by all following.\r\n\t * @param selector\r\n\t * @returns {number}\r\n\t */\r\n\tquotient(selector:Selector<T, number> = Type.numberOrNaN):number\r\n\t{\r\n\t\tvar count = 0;\r\n\t\tvar result:number = NaN;\r\n\r\n\t\tthis.forEach(\r\n\t\t\t(x, i)=>\r\n\t\t\t{\r\n\t\t\t\tvar value = selector(x, i);\r\n\t\t\t\tcount++;\r\n\r\n\t\t\t\tif(count===1)\r\n\t\t\t\t{\r\n\t\t\t\t\tresult = value;\r\n\t\t\t\t}\r\n\t\t\t\telse\r\n\t\t\t\t{\r\n\t\t\t\t\tif(isNaN(value) || value===0 || !isFinite(value))\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tresult = NaN;\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tresult /= value;\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\t\t);\r\n\r\n\t\tif(count===1)\r\n\t\t\tresult = NaN;\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\t// #endregion\r\n\r\n\t// #region Single Value Return...\r\n\r\n\tlast():T\r\n\t{\r\n\t\tvar _ = this;\r\n\t\t_.throwIfDisposed();\r\n\r\n\t\tvar value:T = undefined;\r\n\t\tvar found:boolean = false;\r\n\t\t_.forEach(\r\n\t\t\tx =>\r\n\t\t\t{\r\n\t\t\t\tfound = true;\r\n\t\t\t\tvalue = x;\r\n\t\t\t}\r\n\t\t);\r\n\r\n\t\tif(!found) throw new Error(\"last:No element satisfies the condition.\");\r\n\t\treturn value;\r\n\t}\r\n\r\n\tlastOrDefault(defaultValue:T = null):T\r\n\t{\r\n\t\tvar _ = this;\r\n\t\t_.throwIfDisposed();\r\n\r\n\t\tvar value:T = undefined;\r\n\t\tvar found:boolean = false;\r\n\t\t_.forEach(\r\n\t\t\tx=>\r\n\t\t\t{\r\n\t\t\t\tfound = true;\r\n\t\t\t\tvalue = x;\r\n\t\t\t}\r\n\t\t);\r\n\t\treturn (!found) ? defaultValue : value;\r\n\t}\r\n\r\n\t// #endregion\r\n\r\n\tshare():Enumerable<T>\r\n\t{\r\n\t\treturn <Enumerable<T>>super.share();\r\n\t}\r\n\r\n\r\n\tcatchError(handler:(e:any)=>void):Enumerable<T>\r\n\t{\r\n\t\treturn <Enumerable<T>>super.catchError(handler);\r\n\t}\r\n\r\n\r\n\tfinallyAction(action:()=>void):Enumerable<T>\r\n\t{\r\n\t\treturn <Enumerable<T>>super.finallyAction(action);\r\n\t}\r\n\r\n\tmemoize():Enumerable<T>\r\n\t{\r\n\t\tvar _ = this, disposed:boolean = !_.throwIfDisposed();\r\n\r\n\t\tvar cache:T[];\r\n\t\tvar enumerator:IEnumerator<T>;\r\n\r\n\t\treturn new Enumerable<T>(\r\n\t\t\t() =>\r\n\t\t\t{\r\n\r\n\t\t\t\tvar index:number = 0;\r\n\r\n\t\t\t\treturn new EnumeratorBase<T>(\r\n\t\t\t\t\t() =>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthrowIfDisposed(disposed);\r\n\t\t\t\t\t\tif(!enumerator)\r\n\t\t\t\t\t\t\tenumerator = _.getEnumerator();\r\n\t\t\t\t\t\tif(!cache)\r\n\t\t\t\t\t\t\tcache = [];\r\n\t\t\t\t\t\tindex = 0;\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\t(yielder)=>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthrowIfDisposed(disposed);\r\n\r\n\t\t\t\t\t\tvar i = index++;\r\n\r\n\t\t\t\t\t\tif(i>=cache.length)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\treturn (enumerator.moveNext())\r\n\t\t\t\t\t\t\t\t? yielder.yieldReturn(cache[i] = enumerator.current)\r\n\t\t\t\t\t\t\t\t: false;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\treturn yielder.yieldReturn(cache[i]);\r\n\t\t\t\t\t}\r\n\t\t\t\t);\r\n\t\t\t},\r\n\r\n\t\t\t() =>\r\n\t\t\t{\r\n\t\t\t\tdisposed = true;\r\n\t\t\t\tif(cache)\r\n\t\t\t\t\tcache.length = 0;\r\n\t\t\t\tcache = null;\r\n\r\n\t\t\t\tdispose(enumerator);\r\n\t\t\t\tenumerator = null;\r\n\t\t\t}\r\n\t\t);\r\n\t}\r\n\r\n\r\n}\r\n\r\n\r\n// Provided for type guarding.\r\nexport class FiniteEnumerable<T>\r\nextends Enumerable<T> implements IFiniteEnumerable<T>\r\n{\r\n\tconstructor(\r\n\t\tenumeratorFactory:() => IEnumerator<T>,\r\n\t\tfinalizer?:() => void)\r\n\t{\r\n\t\tsuper(enumeratorFactory, finalizer, false);\r\n\t}\r\n\r\n}\r\n\r\nclass ArrayEnumerable<T>\r\nextends FiniteEnumerable<T>\r\n{\r\n\tprivate _source:IArray<T>;\r\n\r\n\tconstructor(source:IArray<T>)\r\n\t{\r\n\t\tsuper(() =>\r\n\t\t{\r\n\t\t\t_.throwIfDisposed();\r\n\t\t\treturn new ArrayEnumerator<T>(() =>\r\n\t\t\t{\r\n\t\t\t\t_.throwIfDisposed(\"The underlying ArrayEnumerable was disposed.\", \"ArrayEnumerator\");\r\n\r\n\t\t\t\treturn _._source; // Should never be null, but ArrayEnumerable if not disposed simply treats null as empty array.\r\n\t\t\t});\r\n\t\t});\r\n\r\n\t\tvar _ = this;\r\n\t\t_._disposableObjectName = \"ArrayEnumerable\";\r\n\t\t_._source = source;\r\n\r\n\t}\r\n\r\n\tprotected _onDispose():void\r\n\t{\r\n\t\tsuper._onDispose();\r\n\t\tthis._source = <any>null;\r\n\t}\r\n\r\n\tget source():IArray<T>\r\n\t{\r\n\t\treturn this._source;\r\n\t}\r\n\r\n\ttoArray():T[]\r\n\t{\r\n\t\tvar _ = this;\r\n\t\t_.throwIfDisposed();\r\n\r\n\t\treturn toArray(_._source);\r\n\t}\r\n\r\n\tasEnumerable():ArrayEnumerable<T>\r\n\t{\r\n\t\treturn new ArrayEnumerable<T>(this._source);\r\n\t}\r\n\r\n\t// Optimize forEach so that subsequent usage is optimized.\r\n\tforEach(action:Predicate<T> | Action<T>, max:number = Infinity):number\r\n\t{\r\n\t\tvar _ = this;\r\n\t\t_.throwIfDisposed();\r\n\r\n\t\treturn forEach(_._source, action, max);\r\n\t}\r\n\r\n\t// These methods should ALWAYS check for array length before attempting anything.\r\n\r\n\tany(predicate?:Predicate<T>):boolean\r\n\t{\r\n\t\tvar _ = this;\r\n\t\t_.throwIfDisposed();\r\n\r\n\t\tvar source = _._source, len = source.length;\r\n\t\treturn len && (!predicate || super.any(predicate));\r\n\t}\r\n\r\n\tcount(predicate?:Predicate<T>):number\r\n\t{\r\n\t\tvar _ = this;\r\n\t\t_.throwIfDisposed();\r\n\r\n\t\tvar source = _._source, len = source.length;\r\n\t\treturn len && (predicate ? super.count(predicate) : len);\r\n\t}\r\n\r\n\telementAtOrDefault(index:number, defaultValue:T = null):T\r\n\t{\r\n\t\tvar _ = this;\r\n\t\t_.throwIfDisposed();\r\n\t\tInteger.assertZeroOrGreater(index, 'index');\r\n\r\n\t\tvar source = _._source;\r\n\t\treturn index<source.length\r\n\t\t\t? source[index]\r\n\t\t\t: defaultValue;\r\n\t}\r\n\r\n\tlast():T\r\n\t{\r\n\t\tvar _ = this;\r\n\t\t_.throwIfDisposed();\r\n\r\n\t\tvar source = _._source, len = source.length;\r\n\t\treturn (len)\r\n\t\t\t? source[len - 1]\r\n\t\t\t: super.last();\r\n\t}\r\n\r\n\tlastOrDefault(defaultValue:T = null):T\r\n\t{\r\n\t\tvar _ = this;\r\n\t\t_.throwIfDisposed();\r\n\r\n\t\tvar source = _._source, len = source.length;\r\n\t\treturn len\r\n\t\t\t? source[len - 1]\r\n\t\t\t: defaultValue;\r\n\t}\r\n\r\n\tskip(count:number):Enumerable<T>\r\n\t{\r\n\r\n\t\tvar _ = this;\r\n\r\n\t\tif(!(count>0))\r\n\t\t\treturn _;\r\n\r\n\t\treturn new Enumerable<T>(\r\n\t\t\t() => new ArrayEnumerator<T>(() => _._source, count)\r\n\t\t);\r\n\t}\r\n\r\n\ttakeExceptLast(count:number = 1):Enumerable<T>\r\n\t{\r\n\t\tvar _ = this;\r\n\t\treturn _.take(_._source.length - count);\r\n\t}\r\n\r\n\tskipToLast(count:number):Enumerable<T>\r\n\t{\r\n\t\tif(!(count>0))\r\n\t\t\treturn Enumerable.empty<T>();\r\n\r\n\t\tvar _ = this;\r\n\t\tif(!isFinite(count))\r\n\t\t\treturn _;\r\n\r\n\t\tvar len = _._source\r\n\t\t\t? _._source.length\r\n\t\t\t: 0;\r\n\r\n\t\treturn _.skip(len - count);\r\n\t}\r\n\r\n\treverse():Enumerable<T>\r\n\t{\r\n\t\tvar _ = this;\r\n\r\n\t\treturn new Enumerable<T>(\r\n\t\t\t() => new ArrayEnumerator<T>(\r\n\t\t\t\t() => _._source, _._source\r\n\t\t\t\t\t? (_._source.length - 1)\r\n\t\t\t\t\t: 0, -1\r\n\t\t\t)\r\n\t\t);\r\n\t}\r\n\r\n\tmemoize():ArrayEnumerable<T>\r\n\t{\r\n\t\treturn this.asEnumerable();\r\n\t}\r\n\r\n\tsequenceEqual(\r\n\t\tsecond:IEnumerableOrArray<T>,\r\n\t\tequalityComparer:EqualityComparison<T> = Values.areEqual):boolean\r\n\t{\r\n\t\tif(Type.isArrayLike(second))\r\n\t\t\treturn Arrays.areEqual(this.source, second, true, equalityComparer);\r\n\r\n\t\tif(second instanceof ArrayEnumerable)\r\n\t\t\treturn second.sequenceEqual(this.source, equalityComparer);\r\n\r\n\t\treturn super.sequenceEqual(second, equalityComparer);\r\n\t}\r\n\r\n\r\n\ttoJoinedString(separator:string = \"\", selector:Selector<T, string> = Functions.Identity)\r\n\t{\r\n\t\tvar s = this._source;\r\n\t\treturn !selector && Array.isArray(s)\r\n\t\t\t? (<Array<T>>s).join(separator)\r\n\t\t\t: super.toJoinedString(separator, selector);\r\n\t}\r\n\r\n}\r\n\r\nclass Grouping<TKey, TElement>\r\nextends ArrayEnumerable<TElement> implements IGrouping<TKey, TElement>\r\n{\r\n\r\n\tconstructor(private _groupKey:TKey, elements:TElement[])\r\n\t{\r\n\t\tsuper(elements);\r\n\t}\r\n\r\n\tget key():TKey\r\n\t{\r\n\t\treturn this._groupKey;\r\n\t}\r\n}\r\n\r\nclass Lookup<TKey, TElement>\r\nimplements ILookup<TKey, TElement>\r\n{\r\n\r\n\tconstructor(private _dictionary:IDictionary<TKey, TElement[]>)\r\n\t{\r\n\t}\r\n\r\n\tget count():number\r\n\t{\r\n\t\treturn this._dictionary.count;\r\n\t}\r\n\r\n\tget(key:TKey):TElement[]\r\n\t{\r\n\t\treturn this._dictionary.getValue(key);\r\n\t}\r\n\r\n\tcontains(key:TKey):boolean\r\n\t{\r\n\t\treturn this._dictionary.containsKey(key);\r\n\t}\r\n\r\n\tgetEnumerator():IEnumerator<Grouping<TKey, TElement>>\r\n\t{\r\n\r\n\t\tvar _ = this;\r\n\t\tvar enumerator:IEnumerator<IKeyValuePair<TKey, TElement[]>>;\r\n\r\n\t\treturn new EnumeratorBase<Grouping<TKey, TElement>>(\r\n\t\t\t() =>\r\n\t\t\t{\r\n\t\t\t\tenumerator = _._dictionary.getEnumerator();\r\n\t\t\t},\r\n\t\t\t(yielder)=>\r\n\t\t\t{\r\n\r\n\t\t\t\tif(!enumerator.moveNext())\r\n\t\t\t\t\treturn false;\r\n\r\n\t\t\t\tvar current = enumerator.current;\r\n\r\n\t\t\t\treturn yielder.yieldReturn(new Grouping<TKey, TElement>(current.key, current.value));\r\n\t\t\t},\r\n\t\t\t() =>\r\n\t\t\t{\r\n\t\t\t\tdispose(enumerator);\r\n\t\t\t}\r\n\t\t);\r\n\t}\r\n\r\n}\r\n\r\n\r\nclass OrderedEnumerable<T,TOrderBy extends Comparable>\r\nextends FiniteEnumerable<T> implements IOrderedEnumerable<T>\r\n{\r\n\r\n\tconstructor(\r\n\t\tprivate source:IEnumerable<T>,\r\n\t\tpublic keySelector:(value:T) => TOrderBy,\r\n\t\tpublic order:Order,\r\n\t\tpublic parent?:OrderedEnumerable<T,any>,\r\n\t\tpublic comparer:Comparison<T> = Values.compare)\r\n\t{\r\n\t\tsuper(null);\r\n\t\tthrowIfEndless(source && source.isEndless);\r\n\t}\r\n\r\n\tprivate createOrderedEnumerable(\r\n\t\tkeySelector:(value:T) => TOrderBy,\r\n\t\torder:Order):IOrderedEnumerable<T>\r\n\t{\r\n\t\treturn new OrderedEnumerable<T,TOrderBy>(this.source, keySelector, order, this);\r\n\t}\r\n\r\n\tthenBy(keySelector:(value:T) => TOrderBy):IOrderedEnumerable<T>\r\n\t{\r\n\t\treturn this.createOrderedEnumerable(keySelector, Order.Ascending);\r\n\t}\r\n\r\n\tthenUsing(comparison:Comparison<T>):IOrderedEnumerable<T>\r\n\t{\r\n\t\treturn new OrderedEnumerable<T,any>(this.source, null, Order.Ascending, this, comparison);\r\n\t}\r\n\r\n\tthenByDescending(keySelector:(value:T) => TOrderBy):IOrderedEnumerable<T>\r\n\t{\r\n\t\treturn this.createOrderedEnumerable(keySelector, Order.Descending);\r\n\t}\r\n\r\n\tthenUsingReversed(comparison:Comparison<T>):IOrderedEnumerable<T>\r\n\t{\r\n\t\treturn new OrderedEnumerable<T,any>(this.source, null, Order.Descending, this, comparison);\r\n\t}\r\n\r\n\tgetEnumerator():EnumeratorBase<T>\r\n\t{\r\n\t\tvar _ = this;\r\n\t\tvar buffer:T[];\r\n\t\tvar indexes:number[];\r\n\t\tvar index:number = 0;\r\n\r\n\t\treturn new EnumeratorBase<T>(\r\n\t\t\t() =>\r\n\t\t\t{\r\n\t\t\t\tindex = 0;\r\n\t\t\t\tbuffer = Enumerable.toArray(_.source);\r\n\t\t\t\tindexes = createSortContext(_).generateSortedIndexes(buffer);\r\n\t\t\t},\r\n\r\n\t\t\t(yielder)=>\r\n\t\t\t{\r\n\t\t\t\treturn (index<indexes.length)\r\n\t\t\t\t\t? yielder.yieldReturn(buffer[indexes[index++]])\r\n\t\t\t\t\t: false;\r\n\t\t\t},\r\n\r\n\t\t\t() =>\r\n\t\t\t{\r\n\t\t\t\tif(buffer)\r\n\t\t\t\t\tbuffer.length = 0;\r\n\t\t\t\tbuffer = null;\r\n\t\t\t\tif(indexes)\r\n\t\t\t\t\tindexes.length = 0;\r\n\t\t\t\tindexes = null;\r\n\t\t\t},\r\n\r\n\t\t\tfalse\r\n\t\t);\r\n\t}\r\n\r\n\tprotected _onDispose():void\r\n\t{\r\n\t\tsuper._onDispose();\r\n\t\tthis.source = null;\r\n\t\tthis.keySelector = null;\r\n\t\tthis.order = null;\r\n\t\tthis.parent = null;\r\n\t}\r\n\r\n}\r\n\r\n// A private static helper for the weave function.\r\nfunction nextEnumerator<T>(queue:Queue<IEnumerator<T>>, e:IEnumerator<T>):IEnumerator<T>\r\n{\r\n\tif(e)\r\n\t{\r\n\t\tif(e.moveNext())\r\n\t\t{\r\n\t\t\tqueue.enqueue(e);\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tdispose(e);\r\n\t\t\te = null;\r\n\t\t}\r\n\t}\r\n\treturn e;\r\n}\r\n\r\n/**\r\n * Recursively builds a SortContext chain.\r\n * @param orderedEnumerable\r\n * @param currentContext\r\n * @returns {any}\r\n */\r\nfunction createSortContext<T, TOrderBy extends Comparable>(\r\n\torderedEnumerable:OrderedEnumerable<T,TOrderBy>,\r\n\tcurrentContext:IComparer<T> = null):KeySortedContext<T, TOrderBy>\r\n{\r\n\r\n\tvar context = new KeySortedContext<T, TOrderBy>(\r\n\t\tcurrentContext,\r\n\t\torderedEnumerable.keySelector,\r\n\t\torderedEnumerable.order,\r\n\t\torderedEnumerable.comparer);\r\n\r\n\tif(orderedEnumerable.parent)\r\n\t\treturn createSortContext(orderedEnumerable.parent, context);\r\n\r\n\treturn context;\r\n}\r\n\r\n// #region Helper Functions...\r\n// This allows for the use of a boolean instead of calling this.throwIfDisposed()\r\n// since there is a strong chance of introducing a circular reference.\r\nfunction throwIfDisposed(disposed:boolean):void\r\n{\r\n\tif(disposed) throw new ObjectDisposedException(\"Enumerable\");\r\n}\r\n// #endregion\r\n\r\nexport default Enumerable;\r\n"]}