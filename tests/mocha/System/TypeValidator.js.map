{"version":3,"sources":["System/TypeValidator.ts"],"names":[],"mappings":"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","file":"System/TypeValidator.js","sourcesContent":["///<reference path=\"../import.d.ts\"/>\r\n\r\nimport {TypeInfoHelper, TypeValidator} from \"../../../source/System/TypeValidator\";\r\nvar assert = require('../../../node_modules/assert/assert');\r\n\r\nconst example = new TypeInfoHelper({\r\n\ta: {},\r\n\tb: \"hello\",\r\n\tc: 1,\r\n\td: true,\r\n\te: {\r\n\t\tf: \"whatever\",\r\n\t\tg: false,\r\n\t\th: [\r\n\t\t\t0,\r\n\t\t\t1,\r\n\t\t\t\"2\"\r\n\t\t]\r\n\t},\r\n\ti: \"noise\"\r\n});\r\n\r\ndescribe('.contains(descriptor)', ()=>\r\n{\r\n\tit('should detect a positive match', ()=>\r\n\t{\r\n\t\tassert.ok(example.contains({\r\n\t\t\ta: Object,\r\n\t\t\tb: String,\r\n\t\t\tc: Number,\r\n\t\t\td: Boolean,\r\n\t\t\te: {\r\n\t\t\t\tf: String,\r\n\t\t\t\tg: Boolean,\r\n\t\t\t\th: Array\r\n\t\t\t}\r\n\t\t}));\r\n\r\n\t\tassert.ok(example.contains({\r\n\t\t\ta: Object,\r\n\t\t\tb: String,\r\n\t\t\tc: Number,\r\n\t\t\td: Boolean,\r\n\t\t\te: {\r\n\t\t\t\tf: String,\r\n\t\t\t\tg: Boolean,\r\n\t\t\t\th: [\r\n\t\t\t\t\tNumber,\r\n\t\t\t\t\tNumber,\r\n\t\t\t\t\tString\r\n\t\t\t\t]\r\n\t\t\t}\r\n\t\t}));\r\n\r\n\t\tassert.ok(example.contains({\r\n\t\t\ta: Object,\r\n\t\t\tb: String,\r\n\t\t\tc: Number,\r\n\t\t\td: Boolean,\r\n\t\t\te: {\r\n\t\t\t\tf: String,\r\n\t\t\t\tg: Boolean,\r\n\t\t\t\th: [\r\n\t\t\t\t\tNumber,\r\n\t\t\t\t\tNumber,\r\n\t\t\t\t\tString\r\n\t\t\t\t]\r\n\t\t\t},\r\n\t\t\ti: \"noise\"\r\n\t\t}));\r\n\r\n\t\tassert.ok(example.contains({\r\n\t\t\ta: Object,\r\n\t\t\tb: String,\r\n\t\t\tc: Number,\r\n\t\t\td: Boolean,\r\n\t\t\te: {\r\n\t\t\t\tf: String,\r\n\t\t\t\tg: Boolean,\r\n\t\t\t\th: [\r\n\t\t\t\t\tNumber\r\n\t\t\t\t]\r\n\t\t\t}\r\n\t\t}))\r\n\t});\r\n\r\n\tit('should detect a negative match', ()=>\r\n\t{\r\n\t\tassert.ok(!example.contains({\r\n\t\t\ta: Object,\r\n\t\t\tb: String,\r\n\t\t\tc: Number,\r\n\t\t\td: Boolean,\r\n\t\t\te: {\r\n\t\t\t\tf: String,\r\n\t\t\t\tg: Boolean,\r\n\t\t\t\th: [\r\n\t\t\t\t\tNumber,\r\n\t\t\t\t\tBoolean,\r\n\t\t\t\t\tString\r\n\t\t\t\t]\r\n\t\t\t}\r\n\t\t}));\r\n\r\n\t\tassert.ok(!example.contains({\r\n\t\t\ta: Object,\r\n\t\t\tb: String,\r\n\t\t\tc: Number,\r\n\t\t\td: Boolean,\r\n\t\t\te: {\r\n\t\t\t\tf: String,\r\n\t\t\t\tg: Boolean,\r\n\t\t\t\th: [\r\n\t\t\t\t\tString\r\n\t\t\t\t]\r\n\t\t\t}\r\n\t\t}));\r\n\r\n\r\n\t\tassert.ok(!example.contains({\r\n\t\t\ta: Object,\r\n\t\t\tb: String,\r\n\t\t\tc: Number,\r\n\t\t\td: Boolean,\r\n\t\t\te: {\r\n\t\t\t\tf: String,\r\n\t\t\t\tg: Boolean,\r\n\t\t\t\th: [\r\n\t\t\t\t\tNumber\r\n\t\t\t\t]\r\n\t\t\t},\r\n\t\t\ti: \"goo\"\r\n\t\t}));\r\n\r\n\t\tassert.ok(!example.contains({\r\n\t\t\ta: Object,\r\n\t\t\tb: String,\r\n\t\t\tc: Number,\r\n\t\t\td: Boolean,\r\n\t\t\te: {\r\n\t\t\t\tf: String,\r\n\t\t\t\tg: Boolean,\r\n\t\t\t\th: [\r\n\t\t\t\t\tNumber\r\n\t\t\t\t]\r\n\t\t\t},\r\n\t\t\ti: Boolean\r\n\t\t}));\r\n\t});\r\n});\r\n\r\ndescribe(\"Example\", ()=>\r\n\tit(\"should work\", ()=>\r\n\t{\r\n\r\n\t\t// Step 1: Declare the expected type/interface.\r\n\t\tinterface MyType\r\n\t\t{\r\n\t\t\ta:Object,\r\n\t\t\tb:String,\r\n\t\t\tc:Number,\r\n\t\t\td:Boolean,\r\n\t\t\te:{\r\n\t\t\t\tf:String,\r\n\t\t\t\tg:Boolean,\r\n\t\t\t\th:[\r\n\t\t\t\t\tNumber,\r\n\t\t\t\t\tBoolean,\r\n\t\t\t\t\tString\r\n\t\t\t\t\t]\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// Step 2: Copy the interface as an actual object and <type> the validator\r\n\t\tconst MyTypeValidator\r\n\t\t\t      = new TypeValidator<MyType>(\r\n\t\t\t{\r\n\t\t\t\ta: Object,\r\n\t\t\t\tb: String,\r\n\t\t\t\tc: Number,\r\n\t\t\t\td: Boolean,\r\n\t\t\t\te: {\r\n\t\t\t\t\tf: String,\r\n\t\t\t\t\tg: Boolean,\r\n\t\t\t\t\th: [\r\n\t\t\t\t\t\tNumber,\r\n\t\t\t\t\t\tBoolean,\r\n\t\t\t\t\t\tString\r\n\t\t\t\t\t]\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t);\r\n\r\n\t\t// Step 3: validate as many times as you want:\r\n\t\tvar myItem = {\r\n\t\t\ta: {},\r\n\t\t\tb: \"hello\",\r\n\t\t\tc: 1,\r\n\t\t\td: true,\r\n\t\t\te: {\r\n\t\t\t\tf: \"whatever\",\r\n\t\t\t\tg: false,\r\n\t\t\t\th: [\r\n\t\t\t\t\t0,\r\n\t\t\t\t\ttrue,\r\n\t\t\t\t\t\"2\"\r\n\t\t\t\t]\r\n\t\t\t},\r\n\t\t\ti: \"noise\"\r\n\t\t};\r\n\r\n\t\t// no compile-time type errors!\r\n\t\tif(MyTypeValidator.isSubsetOf(myItem))\r\n\t\t{\r\n\t\t\tassert.equal(myItem.e.h.length, 3);\r\n\t\t\tassert.equal(myItem.b, \"hello\");\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tassert.ok(false, \"Should have validated ok.\");\r\n\t\t}\r\n\r\n\t\tassert.ok(!MyTypeValidator.isSubsetOf(true));\r\n\t\tassert.ok(!MyTypeValidator.isSubsetOf(\"no\"));\r\n\t\tassert.ok(!MyTypeValidator.isSubsetOf({\r\n\t\t\ta: {},\r\n\t\t\tb: \"hello\"\r\n\t\t}));\r\n\r\n\t})\r\n);\r\n\r\ndescribe(\"Complex test\", ()=>\r\n\tit(\"should work\", ()=>\r\n\t{\r\n\t\tinterface ISystem {\r\n\t\t\tvolume_str: String,\r\n\t\t\tbuy: Boolean,\r\n\t\t\tissued: String,\r\n\t\t\tprice: Number,\r\n\t\t\tvolumeEntered: Number,\r\n\t\t\tminVolume: Number,\r\n\t\t\tvolume: Number,\r\n\t\t\trange: String,\r\n\t\t\thref: String,\r\n\t\t\tduration_str: String,\r\n\t\t\tlocation: {\r\n\t\t\t\tid_str: String,\r\n\t\t\t\thref: String,\r\n\t\t\t\tid: Number,\r\n\t\t\t\tname: String,\r\n\t\t\t},\r\n\t\t\tduration: Number,\r\n\t\t\tminVolume_str: String,\r\n\t\t\tvolumeEntered_str: String,\r\n\t\t\ttype: {\r\n\t\t\t\tid_str: String,\r\n\t\t\t\thref: String,\r\n\t\t\t\tid: Number,\r\n\t\t\t\tname: String,\r\n\t\t\t},\r\n\t\t\tid: Number,\r\n\t\t\tid_str: String,\r\n\t\t}\r\n\r\n\t\tconst ISystemTypeValidator\r\n\t\t\t      = new TypeValidator<ISystem>({\r\n\t\t\tvolume_str: String,\r\n\t\t\tbuy: Boolean,\r\n\t\t\tissued: String,\r\n\t\t\tprice: Number,\r\n\t\t\tvolumeEntered: Number,\r\n\t\t\tminVolume: Number,\r\n\t\t\tvolume: Number,\r\n\t\t\trange: String,\r\n\t\t\thref: String,\r\n\t\t\tduration_str: String,\r\n\t\t\tlocation: {\r\n\t\t\t\tid_str: String,\r\n\t\t\t\thref: String,\r\n\t\t\t\tid: Number,\r\n\t\t\t\tname: String,\r\n\t\t\t},\r\n\t\t\tduration: Number,\r\n\t\t\tminVolume_str: String,\r\n\t\t\tvolumeEntered_str: String,\r\n\t\t\ttype: {\r\n\t\t\t\tid_str: String,\r\n\t\t\t\thref: String,\r\n\t\t\t\tid: Number,\r\n\t\t\t\tname: String,\r\n\t\t\t},\r\n\t\t\tid: Number,\r\n\t\t\tid_str: String,\r\n\t\t});\r\n\r\n\t\tassert.ok(ISystemTypeValidator.isSubsetOf(\r\n\t\t\t{\r\n\t\t\t\t\"volume_str\": \"590653\",\r\n\t\t\t\t\"buy\": false,\r\n\t\t\t\t\"issued\": \"2016-04-03T06:18:39\",\r\n\t\t\t\t\"price\": 4.96,\r\n\t\t\t\t\"volumeEntered\": 1090653,\r\n\t\t\t\t\"minVolume\": 1,\r\n\t\t\t\t\"volume\": 590653,\r\n\t\t\t\t\"range\": \"region\",\r\n\t\t\t\t\"href\": \"https://crest-tq.eveonline.com/market/10000007/orders/4490918296/\",\r\n\t\t\t\t\"duration_str\": \"90\",\r\n\t\t\t\t\"location\": {\r\n\t\t\t\t\t\"id_str\": \"61000748\",\r\n\t\t\t\t\t\"href\": \"https://crest-tq.eveonline.com/universe/locations/61000748/\",\r\n\t\t\t\t\t\"id\": 61000748,\r\n\t\t\t\t\t\"name\": \"I6-SYN I - MegaAdmiral respect obelisk\"\r\n\t\t\t\t},\r\n\t\t\t\t\"duration\": 90,\r\n\t\t\t\t\"minVolume_str\": \"1\",\r\n\t\t\t\t\"volumeEntered_str\": \"1090653\",\r\n\t\t\t\t\"type\": {\r\n\t\t\t\t\t\"id_str\": \"34\",\r\n\t\t\t\t\t\"href\": \"https://crest-tq.eveonline.com/types/34/\",\r\n\t\t\t\t\t\"id\": 34,\r\n\t\t\t\t\t\"name\": \"Tritanium\"\r\n\t\t\t\t},\r\n\t\t\t\t\"id\": 4490918296,\r\n\t\t\t\t\"id_str\": \"4490918296\"\r\n\t\t\t}\r\n\t\t));\r\n\r\n\t}));\r\n"]}